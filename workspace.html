<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NAVΛ Studio - Where Your Navigation Calculus Career Happens">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>NAVΛ Studio - Navigation Calculus Institute</title>
    
    <!-- Xterm.js for Terminal -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xterm/xterm@5.3.0/css/xterm.css" />
    <script src="https://cdn.jsdelivr.net/npm/@xterm/xterm@5.3.0/lib/xterm.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@xterm/addon-fit@0.8.0/lib/addon-fit.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@xterm/addon-web-links@0.9.0/lib/addon-web-links.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }

        /* Full Screen Workspace Background */
        .workspace-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: 
                linear-gradient(to bottom, rgba(10, 17, 40, 0.4), rgba(10, 17, 40, 0.7)),
                radial-gradient(circle at 60% 50%, rgba(59, 130, 246, 0.2) 0%, transparent 50%),
                #0a1735;
            overflow: hidden;
        }

        /* Simulated Workspace Scene */
        .workspace-scene {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                /* Desk surface gradient */
                linear-gradient(180deg, transparent 0%, transparent 60%, rgba(20, 40, 70, 0.5) 60%, rgba(15, 30, 55, 0.8) 100%),
                /* Ambient lighting */
                radial-gradient(ellipse at 80% 70%, rgba(100, 180, 255, 0.15) 0%, transparent 40%),
                radial-gradient(ellipse at 20% 30%, rgba(34, 197, 94, 0.1) 0%, transparent 50%);
        }

        /* Center Monitor/Display Effect - SHOWCASE SCREEN (16:9) */
        .center-monitor {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50vw;
            aspect-ratio: 16 / 9;
            max-width: 85vw;
            max-height: 60vh;
            background: rgba(10, 20, 40, 0.95);
            border: 3px solid rgba(59, 130, 246, 0.6);
            border-radius: 12px;
            box-shadow: 
                0 20px 100px rgba(59, 130, 246, 0.4),
                inset 0 0 80px rgba(59, 130, 246, 0.1);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* Fallback for browsers that don't support aspect-ratio */
        @supports not (aspect-ratio: 16 / 9) {
            .center-monitor {
                height: calc(50vw * 9 / 16);
            }
        }

        /* Showcase Screen Controls */
        .showcase-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(15, 30, 60, 0.8);
            border-bottom: 1px solid rgba(59, 130, 246, 0.3);
        }

        .showcase-controls-left {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .showcase-btn {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.4);
            color: #60a5fa;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .showcase-btn:hover {
            background: rgba(59, 130, 246, 0.3);
            border-color: rgba(59, 130, 246, 0.6);
            transform: translateY(-1px);
        }

        .showcase-btn.recording {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.5);
            color: #ef4444;
        }

        .showcase-btn.recording:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .showcase-mode-selector {
            display: flex;
            gap: 4px;
        }

        .mode-btn {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #94a3b8;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .mode-btn:hover {
            color: #60a5fa;
            border-color: rgba(59, 130, 246, 0.5);
        }

        .mode-btn.active {
            background: rgba(59, 130, 246, 0.3);
            border-color: rgba(59, 130, 246, 0.6);
            color: #3b82f6;
        }

        /* Showcase Content Area */
        .showcase-content {
            flex: 1;
            position: relative;
            background: rgba(15, 30, 60, 0.3);
            overflow: hidden;
        }

        /* Content Display Modes */
        .content-display {
            width: 100%;
            height: 100%;
            display: none;
        }

        .content-display.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .content-display video,
        .content-display img,
        .content-display iframe {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        /* Blueprint Mode (Default) */
        .blueprint-display {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(30, 58, 138, 0.3) 0%, rgba(15, 30, 60, 0.5) 100%);
            position: relative;
        }

        /* Grid overlay on monitor */
        .monitor-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(59, 130, 246, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(59, 130, 246, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        /* Picture-in-Picture Camera View */
        .pip-camera {
            position: absolute;
            bottom: 15px;
            right: 15px;
            width: 180px;
            height: 120px;
            background: rgba(10, 20, 40, 0.95);
            border: 2px solid rgba(34, 197, 94, 0.6);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            display: none;
        }

        .pip-camera.active {
            display: block;
        }

        .pip-camera video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .pip-camera-controls {
            position: absolute;
            top: 5px;
            right: 5px;
            display: flex;
            gap: 5px;
        }

        .pip-btn {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .pip-btn:hover {
            background: rgba(0, 0, 0, 0.9);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .camera-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-size: 14px;
            text-align: center;
            padding: 10px;
        }

        .camera-placeholder-icon {
            font-size: 32px;
            margin-bottom: 8px;
            opacity: 0.5;
        }

        /* Streaming Input Styles */
        .showcase-content input[type="text"] {
            outline: none;
            transition: all 0.3s ease;
        }

        .showcase-content input[type="text"]:focus {
            border-color: rgba(59, 130, 246, 0.8);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.3);
        }

        .showcase-content button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .showcase-content button:active {
            transform: translateY(0px);
        }

        /* Streaming Player Placeholder */
        .streaming-placeholder {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 15px;
            color: #94a3b8;
            background: linear-gradient(135deg, rgba(15, 30, 60, 0.5) 0%, rgba(10, 20, 40, 0.8) 100%);
        }

        /* ========== LIVE VIDEO AD PLAYER ========== */
        .live-ad-player {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #0a1735 0%, #1a2744 50%, #0a1735 100%);
        }

        .live-ad-background {
            position: absolute;
            inset: 0;
            background: 
                radial-gradient(circle at 30% 40%, rgba(59, 130, 246, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 70% 60%, rgba(34, 197, 94, 0.15) 0%, transparent 50%),
                linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, transparent 50%, rgba(34, 197, 94, 0.05) 100%);
            animation: backgroundPulse 8s ease-in-out infinite;
        }

        @keyframes backgroundPulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.05);
            }
        }

        .live-ad-content {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 40px;
            text-align: center;
        }

        /* Live Indicator */
        .live-indicator {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(239, 68, 68, 0.2);
            padding: 6px 12px;
            border-radius: 20px;
            border: 1px solid rgba(239, 68, 68, 0.5);
        }

        .live-dot {
            width: 10px;
            height: 10px;
            background: #ef4444;
            border-radius: 50%;
            animation: livePulse 1.5s ease-in-out infinite;
        }

        @keyframes livePulse {
            0%, 100% {
                opacity: 1;
                box-shadow: 0 0 10px rgba(239, 68, 68, 0.8);
            }
            50% {
                opacity: 0.5;
                box-shadow: 0 0 20px rgba(239, 68, 68, 1);
            }
        }

        .live-text {
            color: #ef4444;
            font-weight: 700;
            font-size: 14px;
            letter-spacing: 1px;
        }

        /* Ad Text Animations */
        .ad-main-text {
            font-size: 3.5rem;
            font-weight: 400;
            color: white;
            font-style: italic;
            margin-bottom: 10px;
            opacity: 0;
            animation: slideInFromLeft 1s ease-out 0.5s forwards;
        }

        .ad-highlight-text {
            font-size: 4rem;
            font-weight: 800;
            background: linear-gradient(135deg, #22c55e, #60a5fa, #22c55e);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            opacity: 0;
            animation: slideInFromRight 1s ease-out 1s forwards, gradientShift 4s ease-in-out infinite;
        }

        .ad-tagline {
            font-size: 3.5rem;
            font-weight: 400;
            color: white;
            font-style: italic;
            margin-bottom: 40px;
            opacity: 0;
            animation: slideInFromLeft 1s ease-out 1.5s forwards;
        }

        .ad-logo {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 30px;
            opacity: 0;
            animation: fadeInScale 1s ease-out 2s forwards;
        }

        .ad-logo-icon {
            font-size: 3.5rem;
            filter: drop-shadow(0 0 20px rgba(34, 197, 94, 0.8));
            animation: iconPulse 2s ease-in-out infinite;
        }

        .ad-logo-text {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(90deg, #ffffff, #60a5fa, #22c55e, #60a5fa, #ffffff);
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: textShimmer 3s linear infinite;
        }

        .ad-subtitle {
            font-size: 1rem;
            letter-spacing: 3px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 10px;
            animation: fadeInUp 1s ease-out 2.5s backwards;
        }

        /* Animation Keyframes */
        @keyframes slideInFromLeft {
            from {
                opacity: 0;
                transform: translateX(-100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInFromRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.5);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes gradientShift {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }

        @keyframes iconPulse {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 20px rgba(34, 197, 94, 0.8));
            }
            50% {
                transform: scale(1.1);
                filter: drop-shadow(0 0 40px rgba(34, 197, 94, 1));
            }
        }

        /* Video Progress Bar */
        .video-progress-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 10;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #22c55e);
            width: 0%;
            animation: progressBar 10s linear infinite;
        }

        @keyframes progressBar {
            from {
                width: 0%;
            }
            to {
                width: 100%;
            }
        }
        /* ========== END LIVE VIDEO AD PLAYER ========== */

        /* ========== DESKTOP OS ENVIRONMENT ========== */
        
        .desktop-area {
            position: fixed;
            left: 120px;
            top: 45px;
            right: 0;
            bottom: 85px;
            background: transparent;
            z-index: 1;
            overflow: hidden;
            transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .sidebar.collapsed ~ .desktop-area {
            left: 0;
        }
        
        /* Desktop Icon - Free positioning */
        .desktop-icon {
            width: 90px;
            height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: move;
            border-radius: 8px;
            padding: 10px;
            transition: background 0.2s ease, box-shadow 0.2s ease;
            position: absolute;
            user-select: none;
            will-change: transform;
        }
        
        .desktop-icon:hover {
            background: rgba(59, 130, 246, 0.15);
        }
        
        .desktop-icon.selected {
            background: rgba(59, 130, 246, 0.3);
            border: 2px solid rgba(59, 130, 246, 0.6);
        }
        
        .desktop-icon.dragging {
            opacity: 0.7;
            transform: scale(0.9);
            cursor: grabbing;
            z-index: 1000;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.5);
        }
        
        .icon-image {
            font-size: 3rem;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        .icon-label {
            font-size: 12px;
            color: white;
            text-align: center;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
            word-wrap: break-word;
            max-width: 80px;
            line-height: 1.2;
        }
        
        /* Trash Count Badge in Dock */
        .trash-count-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: rgba(239, 68, 68, 0.95);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            border: 2px solid rgba(10, 17, 40, 0.95);
        }
        
        /* Trash in dock - drag over effect */
        #dockTrash.drag-over {
            background: rgba(239, 68, 68, 0.5) !important;
            transform: translateY(-20px) scale(1.7) !important;
            box-shadow: 0 0 30px rgba(239, 68, 68, 0.8) !important;
            animation: none !important;
        }
        
        /* Context Menu */
        .context-menu {
            position: fixed;
            background: rgba(20, 30, 50, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(59, 130, 246, 0.4);
            border-radius: 8px;
            padding: 8px 0;
            min-width: 200px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
        }
        
        .context-menu.active {
            display: block;
        }
        
        .context-menu-item {
            padding: 10px 20px;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }
        
        .context-menu-item:hover {
            background: rgba(59, 130, 246, 0.3);
        }
        
        .context-menu-item.danger:hover {
            background: rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }
        
        .context-menu-divider {
            height: 1px;
            background: rgba(59, 130, 246, 0.2);
            margin: 4px 0;
        }
        
        /* ========== APPLICATION LAUNCHER MODAL ========== */
        .app-launcher-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }
        
        .app-launcher-modal.active {
            display: flex;
        }
        
        .app-launcher-window {
            background: linear-gradient(135deg, rgba(10, 20, 40, 0.98), rgba(5, 15, 30, 0.98));
            border: 2px solid rgba(0, 255, 0, 0.5);
            border-radius: 20px;
            width: 90vw;
            max-width: 1400px;
            height: 85vh;
            max-height: 900px;
            overflow: hidden;
            box-shadow: 0 30px 80px rgba(0, 255, 0, 0.3), 0 0 100px rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
        }
        
        .app-launcher-header {
            padding: 25px 30px;
            background: rgba(0, 255, 0, 0.1);
            border-bottom: 2px solid rgba(0, 255, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .app-launcher-title {
            font-size: 28px;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            text-shadow: 0 0 20px rgba(0, 255, 0, 0.6);
        }
        
        .app-launcher-close {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: rgba(255, 255, 255, 0.7);
            background: rgba(239, 68, 68, 0.2);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .app-launcher-close:hover {
            background: rgba(239, 68, 68, 0.4);
            color: white;
            transform: rotate(90deg) scale(1.1);
        }
        
        .app-launcher-tabs {
            display: flex;
            gap: 0;
            padding: 0 30px;
            background: rgba(5, 10, 20, 0.8);
            border-bottom: 1px solid rgba(0, 255, 0, 0.2);
        }
        
        .app-tab {
            padding: 15px 25px;
            color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            user-select: none;
        }
        
        .app-tab:hover {
            color: rgba(0, 255, 0, 0.8);
            background: rgba(0, 255, 0, 0.05);
        }
        
        .app-tab.active {
            color: #00ff00;
            border-bottom-color: #00ff00;
            background: rgba(0, 255, 0, 0.1);
        }
        
        .app-launcher-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            position: relative;
        }
        
        .app-view {
            display: none;
        }
        
        .app-view.active {
            display: block;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .app-category-title {
            font-size: 24px;
            font-weight: 600;
            color: #00ff00;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(0, 255, 0, 0.3);
        }
        
        .recent-header {
            font-size: 20px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
            padding: 15px 20px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 10px;
            border-left: 4px solid #3b82f6;
        }
        
        .app-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 20px;
        }
        
        .app-card {
            background: rgba(20, 30, 50, 0.8);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .app-card:hover {
            transform: translateY(-5px);
            background: rgba(30, 40, 60, 0.9);
            border-color: #00ff00;
            box-shadow: 0 10px 30px rgba(0, 255, 0, 0.3);
        }
        
        .app-card.installed {
            border-color: rgba(34, 197, 94, 0.5);
        }
        
        .app-icon {
            font-size: 48px;
            margin-bottom: 12px;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }
        
        .app-name {
            font-size: 14px;
            font-weight: 600;
            color: white;
            margin-bottom: 6px;
        }
        
        .app-description {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
            line-height: 1.4;
        }
        
        .app-status {
            position: absolute;
            top: 8px;
            right: 8px;
            padding: 4px 8px;
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            font-size: 10px;
            border-radius: 6px;
            font-weight: 600;
        }
        
        .app-install-btn {
            margin-top: 12px;
            padding: 8px 16px;
            background: rgba(59, 130, 246, 0.3);
            color: white;
            border: 1px solid rgba(59, 130, 246, 0.5);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            font-weight: 600;
        }
        
        .app-install-btn:hover {
            background: rgba(59, 130, 246, 0.5);
            border-color: #3b82f6;
            transform: scale(1.05);
        }
        
        .app-install-btn.installed {
            background: rgba(34, 197, 94, 0.3);
            border-color: rgba(34, 197, 94, 0.5);
            cursor: default;
        }
        
        .app-install-btn.installed:hover {
            transform: none;
        }
        
        .store-categories {
            display: flex;
            flex-direction: column;
            gap: 40px;
        }
        
        .store-category {
            padding-bottom: 20px;
        }
        
        .store-category-header {
            font-size: 20px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
            padding: 15px 20px;
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.2), transparent);
            border-radius: 10px;
            border-left: 4px solid #3b82f6;
        }
        /* ========== END APPLICATION LAUNCHER MODAL ========== */
        
        /* System Settings Modal */
        .settings-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .settings-modal.active {
            display: flex;
        }
        
        .settings-window {
            background: linear-gradient(135deg, rgba(15, 30, 60, 0.98), rgba(10, 20, 40, 0.98));
            border: 2px solid rgba(59, 130, 246, 0.5);
            border-radius: 16px;
            width: 700px;
            max-width: 90vw;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        
        .settings-header {
            padding: 20px 25px;
            background: rgba(59, 130, 246, 0.2);
            border-bottom: 1px solid rgba(59, 130, 246, 0.3);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .settings-title {
            font-size: 24px;
            font-weight: 600;
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .settings-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(239, 68, 68, 0.3);
            border: 1px solid rgba(239, 68, 68, 0.5);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .settings-close:hover {
            background: rgba(239, 68, 68, 0.5);
            transform: scale(1.1);
        }
        
        .settings-content {
            padding: 25px;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .settings-section {
            margin-bottom: 25px;
        }
        
        .settings-section-title {
            font-size: 16px;
            font-weight: 600;
            color: #60a5fa;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .settings-item {
            padding: 12px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .settings-item-label {
            color: white;
            font-size: 14px;
        }
        
        .settings-toggle {
            width: 50px;
            height: 26px;
            background: rgba(100, 100, 100, 0.5);
            border-radius: 13px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .settings-toggle.active {
            background: rgba(34, 197, 94, 0.8);
        }
        
        .settings-toggle::after {
            content: '';
            position: absolute;
            left: 3px;
            top: 3px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }
        
        .settings-toggle.active::after {
            transform: translateX(24px);
        }
        
        /* New Folder Dialog */
        .dialog-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            z-index: 1500;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .dialog-overlay.active {
            display: flex;
        }
        
        .dialog-box {
            background: linear-gradient(135deg, rgba(15, 30, 60, 0.98), rgba(10, 20, 40, 0.98));
            border: 2px solid rgba(59, 130, 246, 0.5);
            border-radius: 12px;
            padding: 25px;
            width: 400px;
            max-width: 90vw;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        
        .dialog-title {
            font-size: 20px;
            font-weight: 600;
            color: white;
            margin-bottom: 20px;
        }
        
        .dialog-input {
            width: 100%;
            padding: 12px;
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.4);
            border-radius: 8px;
            color: white;
            font-size: 14px;
            margin-bottom: 20px;
        }
        
        .dialog-input:focus {
            outline: none;
            border-color: rgba(59, 130, 246, 0.8);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.3);
        }
        
        .dialog-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .dialog-btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .dialog-btn-primary {
            background: rgba(59, 130, 246, 0.8);
            color: white;
        }
        
        .dialog-btn-primary:hover {
            background: rgba(59, 130, 246, 1);
            transform: scale(1.05);
        }
        
        .dialog-btn-secondary {
            background: rgba(100, 100, 100, 0.3);
            color: white;
        }
        
        .dialog-btn-secondary:hover {
            background: rgba(100, 100, 100, 0.5);
        }
        
        /* ========== END DESKTOP OS ENVIRONMENT ========== */

        /* Ambient desk glow */
        .desk-glow {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 40%;
            background: radial-gradient(ellipse at center, rgba(59, 130, 246, 0.2) 0%, transparent 70%);
            filter: blur(40px);
        }

        /* Top Bar */
        .top-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 45px;
            background: rgba(10, 17, 40, 0.98);
            backdrop-filter: blur(30px);
            display: flex;
            align-items: center;
            padding: 0 1rem;
            gap: 1.5rem;
            z-index: 100;
            border-bottom: 1px solid rgba(59, 130, 246, 0.3);
        }

        .menu-bar {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex: 1;
        }

        .menu-item {
            position: relative;
            padding: 8px 12px;
            color: white;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s ease;
            user-select: none;
        }

        .menu-item:hover {
            background: rgba(59, 130, 246, 0.2);
        }

        .menu-item.active {
            background: rgba(59, 130, 246, 0.3);
        }
        
        /* NAVΛ Menu Icon */
        .navlambda-menu-icon {
            font-size: 20px;
            font-weight: 700;
            color: #00ff00;
            text-shadow: 0 0 15px rgba(0, 255, 0, 0.8), 0 0 30px rgba(0, 255, 0, 0.5);
            padding: 8px 16px;
            letter-spacing: 1px;
        }
        
        .navlambda-menu-icon:hover {
            background: rgba(0, 255, 0, 0.15);
            text-shadow: 0 0 20px rgba(0, 255, 0, 1), 0 0 40px rgba(0, 255, 0, 0.7);
            transform: scale(1.05);
        }

        /* Dropdown Menu */
        .menu-dropdown {
            position: absolute;
            top: calc(100% + 5px);
            left: 0;
            min-width: 220px;
            background: rgba(20, 30, 50, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(59, 130, 246, 0.4);
            border-radius: 8px;
            padding: 8px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 1001;
        }

        .menu-item:hover .menu-dropdown,
        .menu-dropdown:hover {
            display: block;
        }

        .menu-dropdown-item {
            padding: 10px 20px;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 14px;
        }

        .menu-dropdown-item:hover {
            background: rgba(59, 130, 246, 0.3);
        }

        .menu-dropdown-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .menu-dropdown-item.disabled:hover {
            background: transparent;
        }

        .menu-shortcut {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            margin-left: 20px;
        }

        .menu-divider {
            height: 1px;
            background: rgba(59, 130, 246, 0.2);
            margin: 4px 0;
        }

        .top-bar-right {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .top-bar-link {
            color: #94a3b8;
            text-decoration: none;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
            transition: all 0.2s;
            font-weight: 500;
            padding: 6px 12px;
            border-radius: 6px;
        }

        .top-bar-link:hover {
            color: #60a5fa;
            background: rgba(59, 130, 246, 0.2);
        }

        .top-bar-icon {
            font-size: 1.2rem;
        }

        /* Left Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 45px;
            bottom: 65px;
            width: 120px;
            background: rgba(10, 17, 40, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(59, 130, 246, 0.2);
            padding: 1rem 0;
            z-index: 50;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow-y: auto;
            overflow-x: hidden;
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1), 
                        transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .sidebar.collapsed {
            width: 0;
            padding: 0;
            border-right: none;
            transform: translateX(-100%);
        }
        
        /* Sidebar toggle button */
        .sidebar-toggle {
            position: fixed;
            left: 120px;
            top: 50%;
            transform: translateY(-50%);
            width: 30px;
            height: 60px;
            background: rgba(59, 130, 246, 0.3);
            border: 1px solid rgba(59, 130, 246, 0.5);
            border-left: none;
            border-radius: 0 8px 8px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 60;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
        }
        
        .sidebar-toggle:hover {
            background: rgba(59, 130, 246, 0.5);
            width: 35px;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.6);
        }
        
        .sidebar-toggle:active {
            transform: translateY(-50%) scale(0.95);
        }
        
        .sidebar-toggle::before {
            content: '‹';
            color: white;
            font-size: 24px;
            font-weight: bold;
            transition: transform 0.4s ease;
        }
        
        /* Subtle pulse animation to indicate interactivity */
        @keyframes togglePulse {
            0%, 100% {
                box-shadow: 0 0 10px rgba(59, 130, 246, 0.3);
            }
            50% {
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
            }
        }
        
        .sidebar-toggle {
            animation: togglePulse 3s ease-in-out infinite;
        }
        
        .sidebar-toggle:hover {
            animation: none;
        }
        
        .sidebar.collapsed + .sidebar-toggle {
            left: 0;
        }
        
        .sidebar.collapsed + .sidebar-toggle::before {
            content: '›';
            transform: rotate(0deg);
        }

        .sidebar-nav {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            transition: opacity 0.3s ease;
        }
        
        .sidebar.collapsed .sidebar-nav {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Sidebar Drop Zone */
        .sidebar-dropzone {
            margin: 0.5rem auto;
            padding: 1.5rem 0.5rem;
            border: 2px dashed rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            background: rgba(59, 130, 246, 0.05);
            text-align: center;
            transition: all 0.3s ease;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .sidebar-dropzone.drag-over {
            border-color: rgba(59, 130, 246, 0.8);
            background: rgba(59, 130, 246, 0.2);
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
        }
        
        .dropzone-hint {
            font-size: 12px;
            color: rgba(148, 163, 184, 0.7);
            pointer-events: none;
        }
        
        .sidebar-dropzone.drag-over .dropzone-hint {
            color: rgba(96, 165, 250, 1);
        }
        
        #sidebarFavorites {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }
        
        .sidebar-favorite-item {
            display: flex;
            align-items: center;
            padding: 0.6rem;
            gap: 0.5rem;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }
        
        .sidebar-favorite-item:hover {
            background: rgba(59, 130, 246, 0.2);
            transform: translateX(5px);
        }
        
        .sidebar-favorite-icon {
            font-size: 1.5rem;
        }
        
        .sidebar-favorite-name {
            flex: 1;
            font-size: 12px;
            color: white;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .sidebar-favorite-remove {
            opacity: 0;
            font-size: 14px;
            color: rgba(239, 68, 68, 0.8);
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .sidebar-favorite-item:hover .sidebar-favorite-remove {
            opacity: 1;
        }
        
        .sidebar-favorite-remove:hover {
            background: rgba(239, 68, 68, 0.2);
            color: rgba(239, 68, 68, 1);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.8rem 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            color: #94a3b8;
            gap: 0.4rem;
            width: 100%;
            box-sizing: border-box;
        }

        .nav-item:hover {
            background: rgba(59, 130, 246, 0.15);
            color: #60a5fa;
        }

        .nav-icon {
            font-size: 2.5rem;
            transition: all 0.3s;
            filter: drop-shadow(0 4px 8px rgba(59, 130, 246, 0.3));
            line-height: 1;
        }

        .nav-item:hover .nav-icon {
            transform: scale(1.05);
            filter: drop-shadow(0 8px 16px rgba(59, 130, 246, 0.5));
        }

        .nav-label {
            font-size: 0.7rem;
            font-weight: 500;
            text-align: center;
            line-height: 1.2;
            word-wrap: break-word;
            max-width: 100%;
            overflow: hidden;
        }

        .nav-section-title {
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #64748b;
            padding: 0.6rem 0.5rem 0.3rem;
            text-align: center;
            width: 100%;
            box-sizing: border-box;
        }

        /* Feedback Button - Removed for cleaner interface */

        /* Bottom Right Branding */
        /* Branding Animation Keyframes */
        @keyframes glowPulse {
            0%, 100% {
                box-shadow: 0 8px 32px rgba(59, 130, 246, 0.3),
                            0 0 40px rgba(34, 197, 94, 0.2);
            }
            50% {
                box-shadow: 0 12px 48px rgba(59, 130, 246, 0.5),
                            0 0 60px rgba(34, 197, 94, 0.4);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -200% center;
            }
            100% {
                background-position: 200% center;
            }
        }

        .branding {
            position: fixed;
            z-index: 60;
            display: flex;
            align-items: flex-end;
            gap: 2.5rem;
            text-shadow: 0 2px 20px rgba(0, 0, 0, 0.5);
            cursor: move;
            user-select: none;
            transition: box-shadow 0.3s ease, transform 0.3s ease;
            will-change: left, top;
        }

        /* Institute Logo - positioned top right */
        .branding-logo {
            top: 8rem;
            right: 3rem;
        }

        /* Career Tagline - positioned below logo */
        .branding-tagline {
            bottom: 10rem;
            right: 3rem;
        }

        .branding:hover {
            filter: brightness(1.1);
            transform: scale(1.02);
        }

        .branding.dragging {
            animation: none !important;
            cursor: grabbing !important;
            opacity: 0.9;
            filter: drop-shadow(0 20px 40px rgba(59, 130, 246, 0.6));
            z-index: 1000;
            transition: none !important;
        }
        
        .branding.dragging * {
            pointer-events: none;
        }

        /* Drag handle indicator */
        .branding::before {
            content: '⋮⋮';
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(59, 130, 246, 0.5);
            font-size: 18px;
            letter-spacing: 2px;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .branding:hover::before {
            opacity: 1;
        }

        .branding.dragging::before {
            opacity: 1;
            color: rgba(34, 197, 94, 0.8);
        }

        /* Reset position button */
        .branding-reset-btn {
            position: absolute;
            top: -30px;
            right: 0;
            background: rgba(239, 68, 68, 0.3);
            border: 1px solid rgba(239, 68, 68, 0.5);
            color: #ef4444;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s ease;
            pointer-events: none;
            font-weight: 600;
        }

        .branding:hover .branding-reset-btn {
            opacity: 1;
            pointer-events: all;
        }

        .branding-reset-btn:hover {
            background: rgba(239, 68, 68, 0.5);
            transform: scale(1.1);
        }

        .branding-reset-btn:active {
            transform: scale(0.95);
        }

        .institute-logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: linear-gradient(
                135deg,
                rgba(10, 17, 40, 0.85) 0%,
                rgba(20, 30, 60, 0.85) 50%,
                rgba(10, 17, 40, 0.85) 100%
            );
            background-size: 200% 100%;
            backdrop-filter: blur(20px);
            padding: 1.2rem 1.8rem;
            border-radius: 16px;
            border: 2px solid rgba(59, 130, 246, 0.4);
            animation: glowPulse 3s ease-in-out infinite;
            transition: all 0.3s ease;
        }

        .institute-logo:hover {
            transform: scale(1.05);
            border-color: rgba(59, 130, 246, 0.8);
            background: linear-gradient(
                135deg,
                rgba(15, 25, 50, 0.95) 0%,
                rgba(30, 45, 80, 0.95) 50%,
                rgba(15, 25, 50, 0.95) 100%
            );
        }

        @keyframes logoIconPulse {
            0%, 100% {
                filter: drop-shadow(0 0 20px rgba(34, 197, 94, 0.6));
                transform: scale(1);
            }
            50% {
                filter: drop-shadow(0 0 40px rgba(34, 197, 94, 0.9))
                        drop-shadow(0 0 60px rgba(59, 130, 246, 0.5));
                transform: scale(1.1);
            }
        }

        .logo-icon {
            font-size: 3.5rem;
            filter: drop-shadow(0 0 20px rgba(34, 197, 94, 0.6));
            animation: logoIconPulse 3s ease-in-out infinite;
            transition: transform 0.3s ease;
        }

        .logo-icon:hover {
            transform: scale(1.2) rotate(5deg);
            filter: drop-shadow(0 0 40px rgba(34, 197, 94, 1))
                    drop-shadow(0 0 60px rgba(59, 130, 246, 0.8));
        }

        .logo-text-container {
            display: flex;
            flex-direction: column;
        }

        @keyframes textShimmer {
            0% {
                background-position: -200% center;
            }
            100% {
                background-position: 200% center;
            }
        }

        .logo-main-text {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(
                90deg,
                #ffffff 0%,
                #60a5fa 25%,
                #22c55e 50%,
                #60a5fa 75%,
                #ffffff 100%
            );
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 2px;
            line-height: 1;
            animation: textShimmer 6s linear infinite;
            filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.9));
        }

        .logo-subtitle {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.95);
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-top: 0.2rem;
            text-shadow: 0 2px 6px rgba(0, 0, 0, 0.9),
                         0 0 15px rgba(59, 130, 246, 0.5);
            animation: textGlow 3s ease-in-out infinite;
        }

        @keyframes textGlow {
            0%, 100% {
                text-shadow: 0 2px 10px rgba(0, 0, 0, 0.9),
                             0 0 20px rgba(59, 130, 246, 0.4),
                             0 0 30px rgba(34, 197, 94, 0.2);
            }
            50% {
                text-shadow: 0 2px 15px rgba(0, 0, 0, 0.9),
                             0 0 40px rgba(59, 130, 246, 0.6),
                             0 0 50px rgba(34, 197, 94, 0.4);
            }
        }

        .tagline {
            font-size: 2.2rem;
            font-weight: 400;
            color: white;
            font-style: italic;
            text-align: right;
            line-height: 1.3;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.9),
                         0 0 20px rgba(59, 130, 246, 0.4);
            background: linear-gradient(
                135deg,
                rgba(10, 17, 40, 0.6) 0%,
                rgba(20, 30, 60, 0.6) 50%,
                rgba(10, 17, 40, 0.6) 100%
            );
            backdrop-filter: blur(15px);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            border: 1px solid rgba(59, 130, 246, 0.3);
            animation: floatTagline 5s ease-in-out infinite,
                       textGlow 4s ease-in-out infinite;
            transition: all 0.3s ease;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.3);
        }

        .tagline:hover {
            transform: scale(1.05);
            border-color: rgba(59, 130, 246, 0.6);
            background: linear-gradient(
                135deg,
                rgba(15, 25, 50, 0.8) 0%,
                rgba(30, 45, 80, 0.8) 50%,
                rgba(15, 25, 50, 0.8) 100%
            );
        }

        .tagline strong {
            font-weight: 800;
            background: linear-gradient(135deg, #22c55e, #60a5fa);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            display: block;
            filter: drop-shadow(0 0 15px rgba(34, 197, 94, 0.6));
        }

        /* Bottom Icon Bar */
        .bottom-icon-bar {
            position: fixed;
            bottom: 0;
            left: 120px;
            right: 0;
            height: 85px;
            background: rgba(10, 17, 40, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(59, 130, 246, 0.2);
            display: flex;
            align-items: flex-end;
            padding: 0 2rem 10px 2rem;
            gap: 1rem;
            z-index: 50;
            transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .sidebar.collapsed ~ .bottom-icon-bar {
            left: 0;
        }

        .bottom-icon {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(34, 197, 94, 0.3));
            border: 2px solid rgba(59, 130, 246, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), 
                        box-shadow 0.35s cubic-bezier(0.34, 1.56, 0.64, 1),
                        filter 0.25s ease,
                        background 0.25s ease;
            transform-origin: center bottom;
            will-change: transform, box-shadow;
            position: relative;
            backface-visibility: hidden;
            -webkit-font-smoothing: antialiased;
        }

        .bottom-icon:hover {
            transform: translateY(-20px) scale(1.6);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.7), 0 20px 60px rgba(59, 130, 246, 0.4);
            filter: brightness(1.2);
            z-index: 10;
            animation: none;
        }

        /* Ultra-smooth magnifying dock effect - adjacent icons */
        .bottom-icon.neighbor-1 {
            transform: translateY(-12px) scale(1.35);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
            transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), 
                        box-shadow 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .bottom-icon.neighbor-2 {
            transform: translateY(-6px) scale(1.2);
            box-shadow: 0 3px 15px rgba(59, 130, 246, 0.3);
            transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), 
                        box-shadow 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        .bottom-icon.neighbor-3 {
            transform: translateY(-3px) scale(1.1);
            box-shadow: 0 2px 10px rgba(59, 130, 246, 0.2);
            transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), 
                        box-shadow 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .bottom-icon.active {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.6), rgba(34, 197, 94, 0.6));
            border: 2px solid rgba(59, 130, 246, 0.8);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.6);
        }

        .bottom-icon.active:hover {
            transform: translateY(-20px) scale(1.6);
        }
        
        /* Subtle breathing animation when not hovering */
        @keyframes dockIdle {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-1px) scale(1.01); }
        }
        
        .bottom-icon:not(:hover):not(.neighbor-1):not(.neighbor-2):not(.neighbor-3) {
            animation: dockIdle 3s ease-in-out infinite;
        }
        
        /* Dock-style tooltip labels */
        .bottom-icon::after {
            content: attr(title);
            position: absolute;
            bottom: calc(100% + 15px);
            left: 50%;
            transform: translateX(-50%) scale(0.8);
            background: rgba(10, 20, 40, 0.95);
            color: white;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease, transform 0.3s ease;
            border: 1px solid rgba(59, 130, 246, 0.4);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            font-weight: 500;
        }
        
        .bottom-icon:hover::after {
            opacity: 1;
            transform: translateX(-50%) scale(1);
        }
        
        /* ========== DOCK ENHANCEMENTS ========== */
        
        /* Ultra-smooth dock optimizations */
        .bottom-icon-bar {
            /* Force hardware acceleration */
            transform: translate3d(0, 0, 0);
            perspective: 1000px;
        }
        
        .bottom-icon {
            /* Force GPU acceleration for ultra-smooth animations */
            transform: translate3d(0, 0, 0);
            perspective: 1000px;
        }
        
        /* Smooth transitions for all dock size variants */
        .bottom-icon-bar.small .bottom-icon,
        .bottom-icon-bar.medium .bottom-icon,
        .bottom-icon-bar.large .bottom-icon {
            transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), 
                        box-shadow 0.35s cubic-bezier(0.34, 1.56, 0.64, 1),
                        filter 0.25s ease,
                        background 0.25s ease;
        }
        
        /* Dock Divider */
        .dock-divider {
            width: 2px;
            height: 35px;
            background: rgba(59, 130, 246, 0.3);
            margin: 0 8px;
            transition: height 0.3s ease;
        }
        
        /* Dock Badge */
        .dock-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            font-size: 12px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
        }
        
        /* Browser Selector */
        .browser-selector {
            position: absolute;
            bottom: calc(100% + 10px);
            left: 50%;
            transform: translateX(-50%) scale(0.8);
            background: rgba(15, 25, 45, 0.98);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(59, 130, 246, 0.5);
            border-radius: 12px;
            padding: 8px;
            min-width: 180px;
            display: none;
            flex-direction: column;
            gap: 4px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .browser-selector.active {
            display: flex;
            transform: translateX(-50%) scale(1);
        }
        
        @keyframes popIn {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(10px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0) scale(1);
            }
        }
        
        .browser-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            font-weight: 500;
        }
        
        .browser-option:hover {
            background: rgba(59, 130, 246, 0.3);
            color: white;
            transform: translateX(3px);
        }
        
        .browser-option.active {
            background: rgba(59, 130, 246, 0.4);
            border-left: 3px solid #3b82f6;
        }
        
        .browser-opt-icon {
            font-size: 20px;
        }
        
        /* Dock Size Classes */
        .bottom-icon-bar.small .bottom-icon {
            width: 35px;
            height: 35px;
            font-size: 1.2rem;
        }
        
        .bottom-icon-bar.small .bottom-icon:hover {
            transform: translateY(-15px) scale(1.5);
        }
        
        .bottom-icon-bar.large .bottom-icon {
            width: 55px;
            height: 55px;
            font-size: 1.8rem;
        }
        
        .bottom-icon-bar.large .bottom-icon:hover {
            transform: translateY(-25px) scale(1.7);
        }
        
        .bottom-icon-bar.magnification-disabled .bottom-icon:hover {
            transform: translateY(0) scale(1.1) !important;
            animation: none !important;
        }
        
        .bottom-icon-bar.magnification-disabled .bottom-icon.neighbor-1,
        .bottom-icon-bar.magnification-disabled .bottom-icon.neighbor-2 {
            transform: none !important;
        }
        /* ========== END DOCK ENHANCEMENTS ========== */
        
        /* ========== DOCK CONTROLLER MODAL ========== */
        .dock-controller-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(15px);
            z-index: 2500;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .dock-controller-modal.active {
            display: flex;
        }
        
        .dock-controller-window {
            background: linear-gradient(135deg, rgba(15, 30, 60, 0.98), rgba(10, 20, 40, 0.98));
            border: 2px solid rgba(0, 255, 0, 0.4);
            border-radius: 16px;
            width: 500px;
            max-width: 90vw;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 255, 0, 0.3);
        }
        
        .dock-controller-header {
            padding: 20px 25px;
            background: rgba(0, 255, 0, 0.1);
            border-bottom: 1px solid rgba(0, 255, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .dock-controller-title {
            font-size: 20px;
            font-weight: 600;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .dock-controller-close {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: rgba(255, 255, 255, 0.7);
            background: rgba(239, 68, 68, 0.2);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .dock-controller-close:hover {
            background: rgba(239, 68, 68, 0.4);
            color: white;
            transform: rotate(90deg);
        }
        
        .dock-controller-content {
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .dock-setting-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .dock-setting-label {
            font-size: 16px;
            font-weight: 600;
            color: #00ff00;
            margin-bottom: 5px;
        }
        
        .dock-size-options {
            display: flex;
            gap: 15px;
        }
        
        .dock-size-btn {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: rgba(20, 30, 50, 0.8);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .dock-size-btn:hover {
            background: rgba(30, 40, 60, 0.9);
            border-color: rgba(0, 255, 0, 0.5);
            transform: translateY(-2px);
        }
        
        .dock-size-btn.active {
            background: rgba(0, 255, 0, 0.2);
            border-color: #00ff00;
        }
        
        .size-preview {
            width: 60px;
            height: 12px;
            background: rgba(59, 130, 246, 0.5);
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .size-preview.small {
            width: 40px;
            height: 8px;
        }
        
        .size-preview.large {
            width: 80px;
            height: 16px;
        }
        
        .dock-size-btn.active .size-preview {
            background: #00ff00;
        }
        
        .dock-toggle-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: rgba(20, 30, 50, 0.6);
            border-radius: 8px;
        }
        
        .dock-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }
        
        .dock-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .dock-slider {
            position: absolute;
            cursor: pointer;
            inset: 0;
            background-color: rgba(100, 100, 100, 0.4);
            transition: 0.4s;
            border-radius: 26px;
        }
        
        .dock-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }
        
        input:checked + .dock-slider {
            background-color: #00ff00;
        }
        
        input:checked + .dock-slider:before {
            transform: translateX(24px);
        }
        
        .magnification-slider {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 15px;
            background: rgba(20, 30, 50, 0.6);
            border-radius: 8px;
        }
        
        .magnification-slider input[type="range"] {
            flex: 1;
            height: 6px;
            background: rgba(100, 100, 100, 0.3);
            border-radius: 3px;
            outline: none;
        }
        
        .magnification-slider input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: #00ff00;
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0, 255, 0, 0.4);
        }
        
        .speed-options {
            display: flex;
            gap: 10px;
        }
        
        .speed-btn {
            flex: 1;
            padding: 10px 15px;
            background: rgba(20, 30, 50, 0.8);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .speed-btn:hover {
            background: rgba(30, 40, 60, 0.9);
            border-color: rgba(0, 255, 0, 0.5);
        }
        
        .speed-btn.active {
            background: rgba(0, 255, 0, 0.2);
            border-color: #00ff00;
            color: #00ff00;
        }
        /* ========== END DOCK CONTROLLER MODAL ========== */
        
        /* ========== TRASH VIEWER MODAL ========== */
        .trash-viewer-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(15px);
            z-index: 2500;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .trash-viewer-modal.active {
            display: flex;
        }
        
        .trash-viewer-window {
            background: linear-gradient(135deg, rgba(15, 30, 60, 0.98), rgba(10, 20, 40, 0.98));
            border: 2px solid rgba(239, 68, 68, 0.5);
            border-radius: 16px;
            width: 800px;
            max-width: 90vw;
            height: 600px;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(239, 68, 68, 0.3);
            display: flex;
            flex-direction: column;
        }
        
        .trash-viewer-header {
            padding: 20px 25px;
            background: rgba(239, 68, 68, 0.1);
            border-bottom: 1px solid rgba(239, 68, 68, 0.3);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .trash-viewer-title {
            font-size: 20px;
            font-weight: 600;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .trash-item-count {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 400;
            margin-left: 10px;
        }
        
        .trash-viewer-close {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: rgba(255, 255, 255, 0.7);
            background: rgba(239, 68, 68, 0.2);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .trash-viewer-close:hover {
            background: rgba(239, 68, 68, 0.4);
            color: white;
            transform: rotate(90deg);
        }
        
        .trash-viewer-toolbar {
            padding: 15px 25px;
            background: rgba(10, 20, 30, 0.6);
            border-bottom: 1px solid rgba(59, 130, 246, 0.2);
            display: flex;
            gap: 10px;
        }
        
        .trash-btn {
            padding: 8px 16px;
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.4);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .trash-btn:hover {
            background: rgba(59, 130, 246, 0.4);
            transform: translateY(-2px);
        }
        
        .trash-empty {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.4);
        }
        
        .trash-empty:hover {
            background: rgba(239, 68, 68, 0.4);
        }
        
        .trash-viewer-content {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
        }
        
        .trash-empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: rgba(255, 255, 255, 0.5);
        }
        
        .empty-icon {
            font-size: 80px;
            margin-bottom: 20px;
            opacity: 0.3;
        }
        
        .empty-text {
            font-size: 18px;
        }
        
        .trash-items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
        }
        
        .trash-item-card {
            background: rgba(20, 30, 50, 0.8);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        
        .trash-item-card:hover {
            border-color: rgba(239, 68, 68, 0.6);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
        }
        
        .trash-item-card.selected {
            border-color: #00ff00;
            background: rgba(0, 255, 0, 0.1);
        }
        
        .trash-item-icon {
            font-size: 40px;
            margin-bottom: 8px;
        }
        
        .trash-item-name {
            font-size: 12px;
            color: white;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .trash-item-actions {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        .trash-action-btn {
            flex: 1;
            padding: 5px;
            background: rgba(59, 130, 246, 0.3);
            border: 1px solid rgba(59, 130, 246, 0.5);
            border-radius: 6px;
            color: white;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.2s ease;
        }
        
        .trash-action-btn:hover {
            background: rgba(59, 130, 246, 0.5);
        }
        
        .trash-action-btn.delete {
            background: rgba(239, 68, 68, 0.3);
            border-color: rgba(239, 68, 68, 0.5);
        }
        
        .trash-action-btn.delete:hover {
            background: rgba(239, 68, 68, 0.5);
        }
        /* ========== END TRASH VIEWER MODAL ========== */

        .bottom-right-info {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .info-icon {
            width: 40px;
            height: 40px;
            background: rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .info-icon:hover {
            background: rgba(59, 130, 246, 0.3);
        }

        /* Language button - always white */
        .language-btn {
            color: white !important;
            font-weight: 600;
            font-size: 0.9rem !important;
        }

        /* Power button - dynamic colors */
        .power-btn {
            font-size: 1.4rem !important;
            transition: all 0.3s ease;
        }

        .time-display {
            font-size: 1.2rem;
            color: white;
            font-weight: 600;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .date-display {
            font-size: 0.8rem;
            color: #94a3b8;
        }

        #analogClock {
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.3);
        }

        /* City Selector */
        .city-selector {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(0, 255, 0, 0.3);
            border-radius: 6px;
            color: #00ff00;
            padding: 4px 8px;
            font-size: 0.75rem;
            cursor: pointer;
            outline: none;
        }

        .city-selector option {
            background: #0a1735;
            color: #00ff00;
        }

        /* News Feed Styles */
        .news-feed-content {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .news-item {
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            border-left: 3px solid #00ff00;
        }

        .news-category {
            font-size: 0.7rem;
            color: #00ff00;
            font-weight: 600;
            margin-bottom: 4px;
            text-transform: uppercase;
        }

        .news-title {
            font-size: 0.85rem;
            color: white;
            margin-bottom: 4px;
            line-height: 1.3;
        }

        .news-time {
            font-size: 0.7rem;
            color: #64748b;
        }

        .widget-refresh, .widget-live {
            font-size: 0.8rem;
            color: #00ff00;
            cursor: pointer;
        }

        .widget-live {
            animation: pulse 2s ease-in-out infinite;
        }

        /* Currency Calculator */
        .currency-calc {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .currency-row {
            display: flex;
            gap: 8px;
        }

        .currency-input {
            flex: 1;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(0, 255, 0, 0.3);
            border-radius: 6px;
            color: #00ff00;
            padding: 8px;
            font-size: 1rem;
            font-weight: 600;
            outline: none;
        }

        .currency-select-small {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(0, 255, 0, 0.3);
            border-radius: 6px;
            color: #00ff00;
            padding: 8px;
            font-size: 0.85rem;
            cursor: pointer;
            outline: none;
        }

        .currency-select-small option {
            background: #0a1735;
            color: #00ff00;
        }

        .currency-arrow {
            text-align: center;
            color: #00ff00;
            font-size: 1.2rem;
        }

        .convert-btn-small {
            background: linear-gradient(135deg, rgba(0, 255, 0, 0.2), rgba(0, 255, 0, 0.3));
            border: 1px solid #00ff00;
            border-radius: 6px;
            color: #00ff00;
            padding: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .convert-btn-small:hover {
            background: linear-gradient(135deg, rgba(0, 255, 0, 0.3), rgba(0, 255, 0, 0.4));
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
        }

        /* Stock Market Styles */
        .stocks-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .stock-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
        }

        .stock-symbol {
            font-size: 0.9rem;
            font-weight: 700;
            color: #00ff00;
        }

        .stock-price {
            font-size: 0.9rem;
            color: white;
            font-family: 'Courier New', monospace;
        }

        .stock-change {
            font-size: 0.75rem;
            font-weight: 600;
        }

        .stock-change.positive {
            color: #22c55e;
        }

        .stock-change.negative {
            color: #ef4444;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .center-monitor {
                width: 60%;
                height: 40%;
            }

            .branding {
                flex-direction: column;
                align-items: flex-end;
                gap: 1rem;
            }

            .tagline {
                font-size: 1.5rem;
            }
            
            /* 16:9 Monitor responsive */
            .center-monitor {
                width: 60vw;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 80px;
            }
            
            .sidebar.collapsed {
                width: 0;
            }
            
            .sidebar-toggle {
                left: 80px;
                width: 25px;
                height: 50px;
            }
            
            .sidebar.collapsed + .sidebar-toggle {
                left: 0;
            }

            .bottom-icon-bar {
                left: 80px;
                height: 70px;
                padding: 0 1rem 8px 1rem;
            }
            
            .sidebar.collapsed ~ .bottom-icon-bar {
                left: 0;
            }
            
            .bottom-icon {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
            
            .bottom-icon:hover {
                transform: translateY(-15px) scale(1.4);
            }
            
            .bottom-icon.neighbor-1 {
                transform: translateY(-10px) scale(1.25);
            }
            
            .bottom-icon.neighbor-2 {
                transform: translateY(-5px) scale(1.15);
            }

            .nav-label {
                font-size: 0.65rem;
            }

            .branding {
                font-size: 0.8rem;
                bottom: 12rem;
                right: 1.5rem;
            }

            .tagline {
                font-size: 1.2rem;
            }
            
            /* 16:9 Monitor responsive */
            .center-monitor {
                width: 80vw;
                max-width: 90vw;
            }
            
            .showcase-controls {
                padding: 6px 8px;
            }
            
            .showcase-btn {
                padding: 3px 8px;
                font-size: 11px;
            }
            
            .mode-btn {
                padding: 3px 6px;
                font-size: 10px;
            }
            
            /* Live Ad responsive */
            .ad-main-text {
                font-size: 2rem;
            }
            
            .ad-highlight-text {
                font-size: 2.5rem;
            }
            
            .ad-tagline {
                font-size: 2rem;
            }
            
            .ad-logo-icon {
                font-size: 2rem;
            }
            
            .ad-logo-text {
                font-size: 1.5rem;
            }

            .institute-logo {
                padding: 0.8rem 1rem;
            }

            .logo-name {
                font-size: 1.5rem;
            }
        }

        /* AI Modal Styles */
        .ai-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .ai-modal.active {
            display: flex;
        }

        .ai-panel {
            background: #1a1a1a;
            width: 90%;
            max-width: 700px;
            height: 80vh;
            border-radius: 16px;
            border: 2px solid rgba(59, 130, 246, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.5);
        }

        .ai-header {
            background: #252526;
            border-bottom: 1px solid #3c3c3c;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 8px;
        }

        .ai-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 14px;
            color: #cccccc;
        }

        .ai-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .model-selector {
            padding: 6px 10px;
            background: #3c3c3c;
            color: #cccccc;
            border: 1px solid #505050;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            outline: none;
        }

        .settings-btn, .close-btn {
            padding: 6px 10px;
            background: #3c3c3c;
            color: #cccccc;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .settings-btn:hover, .close-btn:hover {
            background: #505050;
        }

        .ai-status {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: #858585;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ec9b0;
        }

        .status-dot.warning {
            background: #ffa500;
        }

        .status-dot.thinking {
            background: #ffa500;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        .ai-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .message {
            display: flex;
            gap: 12px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            background: #2d2d30;
            flex-shrink: 0;
        }

        .message-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }

        .message-role {
            font-weight: 600;
            color: #cccccc;
        }

        .message.user .message-role {
            color: #4fc1ff;
        }

        .message.assistant .message-role {
            color: #4ec9b0;
        }

        .message-time {
            color: #858585;
            font-size: 11px;
        }

        .message-text {
            padding: 12px;
            background: #252526;
            border-radius: 6px;
            line-height: 1.6;
            font-size: 13px;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: #cccccc;
        }

        .message.user .message-text {
            background: #1e3a5f;
            border-left: 3px solid #4fc1ff;
        }

        .message.assistant .message-text {
            background: #1e2d1e;
            border-left: 3px solid #4ec9b0;
        }

        .ai-input-area {
            border-top: 1px solid #3c3c3c;
            background: #252526;
            padding: 12px;
        }

        .symbol-toolbar {
            display: flex;
            gap: 6px;
            padding-bottom: 8px;
            border-bottom: 1px solid #3c3c3c;
            margin-bottom: 8px;
        }

        .symbol-btn {
            padding: 6px 10px;
            background: #3c3c3c;
            color: #cccccc;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .symbol-btn:hover {
            background: #505050;
        }

        .input-container {
            display: flex;
            gap: 8px;
            align-items: flex-end;
        }

        .ai-input {
            flex: 1;
            padding: 10px 12px;
            background: #1e1e1e;
            color: #cccccc;
            border: 1px solid #3c3c3c;
            border-radius: 6px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 13px;
            line-height: 1.5;
            resize: none;
            outline: none;
        }

        .ai-input:focus {
            border-color: #007acc;
        }

        .send-btn {
            padding: 10px 16px;
            background: #007acc;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            height: 40px;
            transition: all 0.2s;
        }

        .send-btn:hover:not(:disabled) {
            background: #005a9e;
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .ai-settings-panel {
            background: #1e1e1e;
            padding: 16px;
            border-bottom: 1px solid #3c3c3c;
            display: none;
        }

        .ai-settings-panel.active {
            display: block;
        }

        .settings-label {
            font-size: 12px;
            font-weight: 600;
            color: #cccccc;
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
        }

        .get-key-link {
            color: #007acc;
            text-decoration: none;
            font-weight: normal;
            font-size: 11px;
        }

        .api-key-input {
            width: 100%;
            padding: 8px 12px;
            background: #252526;
            color: #cccccc;
            border: 1px solid #3c3c3c;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            outline: none;
        }

        .api-key-input:focus {
            border-color: #007acc;
        }

        .model-info {
            margin-top: 12px;
            padding: 12px;
            background: #252526;
            border-radius: 4px;
            border-left: 3px solid #007acc;
        }

        .model-info strong {
            display: block;
            color: #4fc1ff;
            font-size: 13px;
            margin-bottom: 6px;
        }

        .model-info p {
            margin: 4px 0;
            font-size: 12px;
            color: #cccccc;
        }

        .warning-message {
            margin-top: 12px;
            padding: 12px;
            background: rgba(255, 165, 0, 0.1);
            border: 1px solid rgba(255, 165, 0, 0.3);
            border-radius: 4px;
            color: #ffa500;
            font-size: 12px;
        }

        /* Documentation Modal Styles */
        .docs-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .docs-modal.active {
            display: flex;
        }

        .docs-panel {
            background: #1a1a1a;
            width: 95%;
            max-width: 1200px;
            height: 90vh;
            border-radius: 16px;
            border: 2px solid rgba(59, 130, 246, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.5);
        }

        .docs-header {
            background: #252526;
            border-bottom: 1px solid #3c3c3c;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .docs-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
            font-size: 18px;
            color: #cccccc;
        }

        .docs-nav {
            background: #2d2d30;
            border-bottom: 1px solid #3c3c3c;
            padding: 8px 12px;
            display: flex;
            gap: 8px;
            overflow-x: auto;
            flex-wrap: wrap;
        }

        .docs-tab {
            padding: 8px 16px;
            background: transparent;
            color: #cccccc;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .docs-tab:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .docs-tab.active {
            background: #007acc;
            color: white;
        }

        .docs-content {
            flex: 1;
            overflow-y: auto;
            padding: 32px;
            color: #cccccc;
            line-height: 1.7;
        }

        .docs-section {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .docs-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .docs-content h1 {
            color: #4fc1ff;
            font-size: 32px;
            margin-bottom: 16px;
            font-weight: 700;
        }

        .docs-content h2 {
            color: #569cd6;
            font-size: 24px;
            margin-top: 32px;
            margin-bottom: 16px;
            font-weight: 600;
        }

        .docs-content h3 {
            color: #4ec9b0;
            font-size: 18px;
            margin-top: 24px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .docs-content h4 {
            color: #dcdcaa;
            font-size: 16px;
            margin-top: 16px;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .docs-content p {
            margin-bottom: 16px;
        }

        .docs-content .lead {
            font-size: 18px;
            color: #b0b0b0;
            margin-bottom: 32px;
        }

        .docs-content ul, .docs-content ol {
            margin-bottom: 16px;
            padding-left: 24px;
        }

        .docs-content li {
            margin-bottom: 8px;
        }

        .docs-content code {
            background: #2d2d30;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #ce9178;
        }

        .docs-content kbd {
            background: #2d2d30;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #dcdcaa;
            border: 1px solid #3c3c3c;
            box-shadow: 0 2px 0 #1a1a1a;
        }

        .code-block {
            background: #1e1e1e;
            border: 1px solid #3c3c3c;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.6;
            color: #d4d4d4;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 32px 0;
        }

        .feature-card {
            background: #252526;
            padding: 24px;
            border-radius: 12px;
            border: 1px solid #3c3c3c;
            transition: all 0.3s;
        }

        .feature-card:hover {
            border-color: #007acc;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 122, 204, 0.2);
        }

        .feature-icon {
            font-size: 40px;
            margin-bottom: 16px;
        }

        .feature-card h3 {
            margin: 0 0 12px 0;
        }

        .feature-card p {
            margin: 0;
            color: #b0b0b0;
            font-size: 14px;
        }

        .info-box {
            background: rgba(0, 122, 204, 0.1);
            border-left: 4px solid #007acc;
            padding: 20px;
            margin: 24px 0;
            border-radius: 8px;
        }

        .info-box.success {
            background: rgba(78, 201, 176, 0.1);
            border-left-color: #4ec9b0;
        }

        .info-box h3 {
            margin-top: 0;
        }

        .info-box ul {
            margin-bottom: 0;
        }

        .step-card {
            display: flex;
            gap: 20px;
            background: #252526;
            padding: 24px;
            border-radius: 12px;
            border: 1px solid #3c3c3c;
            margin-bottom: 20px;
        }

        .step-number {
            width: 48px;
            height: 48px;
            background: #007acc;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-content h3 {
            margin-top: 0;
        }

        .step-content ol {
            margin-bottom: 0;
        }

        .feature-detail {
            margin: 32px 0;
        }

        .symbol-table {
            background: #252526;
            border-radius: 8px;
            overflow: hidden;
            margin: 16px 0;
        }

        .symbol-row {
            display: grid;
            grid-template-columns: 80px 1fr 150px;
            gap: 16px;
            padding: 16px;
            border-bottom: 1px solid #3c3c3c;
            align-items: center;
        }

        .symbol-row:last-child {
            border-bottom: none;
        }

        .symbol-cell {
            font-size: 28px;
            text-align: center;
        }

        .symbol-name {
            color: #cccccc;
        }

        .symbol-usage {
            text-align: right;
        }

        .shortcut-category {
            margin: 32px 0;
        }

        .shortcut-table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
        }

        .shortcut-table tr {
            border-bottom: 1px solid #3c3c3c;
        }

        .shortcut-table td {
            padding: 12px;
        }

        .shortcut-table td:first-child {
            font-weight: 600;
            width: 40%;
        }

        .ros-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin: 24px 0;
        }

        .ros-feature {
            display: flex;
            gap: 12px;
            align-items: start;
            background: #252526;
            padding: 16px;
            border-radius: 8px;
            border: 1px solid #3c3c3c;
        }

        .ros-icon {
            font-size: 24px;
        }

        .ros-feature strong {
            display: block;
            color: #4fc1ff;
            margin-bottom: 4px;
        }

        .ros-feature p {
            margin: 0;
            font-size: 13px;
            color: #b0b0b0;
        }

        .course-card {
            background: #252526;
            padding: 24px;
            border-radius: 12px;
            border: 1px solid #3c3c3c;
            margin-bottom: 20px;
        }

        .course-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .course-header h3 {
            margin: 0;
            flex: 1;
            min-width: 200px;
        }

        .course-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .course-badge.beginner {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }

        .course-badge.intermediate {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
        }

        .course-badge.free {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }

        .command-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 12px;
            margin: 16px 0;
        }

        .command-grid code {
            display: block;
            text-align: center;
            padding: 12px;
            background: #1e1e1e;
            border: 1px solid #3c3c3c;
            border-radius: 6px;
        }

        .api-category {
            margin: 32px 0;
        }

        .api-method {
            background: #252526;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #3c3c3c;
            margin: 16px 0;
        }

        .api-signature {
            margin-bottom: 12px;
        }

        .api-command {
            color: #dcdcaa;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: 600;
        }

        .api-params {
            color: #9cdcfe;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        .support-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin: 32px 0;
        }

        .support-card {
            background: #252526;
            padding: 24px;
            border-radius: 12px;
            border: 1px solid #3c3c3c;
        }

        .support-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .support-card h3 {
            margin: 0 0 12px 0;
        }

        .support-card p {
            margin-bottom: 16px;
            color: #b0b0b0;
            font-size: 14px;
        }

        .support-links {
            list-style: none;
            padding: 0;
        }

        .support-links li {
            margin-bottom: 8px;
        }

        .support-links a {
            color: #007acc;
            text-decoration: none;
            transition: color 0.2s;
        }

        .support-links a:hover {
            color: #4fc1ff;
        }

        .doc-files {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 12px;
            margin: 16px 0;
        }

        .doc-file {
            background: #1e1e1e;
            padding: 12px;
            border-radius: 6px;
            border-left: 3px solid #007acc;
            font-size: 13px;
        }

        .doc-file strong {
            color: #4fc1ff;
            display: block;
            margin-bottom: 4px;
        }

        .troubleshoot-item {
            background: #252526;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #3c3c3c;
            margin-bottom: 16px;
        }

        .troubleshoot-item h4 {
            margin-top: 0;
        }

        /* Terminal Modal Styles */
        .terminal-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .terminal-modal.active {
            display: flex;
        }

        .terminal-panel {
            background: #0a0f1e;
            width: 95%;
            max-width: 1400px;
            height: 85vh;
            border-radius: 12px;
            border: 2px solid rgba(0, 255, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 20px 80px rgba(0, 255, 0, 0.3);
        }

        .terminal-header {
            background: #0d1321;
            border-bottom: 1px solid rgba(0, 255, 0, 0.2);
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .terminal-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
            font-size: 16px;
            color: #00ff00;
        }

        .terminal-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .terminal-control-btn {
            padding: 6px 12px;
            background: rgba(0, 255, 0, 0.1);
            color: #00ff00;
            border: 1px solid rgba(0, 255, 0, 0.3);
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .terminal-control-btn:hover {
            background: rgba(0, 255, 0, 0.2);
            border-color: rgba(0, 255, 0, 0.5);
        }

        .terminal-content {
            flex: 1;
            overflow: hidden;
            padding: 10px;
        }

        /* Override xterm.js styles for our theme */
        .terminal-content .xterm {
            height: 100%;
        }

        .terminal-content .xterm-viewport {
            background-color: transparent !important;
        }

        .terminal-content .xterm-screen {
            background-color: transparent !important;
        }

        /* Top Right Widgets Container */
        .top-right-widgets {
            position: fixed;
            top: 60px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 100;
        }

        /* Compact Widget Base */
        .compact-widget {
            background: rgba(26, 47, 90, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 15px;
            width: 280px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .compact-widget:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(59, 130, 246, 0.4);
        }

        .compact-widget.collapsed .widget-content {
            display: none;
        }
        
        .compact-widget.collapsed {
            padding: 12px 15px;
        }
        
        .compact-widget.collapsed .widget-header {
            margin-bottom: 0;
            border-bottom: none;
        }

        .widget-collapse-btn {
            background: none;
            border: none;
            color: #3b82f6;
            font-size: 14px;
            cursor: pointer;
            padding: 4px 6px;
            transition: transform 0.3s ease, color 0.2s ease;
            display: inline-block;
            line-height: 1;
        }

        .widget-collapse-btn:hover {
            color: #60a5fa;
        }

        .widget-collapse-btn.collapsed {
            transform: rotate(-90deg);
        }
        
        .widget-content {
            transition: opacity 0.2s ease;
        }

        /* Widget Header */
        .widget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(59, 130, 246, 0.2);
        }

        .widget-title {
            font-size: 1rem;
            font-weight: 600;
            color: #00ff00;
            text-shadow: 0 0 10px rgba(0, 255, 0, 0.6), 0 0 20px rgba(0, 255, 0, 0.4);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .widget-location {
            font-size: 0.75rem;
            color: #00ff00;
            opacity: 0.7;
        }

        /* Weather Widget Styles */
        .weather-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .weather-icon-compact {
            font-size: 2.5rem;
            filter: drop-shadow(0 2px 4px rgba(0, 255, 0, 0.5));
        }

        .weather-info {
            flex: 1;
        }

        .weather-temp-compact {
            font-size: 1.8rem;
            font-weight: 700;
            color: #00ff00;
            text-shadow: 0 0 10px rgba(0, 255, 0, 0.6);
            margin-bottom: 4px;
        }

        .weather-main .weather-temp {
            font-size: 2rem;
            font-weight: 700;
            color: #00ff00;
            text-shadow: 0 0 10px rgba(0, 255, 0, 0.6), 0 0 20px rgba(0, 255, 0, 0.4);
            margin-bottom: 8px;
        }

        .weather-main .weather-condition {
            font-size: 1rem;
            color: #00ff00;
            opacity: 0.8;
            margin-bottom: 12px;
        }

        .weather-condition-compact {
            font-size: 0.9rem;
            color: #00ff00;
            opacity: 0.8;
            margin-bottom: 8px;
        }

        .weather-details-compact {
            display: flex;
            gap: 15px;
            font-size: 0.8rem;
            color: #00ff00;
            opacity: 0.7;
        }

        .weather-detail {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
            color: #00ff00;
            opacity: 0.8;
        }

        /* World Clock Widget Styles */
        .world-clock-content {
            text-align: center;
        }

        .clock-main {
            text-align: center;
        }

        .clock-time, .clock-main .clock-time {
            font-size: 2rem;
            font-weight: 700;
            color: #00ff00;
            text-shadow: 0 0 10px rgba(0, 255, 0, 0.6), 0 0 20px rgba(0, 255, 0, 0.4);
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
        }

        .clock-location {
            font-size: 0.9rem;
            color: #00ff00;
            opacity: 0.8;
            margin-bottom: 4px;
        }

        .clock-timezone {
            font-size: 0.8rem;
            color: #00ff00;
            opacity: 0.6;
        }

        /* Language Modal */
        .language-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .language-modal.active {
            display: flex;
        }

        .language-panel {
            background: #1a1a1a;
            width: 90%;
            max-width: 500px;
            border-radius: 16px;
            border: 2px solid rgba(59, 130, 246, 0.3);
            overflow: hidden;
            box-shadow: 0 20px 80px rgba(0, 0, 0, 0.5);
        }

        .language-panel-header {
            background: #252526;
            border-bottom: 1px solid #3c3c3c;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .language-panel-title {
            font-weight: 600;
            font-size: 16px;
            color: #cccccc;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .language-panel-close {
            background: #3c3c3c;
            color: #cccccc;
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .language-panel-close:hover {
            background: #505050;
        }

        .language-list {
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .language-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 8px;
        }

        .language-item:hover {
            background: rgba(59, 130, 246, 0.1);
        }

        .language-item.active {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.4);
        }

        .language-flag {
            font-size: 1.5rem;
            margin-right: 12px;
        }

        .language-name {
            flex: 1;
            font-size: 16px;
            color: #cccccc;
        }

        .language-check {
            color: #4ec9b0;
            font-size: 18px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .language-item.active .language-check {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Workspace Background -->
    <div class="workspace-background">
        <div class="workspace-scene"></div>
        <div class="desk-glow"></div>
        
        <!-- Center Monitor Display - SHOWCASE SCREEN -->
        <div class="center-monitor">
            <!-- Showcase Controls -->
            <div class="showcase-controls">
                <div class="showcase-controls-left">
                    <button class="showcase-btn" id="recordBtn" onclick="toggleRecording()">
                        <span id="recordIcon">⏺</span>
                        <span id="recordText">Record</span>
                    </button>
                    <button class="showcase-btn" id="cameraBtn" onclick="toggleCamera()">
                        📹 Camera
                    </button>
                    <button class="showcase-btn" onclick="toggleFullscreen()">
                        ⛶ Fullscreen
                    </button>
                </div>
                <div class="showcase-mode-selector">
                    <button class="mode-btn active" onclick="switchShowcaseMode('blueprint')">Blueprint</button>
                    <button class="mode-btn" onclick="switchShowcaseMode('livead')">🔴 Live Ad</button>
                    <button class="mode-btn" onclick="switchShowcaseMode('youtube')">▶️ YouTube</button>
                    <button class="mode-btn" onclick="switchShowcaseMode('twitch')">🎮 Twitch</button>
                    <button class="mode-btn" onclick="switchShowcaseMode('video')">Video</button>
                    <button class="mode-btn" onclick="switchShowcaseMode('image')">Image</button>
                    <button class="mode-btn" onclick="switchShowcaseMode('web')">Web</button>
                    <button class="mode-btn" onclick="switchShowcaseMode('slides')">Slides</button>
                </div>
            </div>

            <!-- Showcase Content Area -->
            <div class="showcase-content">
                <!-- Live Video Ad Mode -->
                <div class="content-display" id="liveadMode">
                    <div class="live-ad-player">
                        <div class="live-ad-background"></div>
                        <div class="live-ad-content">
                            <div class="live-indicator">
                                <span class="live-dot"></span>
                                <span class="live-text">LIVE</span>
                            </div>
                            <div class="ad-main-text animate-in">Where Your</div>
                            <div class="ad-highlight-text animate-in-delay">Navigation Calculus</div>
                            <div class="ad-tagline animate-in-delay-2">Career Happens</div>
                            <div class="ad-logo animate-fade">
                                <span class="ad-logo-icon">⋋</span>
                                <span class="ad-logo-text">The NAVΛ</span>
                            </div>
                            <div class="ad-subtitle">NAVIGATION INSTITUTE</div>
                        </div>
                        <div class="video-progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                    </div>
                </div>

                <!-- Blueprint Mode (Default) -->
                <div class="content-display active" id="blueprintMode">
            <div class="blueprint-display">
                <div class="monitor-grid"></div>
                <svg style="width: 100%; height: 100%; opacity: 0.6;" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:0.8" />
                            <stop offset="100%" style="stop-color:#22c55e;stop-opacity:0.8" />
                        </linearGradient>
                        <filter id="glow">
                            <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                            <feMerge>
                                <feMergeNode in="coloredBlur"/>
                                <feMergeNode in="SourceGraphic"/>
                            </feMerge>
                        </filter>
                    </defs>
                    
                    <!-- Navigation Paths -->
                    <path d="M 150 450 Q 250 350, 400 400 T 650 350" 
                          stroke="url(#grad1)" stroke-width="3" fill="none" filter="url(#glow)"/>
                    <path d="M 150 250 L 400 250 L 400 150" 
                          stroke="#3b82f6" stroke-width="2" fill="none" filter="url(#glow)" opacity="0.7"/>
                    
                    <!-- Nodes -->
                    <circle cx="150" cy="450" r="10" fill="#22c55e" filter="url(#glow)"/>
                    <circle cx="400" cy="400" r="10" fill="#3b82f6" filter="url(#glow)"/>
                    <circle cx="650" cy="350" r="10" fill="#22c55e" filter="url(#glow)"/>
                    <circle cx="400" cy="150" r="10" fill="#3b82f6" filter="url(#glow)"/>
                    
                    <!-- Lambda Symbol -->
                    <text x="400" y="350" font-size="200" fill="#3b82f6" opacity="0.15" 
                          text-anchor="middle" font-family="Arial" font-weight="bold">Λ</text>
                </svg>
                    </div>
                </div>

                <!-- YouTube Mode -->
                <div class="content-display" id="youtubeMode">
                    <div style="width: 100%; height: 100%; display: flex; flex-direction: column;">
                        <div style="padding: 10px; background: rgba(10, 20, 40, 0.8); border-bottom: 1px solid rgba(59, 130, 246, 0.3); display: flex; gap: 10px; align-items: center;">
                            <input type="text" id="youtubeInput" placeholder="Enter YouTube URL or Video ID..." 
                                   style="flex: 1; background: rgba(15, 30, 60, 0.8); border: 1px solid rgba(59, 130, 246, 0.4); color: white; padding: 8px 12px; border-radius: 6px; font-size: 14px;">
                            <button onclick="loadYouTubeVideo()" style="background: rgba(239, 68, 68, 0.3); border: 1px solid rgba(239, 68, 68, 0.5); color: #ef4444; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                ▶️ Load
                            </button>
                        </div>
                        <div id="youtubePlayer" style="flex: 1; width: 100%; position: relative;">
                            <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; flex-direction: column; gap: 15px; color: #94a3b8;">
                                <div style="font-size: 64px;">▶️</div>
                                <div style="font-size: 18px; font-weight: 600;">YouTube Player</div>
                                <div style="font-size: 14px; opacity: 0.7; text-align: center; max-width: 400px;">
                                    Enter a YouTube URL or video ID above to start streaming
                                </div>
                                <div style="font-size: 12px; opacity: 0.5; margin-top: 10px;">
                                    Example: https://youtube.com/watch?v=VIDEO_ID
                                </div>
                            </div>
            </div>
        </div>
    </div>

                <!-- Twitch Mode -->
                <div class="content-display" id="twitchMode">
                    <div style="width: 100%; height: 100%; display: flex; flex-direction: column;">
                        <div style="padding: 10px; background: rgba(10, 20, 40, 0.8); border-bottom: 1px solid rgba(139, 92, 246, 0.3); display: flex; gap: 10px; align-items: center;">
                            <input type="text" id="twitchInput" placeholder="Enter Twitch channel name..." 
                                   style="flex: 1; background: rgba(15, 30, 60, 0.8); border: 1px solid rgba(139, 92, 246, 0.4); color: white; padding: 8px 12px; border-radius: 6px; font-size: 14px;">
                            <button onclick="loadTwitchStream()" style="background: rgba(139, 92, 246, 0.3); border: 1px solid rgba(139, 92, 246, 0.5); color: #a78bfa; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                🎮 Load Stream
                            </button>
                        </div>
                        <div id="twitchPlayer" style="flex: 1; width: 100%; position: relative;">
                            <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; flex-direction: column; gap: 15px; color: #94a3b8;">
                                <div style="font-size: 64px;">🎮</div>
                                <div style="font-size: 18px; font-weight: 600;">Twitch Live Stream</div>
                                <div style="font-size: 14px; opacity: 0.7; text-align: center; max-width: 400px;">
                                    Enter a Twitch channel name to watch live streams
                                </div>
                                <div style="font-size: 12px; opacity: 0.5; margin-top: 10px;">
                                    Example: shroud, xqc, pokimane
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Video Mode -->
                <div class="content-display" id="videoMode">
                    <video id="showcaseVideo" controls style="width: 100%; height: 100%;">
                        <source src="" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>

                <!-- Image Mode -->
                <div class="content-display" id="imageMode">
                    <img id="showcaseImage" src="" alt="Showcase Image" style="max-width: 100%; max-height: 100%; object-fit: contain;">
                </div>

                <!-- Web Content Mode -->
                <div class="content-display" id="webMode">
                    <iframe id="showcaseWeb" src="" style="width: 100%; height: 100%; border: none;"></iframe>
                </div>

                <!-- Slides Mode -->
                <div class="content-display" id="slidesMode">
                    <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: #94a3b8; flex-direction: column; gap: 15px;">
                        <div style="font-size: 48px;">📊</div>
                        <div style="font-size: 18px;">Presentation Mode</div>
                        <div style="font-size: 14px; opacity: 0.7;">Load your slides here</div>
                    </div>
                </div>

                <!-- Picture-in-Picture Camera View -->
                <div class="pip-camera" id="pipCamera">
                    <video id="cameraStream" autoplay muted></video>
                    <div class="camera-placeholder" id="cameraPlaceholder">
                        <div class="camera-placeholder-icon">📹</div>
                        <div>Camera Off</div>
                        <div style="font-size: 11px; opacity: 0.7; margin-top: 5px;">Click Camera button to start</div>
                    </div>
                    <div class="pip-camera-controls">
                        <button class="pip-btn" onclick="toggleCamera()" title="Toggle Camera">📹</button>
                        <button class="pip-btn" onclick="closePiPCamera()" title="Close">✕</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Top Bar - macOS Style Menu -->
    <div class="top-bar">
        <!-- NAVΛ System Menu -->
        <div class="menu-item navlambda-menu-icon">
            ⋋
            <div class="menu-dropdown">
                <div class="menu-dropdown-item" onclick="openAppLauncher()">📱 Applications... <span class="menu-shortcut">⌘A</span></div>
                <div class="menu-dropdown-item" onclick="getSystemInfo()">About This NAVΛ</div>
                <div class="menu-divider"></div>
                <div class="menu-dropdown-item" onclick="openDockController()">⚙️ Dock Settings...</div>
                <div class="menu-dropdown-item" onclick="openSystemSettings()">System Settings...</div>
                <div class="menu-dropdown-item" onclick="openAppLauncher(); switchAppTab('store')">🏪 App Store</div>
                <div class="menu-divider"></div>
                <div class="menu-dropdown-item" onclick="systemSleep()">💤 Sleep</div>
                <div class="menu-dropdown-item" onclick="systemRestart()">🔄 Restart...</div>
                <div class="menu-dropdown-item" onclick="systemShutdown()">⚡ Shut Down...</div>
                <div class="menu-divider"></div>
                <div class="menu-dropdown-item" onclick="systemLock()">🔒 Lock Screen <span class="menu-shortcut">⌃⌘Q</span></div>
                <div class="menu-dropdown-item" onclick="systemLogout()">👋 Log Out...</div>
            </div>
        </div>

        <!-- Menu Bar -->
        <div class="menu-bar">
            <div class="menu-item">
                File
                <div class="menu-dropdown">
                    <div class="menu-dropdown-item" onclick="createNewFile()">New File <span class="menu-shortcut">⌘N</span></div>
                    <div class="menu-dropdown-item" onclick="createNewFolder()">New Folder <span class="menu-shortcut">⇧⌘N</span></div>
                    <div class="menu-divider"></div>
                    <div class="menu-dropdown-item disabled">Open... <span class="menu-shortcut">⌘O</span></div>
                    <div class="menu-dropdown-item disabled">Save <span class="menu-shortcut">⌘S</span></div>
                    <div class="menu-dropdown-item disabled">Save As... <span class="menu-shortcut">⇧⌘S</span></div>
                    <div class="menu-divider"></div>
                    <div class="menu-dropdown-item disabled">Close <span class="menu-shortcut">⌘W</span></div>
                </div>
            </div>

            <div class="menu-item">
                Edit
                <div class="menu-dropdown">
                    <div class="menu-dropdown-item disabled">Undo <span class="menu-shortcut">⌘Z</span></div>
                    <div class="menu-dropdown-item disabled">Redo <span class="menu-shortcut">⇧⌘Z</span></div>
                    <div class="menu-divider"></div>
                    <div class="menu-dropdown-item disabled">Cut <span class="menu-shortcut">⌘X</span></div>
                    <div class="menu-dropdown-item disabled">Copy <span class="menu-shortcut">⌘C</span></div>
                    <div class="menu-dropdown-item disabled">Paste <span class="menu-shortcut">⌘V</span></div>
                    <div class="menu-divider"></div>
                    <div class="menu-dropdown-item disabled">Select All <span class="menu-shortcut">⌘A</span></div>
                </div>
            </div>

            <div class="menu-item">
                View
                <div class="menu-dropdown">
                    <div class="menu-dropdown-item" onclick="toggleSidebar()">Toggle Sidebar <span class="menu-shortcut">⌘B</span></div>
                    <div class="menu-dropdown-item" onclick="toggleFullscreen()">Enter Fullscreen</div>
                    <div class="menu-divider"></div>
                    <div class="menu-dropdown-item" onclick="refreshDesktop()">Refresh <span class="menu-shortcut">⌘R</span></div>
                    <div class="menu-dropdown-item disabled">Zoom In <span class="menu-shortcut">⌘+</span></div>
                    <div class="menu-dropdown-item disabled">Zoom Out <span class="menu-shortcut">⌘-</span></div>
                </div>
            </div>

            <div class="menu-item">
                Window
                <div class="menu-dropdown">
                    <div class="menu-dropdown-item disabled">Minimize <span class="menu-shortcut">⌘M</span></div>
                    <div class="menu-dropdown-item disabled">Zoom</div>
                    <div class="menu-divider"></div>
                    <div class="menu-dropdown-item">Show Showcase Screen</div>
                    <div class="menu-dropdown-item" onclick="openTrash()">Show Trash</div>
                    <div class="menu-dropdown-item disabled">Bring All to Front</div>
                </div>
            </div>

            <div class="menu-item">
                Help
                <div class="menu-dropdown">
                    <div class="menu-dropdown-item disabled">NAVΛ Help</div>
                    <div class="menu-dropdown-item disabled">Keyboard Shortcuts</div>
                    <div class="menu-divider"></div>
                    <div class="menu-dropdown-item disabled">Report a Bug...</div>
                    <div class="menu-dropdown-item disabled">Send Feedback...</div>
                </div>
            </div>
        </div>

        <!-- Right Side -->
        <div class="top-bar-right">
        <a href="/download.html" class="top-bar-link">
            <span class="top-bar-icon">↻</span>
                <span>Download Interface</span>
        </a>
        </div>
    </div>

    <!-- Left Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-nav" id="sidebarNav">
            <a href="#public" class="nav-item">
                <div class="nav-icon">📁</div>
                <div class="nav-label">Public<br>Rosjects</div>
            </a>

            <a href="#my-projects" class="nav-item">
                <div class="nav-icon">📂</div>
                <div class="nav-label">My<br>Rosjects</div>
            </a>

            <div class="nav-section-title">FAVORITES</div>
            
            <!-- Drop zone for sidebar items -->
            <div class="sidebar-dropzone" id="sidebarDropzone">
                <div class="dropzone-hint">📌 Drop folders here</div>
            </div>
            
            <div id="sidebarFavorites">
                <!-- Dynamically added favorite folders will appear here -->
            </div>

            <div class="nav-section-title">ACHIEVEMENTS</div>

            <a href="#portfolio" class="nav-item">
                <div class="nav-icon">📜</div>
                <div class="nav-label">My<br>Portfolio</div>
            </a>
        </div>

        <!-- Feedback section removed for cleaner interface -->
    </aside>

    <!-- Sidebar Toggle Button -->
    <div class="sidebar-toggle" onclick="toggleSidebar()" title="Toggle Sidebar"></div>

    <!-- Desktop OS Area -->
    <div class="desktop-area" id="desktopArea">
        <!-- Desktop icons will be dynamically added here -->
    </div>

    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu">
        <div class="context-menu-item" onclick="createNewFolder()">
            <span>📁</span>
            <span>New Folder</span>
        </div>
        <div class="context-menu-item" onclick="createNewFile()">
            <span>📄</span>
            <span>New File</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" onclick="openSystemSettings()">
            <span>⚙️</span>
            <span>System Settings</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" onclick="refreshDesktop()">
            <span>🔄</span>
            <span>Refresh</span>
        </div>
    </div>

    <!-- New Folder/File Dialog -->
    <div class="dialog-overlay" id="newItemDialog">
        <div class="dialog-box">
            <div class="dialog-title" id="dialogTitle">New Folder</div>
            <input type="text" class="dialog-input" id="itemNameInput" placeholder="Enter name..." />
            <div class="dialog-buttons">
                <button class="dialog-btn dialog-btn-secondary" onclick="closeDialog()">Cancel</button>
                <button class="dialog-btn dialog-btn-primary" onclick="confirmNewItem()">Create</button>
            </div>
        </div>
    </div>

    <!-- Dock Controller Modal -->
    <div class="dock-controller-modal" id="dockControllerModal">
        <div class="dock-controller-window">
            <div class="dock-controller-header">
                <div class="dock-controller-title">
                    <span>⚙️</span>
                    <span>Dock Settings</span>
                </div>
                <div class="dock-controller-close" onclick="closeDockController()">✕</div>
            </div>
            
            <div class="dock-controller-content">
                <div class="dock-setting-section">
                    <div class="dock-setting-label">Dock Size</div>
                    <div class="dock-size-options">
                        <div class="dock-size-btn" data-size="small" onclick="setDockSize('small')">
                            <div class="size-preview small"></div>
                            <span>Small</span>
                        </div>
                        <div class="dock-size-btn active" data-size="medium" onclick="setDockSize('medium')">
                            <div class="size-preview medium"></div>
                            <span>Medium</span>
                        </div>
                        <div class="dock-size-btn" data-size="large" onclick="setDockSize('large')">
                            <div class="size-preview large"></div>
                            <span>Large</span>
                        </div>
                    </div>
                </div>
                
                <div class="dock-setting-section">
                    <div class="dock-setting-label">Magnification</div>
                    <div class="dock-toggle-row">
                        <span>Enable Magnification</span>
                        <label class="dock-switch">
                            <input type="checkbox" id="magToggle" checked onchange="toggleMagnification()">
                            <span class="dock-slider"></span>
                        </label>
                    </div>
                    <div class="magnification-slider">
                        <span>Scale</span>
                        <input type="range" id="magScale" min="1.3" max="2.0" step="0.1" value="1.6" oninput="updateMagScale(this.value)">
                        <span id="magScaleValue">1.6x</span>
                    </div>
                </div>
                
                <div class="dock-setting-section">
                    <div class="dock-setting-label">Animation Speed</div>
                    <div class="speed-options">
                        <button class="speed-btn" onclick="setAnimSpeed(0.2)">Fast</button>
                        <button class="speed-btn active" onclick="setAnimSpeed(0.4)">Normal</button>
                        <button class="speed-btn" onclick="setAnimSpeed(0.6)">Slow</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Trash Viewer Modal -->
    <div class="trash-viewer-modal" id="trashViewerModal">
        <div class="trash-viewer-window">
            <div class="trash-viewer-header">
                <div class="trash-viewer-title">
                    <span>🗑️</span>
                    <span>Trash Bin</span>
                    <span class="trash-item-count" id="trashItemCount">0 items</span>
                </div>
                <div class="trash-viewer-close" onclick="closeTrashViewer()">✕</div>
            </div>
            
            <div class="trash-viewer-toolbar">
                <button class="trash-btn trash-restore-all" onclick="restoreAll()" title="Restore All">
                    <span>↩️</span>
                    <span>Restore All</span>
                </button>
                <button class="trash-btn trash-empty" onclick="emptyTrash()" title="Empty Trash">
                    <span>🔥</span>
                    <span>Empty Trash</span>
                </button>
            </div>
            
            <div class="trash-viewer-content" id="trashViewerContent">
                <div class="trash-empty-state" id="trashEmptyState">
                    <div class="empty-icon">🗑️</div>
                    <div class="empty-text">Trash is empty</div>
                </div>
                <div class="trash-items-grid" id="trashItemsGrid">
                    <!-- Trash items will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Applications Launcher Modal -->
    <div class="app-launcher-modal" id="appLauncherModal">
        <div class="app-launcher-window">
            <div class="app-launcher-header">
                <div class="app-launcher-title">
                    <span style="color: #00ff00; font-size: 24px; margin-right: 10px;">⋋</span>
                    <span>NAVΛ Applications</span>
                </div>
                <div class="app-launcher-close" onclick="closeAppLauncher()">✕</div>
            </div>
            
            <div class="app-launcher-tabs">
                <div class="app-tab active" onclick="switchAppTab('all')">📱 All Apps</div>
                <div class="app-tab" onclick="switchAppTab('recent')">🕐 Recent</div>
                <div class="app-tab" onclick="switchAppTab('ai')">🤖 AI Apps</div>
                <div class="app-tab" onclick="switchAppTab('browsers')">🌐 Browsers</div>
                <div class="app-tab" onclick="switchAppTab('store')">🏪 App Store</div>
            </div>
            
            <div class="app-launcher-content">
                <!-- All Apps View -->
                <div class="app-view active" id="allAppsView">
                    <div class="app-grid" id="allAppsGrid"></div>
                </div>
                
                <!-- Recent Apps View -->
                <div class="app-view" id="recentAppsView">
                    <div class="recent-header">Recently Used Applications</div>
                    <div class="app-grid" id="recentAppsGrid"></div>
                </div>
                
                <!-- AI Apps View -->
                <div class="app-view" id="aiAppsView">
                    <div class="app-category-title">🤖 AI-Powered Applications</div>
                    <div class="app-grid" id="aiAppsGrid"></div>
                </div>
                
                <!-- Browsers View -->
                <div class="app-view" id="browsersView">
                    <div class="app-category-title">🌐 Virtual Browsers (No Installation Required)</div>
                    <div class="app-grid" id="browsersGrid"></div>
                </div>
                
                <!-- App Store View -->
                <div class="app-view" id="appStoreView">
                    <div class="app-category-title">🏪 NAVΛ App Store</div>
                    <div class="store-categories">
                        <div class="store-category">
                            <div class="store-category-header">🤖 AI & Machine Learning</div>
                            <div class="app-grid" id="storeAIApps"></div>
                        </div>
                        <div class="store-category">
                            <div class="store-category-header">🌐 Browsers & Web Tools</div>
                            <div class="app-grid" id="storeBrowserApps"></div>
                        </div>
                        <div class="store-category">
                            <div class="store-category-header">🛠️ Development Tools</div>
                            <div class="app-grid" id="storeDevApps"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- System Settings Modal -->
    <div class="settings-modal" id="settingsModal">
        <div class="settings-window">
            <div class="settings-header">
                <div class="settings-title">
                    <span>⚙️</span>
                    <span>System Settings</span>
                </div>
                <div class="settings-close" onclick="closeSystemSettings()">✕</div>
            </div>
            <div class="settings-content">
                <div class="settings-section">
                    <div class="settings-section-title">🎨 Appearance</div>
                    <div class="settings-item">
                        <div class="settings-item-label">Dark Mode</div>
                        <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-label">Animations</div>
                        <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                    </div>
                </div>
                
                <div class="settings-section">
                    <div class="settings-section-title">🖥️ Desktop</div>
                    <div class="settings-item">
                        <div class="settings-item-label">Show Desktop Icons</div>
                        <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-label">Magnifying Dock</div>
                        <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                    </div>
                </div>
                
                <div class="settings-section">
                    <div class="settings-section-title">🔔 Notifications</div>
                    <div class="settings-item">
                        <div class="settings-item-label">System Notifications</div>
                        <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-label">Sound Effects</div>
                        <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                    </div>
                </div>
                
                <div class="settings-section">
                    <div class="settings-section-title">🤖 AI Features</div>
                    <div class="settings-item">
                        <div class="settings-item-label">AI Assistant</div>
                        <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-label">Auto-suggestions</div>
                        <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Institute Logo (Draggable) -->
    <div class="branding branding-logo" id="instituteLogo">
        <button class="branding-reset-btn" onclick="resetElementPosition('instituteLogo')" title="Reset Position">↺ Reset</button>
        <div class="institute-logo">
            <div class="logo-icon">⋋</div>
            <div class="logo-text-container">
                <div class="logo-main-text">The NAVΛ</div>
                <div class="logo-subtitle">NAVIGATION INSTITUTE</div>
            </div>
        </div>
    </div>

    <!-- Career Tagline (Draggable) -->
    <div class="branding branding-tagline" id="careerTagline">
        <button class="branding-reset-btn" onclick="resetElementPosition('careerTagline')" title="Reset Position">↺ Reset</button>
        <div class="tagline">
            Where Your<br>
            <strong>Navigation Calculus</strong><br>
            Career Happens
        </div>
    </div>

    <!-- Bottom Icon Bar -->
    <div class="bottom-icon-bar" id="bottomDock">
        <div class="bottom-icon active" title="Workspace Home (Current)">🏠</div>
        <div class="bottom-icon" onclick="window.location.href='/app.html?activity=ros-learning'" title="🤖 ROS Learning Center - Free Courses">🦾</div>
        <div class="bottom-icon vnc-icon" onclick="window.location.href='/app.html'" title="Full IDE Application" style="color: #00ff00; text-shadow: 0 0 10px rgba(0, 255, 0, 0.8);">⋋</div>
        <div class="bottom-icon" onclick="window.location.href='/download.html'" title="Downloads & SDK">📥</div>
        <div class="bottom-icon" onclick="window.location.href='/docs.html'" title="Documentation">📚</div>
        <div class="bottom-icon" onclick="toggleTerminalModal()" title="Terminal">💻</div>
        <div class="bottom-icon" onclick="toggleAIModal()" title="AI Assistant">🤖</div>
        
        <!-- Divider -->
        <div class="dock-divider"></div>
        
        <!-- Applications Folder -->
        <div class="bottom-icon" onclick="openAppLauncher()" title="Applications">
            📁
            <div class="dock-badge">🌟</div>
        </div>
        
        <!-- Browser Selector -->
        <div class="bottom-icon" id="activeBrowser" onclick="toggleBrowserSelector(event)" title="Browser">
            <span id="browserIcon">🌐</span>
            <div class="browser-selector" id="browserSelector">
                <div class="browser-option" data-browser="chrome" onclick="selectBrowser('chrome', event)">
                    <span class="browser-opt-icon">🌐</span>
                    <span>Chrome</span>
                </div>
                <div class="browser-option" data-browser="firefox" onclick="selectBrowser('firefox', event)">
                    <span class="browser-opt-icon">🦊</span>
                    <span>Firefox</span>
                </div>
                <div class="browser-option" data-browser="brave" onclick="selectBrowser('brave', event)">
                    <span class="browser-opt-icon">🦁</span>
                    <span>Brave</span>
                </div>
                <div class="browser-option" data-browser="edge" onclick="selectBrowser('edge', event)">
                    <span class="browser-opt-icon">🔷</span>
                    <span>Edge</span>
                </div>
                <div class="browser-option" data-browser="opera" onclick="selectBrowser('opera', event)">
                    <span class="browser-opt-icon">🎭</span>
                    <span>Opera</span>
                </div>
                <div class="browser-option" data-browser="arc" onclick="selectBrowser('arc', event)">
                    <span class="browser-opt-icon">🌈</span>
                    <span>Arc</span>
                </div>
            </div>
        </div>
        
        <!-- Divider -->
        <div class="dock-divider"></div>
        
        <!-- Trash Bin in Dock -->
        <div class="bottom-icon" id="dockTrash" ondragover="handleTrashDragOver(event)" ondragleave="handleTrashDragLeave(event)" ondrop="handleTrashDrop(event)" onclick="openTrashViewer()" title="Trash">
            🗑️
            <div class="trash-count-badge" id="trashCountBadge" style="display: none;">0</div>
        </div>

        <div class="bottom-right-info">
            <div class="info-icon" onclick="showHelpModal()" title="Help" style="cursor: pointer;">❓</div>
            <div class="info-icon" onclick="showSettingsModal()" title="Settings" style="cursor: pointer;">⚙️</div>
            <div>
                <div class="time-display" id="time" onclick="toggleClockMode()" style="cursor: pointer;" title="Click to switch between digital and analog">02:19</div>
                <canvas id="analogClock" width="80" height="80" style="display: none; cursor: pointer;" onclick="toggleClockMode()" title="Click to switch to digital"></canvas>
                <div class="date-display" id="date">10/13/2025</div>
            </div>
            <div class="info-icon language-btn" id="languageBtn" onclick="showLanguageModal()" title="Language" style="cursor: pointer; color: white;">🇬🇧 EN</div>
            <div class="info-icon power-btn" id="powerBtn" onclick="confirmLogout()" title="Power: Standby (Click to sign out)" style="cursor: pointer; color: white;">⏻</div>
        </div>
    </div>

    <!-- AI Modal -->
    <div class="ai-modal" id="aiModal" onclick="closeModalOnBackdrop(event)">
        <div class="ai-panel">
            <div class="ai-header">
                <div class="ai-title">
                    <span>🤖</span>
                    <span>NAVΛ AI Assistant</span>
                </div>
                <div class="ai-controls">
                    <select id="modelSelector" class="model-selector" onchange="updateModelInfo()">
                        <option value="anthropic/claude-3.5-sonnet">Claude 3.5 Sonnet</option>
                        <option value="anthropic/claude-3-opus">Claude 3 Opus</option>
                        <option value="anthropic/claude-3-sonnet">Claude 3 Sonnet</option>
                        <option value="openai/gpt-4-turbo">GPT-4 Turbo</option>
                        <option value="openai/gpt-4">GPT-4</option>
                        <option value="openai/gpt-3.5-turbo">GPT-3.5 Turbo</option>
                        <option value="google/gemini-pro">Gemini Pro</option>
                        <option value="meta-llama/llama-3-70b-instruct">Llama 3 70B</option>
                        <option value="mistralai/mistral-large">Mistral Large</option>
                    </select>
                    <button class="settings-btn" onclick="toggleSettings()">⚙️</button>
                    <button class="close-btn" onclick="toggleAIModal()">✕</button>
                </div>
                <div class="ai-status">
                    <span class="status-dot" id="statusDot"></span>
                    <span id="statusText">Ready</span>
                </div>
            </div>

            <div class="ai-settings-panel" id="settingsPanel">
                <div class="settings-label">
                    API Key
                    <a href="https://openrouter.ai/keys" target="_blank" rel="noopener noreferrer" class="get-key-link">
                        Get your key →
                    </a>
                </div>
                <input type="password" id="apiKeyInput" class="api-key-input" placeholder="sk-or-v1-..." onchange="saveApiKey()">
                <div class="model-info" id="modelInfo"></div>
                <div class="warning-message" id="warningMessage" style="display: none;">
                    ⚠️ Without an API key, you'll get simulated responses. Add your OpenRouter API key to use real AI models.
                </div>
            </div>

            <div class="ai-messages" id="aiMessages">
                <div class="message assistant">
                    <div class="message-avatar">🤖</div>
                    <div class="message-content">
                        <div class="message-header">
                            <span class="message-role">AI Assistant</span>
                            <span class="message-time" id="initialTime"></span>
                        </div>
                        <div class="message-text">👋 Hello! I'm your NAVΛ AI Assistant. I can help you with:

• Understanding Van Laarhoven Navigation Calculus
• Writing and optimizing ⋋ expressions
• Debugging navigation algorithms
• Explaining mathematical concepts
• Code suggestions and completions

How can I assist you today?</div>
                    </div>
                </div>
            </div>

            <div class="ai-input-area">
                <div class="symbol-toolbar">
                    <button class="symbol-btn" onclick="insertSymbol('⋋')" title="Van Laarhoven Lambda">⋋</button>
                    <button class="symbol-btn" onclick="insertSymbol('→')" title="Arrow">→</button>
                    <button class="symbol-btn" onclick="insertSymbol('∇')" title="Nabla">∇</button>
                    <button class="symbol-btn" onclick="insertSymbol('∫')" title="Integral">∫</button>
                    <button class="symbol-btn" onclick="insertSymbol('φ')" title="Phi">φ</button>
                </div>
                <div class="input-container">
                    <textarea id="aiInput" class="ai-input" rows="3" placeholder="Ask me anything about NAVΛ or VNC..." onkeydown="handleKeyDown(event)"></textarea>
                    <button class="send-btn" id="sendBtn" onclick="sendMessage()">📤</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Documentation Modal -->
    <div class="docs-modal" id="docsModal" onclick="closeDocsModalOnBackdrop(event)">
        <div class="docs-panel">
            <div class="docs-header">
                <div class="docs-title">
                    <span>📚</span>
                    <span>NAVΛ Studio Documentation</span>
                </div>
                <button class="close-btn" onclick="toggleDocsModal()">✕</button>
            </div>

            <div class="docs-nav">
                <button class="docs-tab active" onclick="switchDocsTab('overview')">🏠 Overview</button>
                <button class="docs-tab" onclick="switchDocsTab('quickstart')">🚀 Quick Start</button>
                <button class="docs-tab" onclick="switchDocsTab('features')">⚡ Features</button>
                <button class="docs-tab" onclick="switchDocsTab('keyboard')">⌨️ Shortcuts</button>
                <button class="docs-tab" onclick="switchDocsTab('ros')">🤖 ROS Learning</button>
                <button class="docs-tab" onclick="switchDocsTab('api')">🔧 API Reference</button>
                <button class="docs-tab" onclick="switchDocsTab('support')">🆘 Support</button>
            </div>

            <div class="docs-content" id="docsContent">
                <!-- Overview Tab -->
                <div class="docs-section active" id="overview-section">
                    <h1>Welcome to NAVΛ Studio IDE</h1>
                    <p class="lead">The World's First IDE for Van Laarhoven Navigation Calculus Programming</p>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <div class="feature-icon">⋋</div>
                            <h3>Native VNC Support</h3>
                            <p>First-class support for Van Laarhoven Navigation Calculus symbols and operators</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🎨</div>
                            <h3>3D Visualization</h3>
                            <p>Real-time GPU-accelerated navigation path and energy landscape rendering</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">⚡</div>
                            <h3>Multi-Target Compilation</h3>
                            <p>Compile to C++, Python, WebAssembly, GLSL, and more</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🤖</div>
                            <h3>Free ROS Learning</h3>
                            <p>Comprehensive Robot Operating System courses with live terminal</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">☁️</div>
                            <h3>Cloud Integration</h3>
                            <p>One-click deployment to Docker, Kubernetes, and cloud platforms</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🔥</div>
                            <h3>Live Preview</h3>
                            <p>WebAssembly-powered real-time code execution and visualization</p>
                        </div>
                    </div>

                    <div class="info-box">
                        <h3>🌟 Revolutionary Features</h3>
                        <ul>
                            <li><strong>⚡ Rust Performance</strong> - Native speed with memory safety, faster than Electron-based IDEs</li>
                            <li><strong>🎯 Navigation Debugging</strong> - Advanced path tracing and energy optimization debugging</li>
                            <li><strong>🧩 Plugin Architecture</strong> - Extensible system for domain-specific tools</li>
                            <li><strong>💻 Integrated Terminal</strong> - Execute ROS2 commands with 17+ supported commands</li>
                        </ul>
                    </div>
                </div>

                <!-- Quick Start Tab -->
                <div class="docs-section" id="quickstart-section">
                    <h1>🚀 Quick Start Guide</h1>
                    
                    <div class="step-card">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h3>Start the Development Server</h3>
                            <pre class="code-block">npm run dev</pre>
                            <p>The Vite development server will start at <code>http://localhost:5173/</code></p>
                        </div>
                    </div>

                    <div class="step-card">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h3>Open in Browser</h3>
                            <p>Navigate to <code>http://localhost:5173/</code> to access the IDE</p>
                        </div>
                    </div>

                    <div class="step-card">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h3>Create Your First Project</h3>
                            <ol>
                                <li>Click the <strong>"Project Manager"</strong> button</li>
                                <li>Enter a project name (e.g., <code>my-navλ-project</code>)</li>
                                <li>Click <strong>"Create Project"</strong></li>
                                <li>Start coding with NAVΛ!</li>
                            </ol>
                        </div>
                    </div>

                    <div class="info-box">
                        <h3>📦 Desktop Installation</h3>
                        <p>Want to run NAVΛ Studio as a native desktop application?</p>
                        <pre class="code-block"># Development mode (with hot reload)
npm run tauri:dev

# Production build
npm run tauri:build</pre>
                    </div>

                    <div class="info-box success">
                        <h3>✅ Your First NAVΛ Program</h3>
                        <pre class="code-block">// Define a navigation operator
nav pathfinder(start: State, goal: State) -> Navigation {
  let distance = ∇⋋(start, goal)
  let path = 𝒩ℐ(distance)
  
  compose(
    tensor(start ⊗⋋ path),
    evolution(ℰ(path)),
    feedback(goal)
  )
}

// Use the operator
nav main() {
  let start = State::new(0, 0)
  let goal = State::new(10, 10)
  
  let result = pathfinder(start, goal)
  result.execute()
}</pre>
                    </div>
                </div>

                <!-- Features Tab -->
                <div class="docs-section" id="features-section">
                    <h1>⚡ Key Features</h1>
                    
                    <div class="feature-detail">
                        <h2>⋋ Native VNC Symbol Support</h2>
                        <p>NAVΛ Studio has first-class support for all Van Laarhoven Navigation Calculus symbols:</p>
                        <div class="symbol-table">
                            <div class="symbol-row">
                                <span class="symbol-cell">⋋</span>
                                <span class="symbol-name">Lambda Navigation</span>
                                <span class="symbol-usage"><code>Alt+L</code></span>
                            </div>
                            <div class="symbol-row">
                                <span class="symbol-cell">⊗⋋</span>
                                <span class="symbol-name">Navigation Tensor Product</span>
                                <span class="symbol-usage"><code>Alt+Shift+T</code></span>
                            </div>
                            <div class="symbol-row">
                                <span class="symbol-cell">⊕⋋</span>
                                <span class="symbol-name">Navigation Sum</span>
                                <span class="symbol-usage"><code>Alt+Shift+S</code></span>
                            </div>
                            <div class="symbol-row">
                                <span class="symbol-cell">𝒩ℐ</span>
                                <span class="symbol-name">Master Navigation Operator</span>
                                <span class="symbol-usage"><code>Alt+Shift+M</code></span>
                            </div>
                            <div class="symbol-row">
                                <span class="symbol-cell">ℰ</span>
                                <span class="symbol-name">Evolution Operator</span>
                                <span class="symbol-usage"><code>Alt+Shift+E</code></span>
                            </div>
                        </div>
                    </div>

                    <div class="feature-detail">
                        <h2>🎨 3D Navigation Visualization</h2>
                        <ul>
                            <li>Real-time GPU-accelerated rendering</li>
                            <li>Navigation path optimization visualization</li>
                            <li>Energy landscape surfaces</li>
                            <li>Multi-dimensional navigation spaces</li>
                            <li>Interactive path exploration</li>
                        </ul>
                    </div>

                    <div class="feature-detail">
                        <h2>⚡ Multi-Target Compilation</h2>
                        <p>Write once, compile to multiple targets:</p>
                        <ul>
                            <li><strong>C++17</strong> - High-performance native applications</li>
                            <li><strong>Python 3.12</strong> - Data science and prototyping</li>
                            <li><strong>WebAssembly</strong> - Browser and web applications</li>
                            <li><strong>GLSL 4.5</strong> - GPU shaders and compute</li>
                            <li><strong>WGSL</strong> - WebGPU shaders</li>
                            <li><strong>Dockerfile</strong> - Container packaging</li>
                        </ul>
                    </div>

                    <div class="feature-detail">
                        <h2>☁️ Cloud Deployment</h2>
                        <p>One-click deployment to:</p>
                        <ul>
                            <li>Docker containers</li>
                            <li>Kubernetes clusters (with Helm charts)</li>
                            <li>AWS, Google Cloud, Azure</li>
                            <li>Edge computing platforms</li>
                        </ul>
                    </div>
                </div>

                <!-- Keyboard Shortcuts Tab -->
                <div class="docs-section" id="keyboard-section">
                    <h1>⌨️ Keyboard Shortcuts</h1>
                    
                    <div class="shortcut-category">
                        <h2>General Shortcuts</h2>
                        <table class="shortcut-table">
                            <tr>
                                <td><kbd>Ctrl/Cmd</kbd> + <kbd>S</kbd></td>
                                <td>Save file</td>
                            </tr>
                            <tr>
                                <td><kbd>Ctrl/Cmd</kbd> + <kbd>N</kbd></td>
                                <td>New file</td>
                            </tr>
                            <tr>
                                <td><kbd>Ctrl/Cmd</kbd> + <kbd>O</kbd></td>
                                <td>Open file</td>
                            </tr>
                            <tr>
                                <td><kbd>Ctrl/Cmd</kbd> + <kbd>Shift</kbd> + <kbd>P</kbd></td>
                                <td>Project Manager</td>
                            </tr>
                            <tr>
                                <td><kbd>F5</kbd></td>
                                <td>Run program</td>
                            </tr>
                            <tr>
                                <td><kbd>Ctrl/Cmd</kbd> + <kbd>B</kbd></td>
                                <td>Compile</td>
                            </tr>
                        </table>
                    </div>

                    <div class="shortcut-category">
                        <h2>VNC Symbol Shortcuts</h2>
                        <table class="shortcut-table">
                            <tr>
                                <td><kbd>Alt</kbd> + <kbd>L</kbd></td>
                                <td>Insert ⋋ (Lambda Navigation)</td>
                            </tr>
                            <tr>
                                <td><kbd>Alt</kbd> + <kbd>Shift</kbd> + <kbd>T</kbd></td>
                                <td>Insert ⊗⋋ (Tensor Product)</td>
                            </tr>
                            <tr>
                                <td><kbd>Alt</kbd> + <kbd>Shift</kbd> + <kbd>S</kbd></td>
                                <td>Insert ⊕⋋ (Navigation Sum)</td>
                            </tr>
                            <tr>
                                <td><kbd>Alt</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd></td>
                                <td>Insert 𝒩ℐ (Master Operator)</td>
                            </tr>
                            <tr>
                                <td><kbd>Alt</kbd> + <kbd>Shift</kbd> + <kbd>E</kbd></td>
                                <td>Insert ℰ (Evolution Operator)</td>
                            </tr>
                        </table>
                    </div>

                    <div class="shortcut-category">
                        <h2>Editor Shortcuts</h2>
                        <table class="shortcut-table">
                            <tr>
                                <td><kbd>Ctrl/Cmd</kbd> + <kbd>Space</kbd></td>
                                <td>Code completion</td>
                            </tr>
                            <tr>
                                <td><kbd>Ctrl/Cmd</kbd> + <kbd>/</kbd></td>
                                <td>Toggle comment</td>
                            </tr>
                            <tr>
                                <td><kbd>Ctrl/Cmd</kbd> + <kbd>F</kbd></td>
                                <td>Find</td>
                            </tr>
                            <tr>
                                <td><kbd>Ctrl/Cmd</kbd> + <kbd>H</kbd></td>
                                <td>Replace</td>
                            </tr>
                            <tr>
                                <td><kbd>Ctrl/Cmd</kbd> + <kbd>D</kbd></td>
                                <td>Duplicate line</td>
                            </tr>
                            <tr>
                                <td><kbd>Ctrl/Cmd</kbd> + <kbd>Shift</kbd> + <kbd>K</kbd></td>
                                <td>Delete line</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- ROS Learning Tab -->
                <div class="docs-section" id="ros-section">
                    <h1>🤖 ROS Learning Center</h1>
                    
                    <div class="info-box success">
                        <h3>✨ NEW: Free ROS Courses + Live Terminal!</h3>
                        <p>NAVΛ Studio now includes comprehensive, free Robot Operating System education with a fully functional terminal!</p>
                    </div>

                    <div class="ros-features">
                        <div class="ros-feature">
                            <span class="ros-icon">📚</span>
                            <div>
                                <strong>3 Free Courses</strong>
                                <p>ROS2 Basics, Advanced Navigation, Gazebo Simulation</p>
                            </div>
                        </div>
                        <div class="ros-feature">
                            <span class="ros-icon">💻</span>
                            <div>
                                <strong>Live Terminal</strong>
                                <p>Execute real ROS2 commands in-browser</p>
                            </div>
                        </div>
                        <div class="ros-feature">
                            <span class="ros-icon">⚡</span>
                            <div>
                                <strong>17+ Commands</strong>
                                <p>ros2 run, launch, topic, node, pkg, and more</p>
                            </div>
                        </div>
                        <div class="ros-feature">
                            <span class="ros-icon">🎓</span>
                            <div>
                                <strong>Certification</strong>
                                <p>Earn certificates on course completion</p>
                            </div>
                        </div>
                        <div class="ros-feature">
                            <span class="ros-icon">🔒</span>
                            <div>
                                <strong>Safe Learning</strong>
                                <p>Simulated environment, no installation needed</p>
                            </div>
                        </div>
                        <div class="ros-feature">
                            <span class="ros-icon">♾️</span>
                            <div>
                                <strong>100% Free Forever</strong>
                                <p>No paywalls, no subscriptions</p>
                            </div>
                        </div>
                    </div>

                    <div class="feature-detail">
                        <h2>Available Courses</h2>
                        
                        <div class="course-card">
                            <div class="course-header">
                                <h3>ROS2 Navigation Basics</h3>
                                <span class="course-badge beginner">Beginner</span>
                                <span class="course-badge free">FREE</span>
                            </div>
                            <p><strong>Duration:</strong> 6 weeks | <strong>Modules:</strong> 2 | <strong>Certificate:</strong> ✅</p>
                            <p><strong>What you'll learn:</strong></p>
                            <ul>
                                <li>ROS2 architecture and fundamentals</li>
                                <li>Creating and managing ROS2 packages</li>
                                <li>Topics, services, and actions</li>
                                <li>Basic navigation stack usage</li>
                            </ul>
                        </div>

                        <div class="course-card">
                            <div class="course-header">
                                <h3>Advanced ROS2 Navigation</h3>
                                <span class="course-badge intermediate">Intermediate</span>
                                <span class="course-badge free">FREE</span>
                            </div>
                            <p><strong>Duration:</strong> 8 weeks | <strong>Modules:</strong> 3 | <strong>Certificate:</strong> ✅</p>
                            <p><strong>What you'll learn:</strong></p>
                            <ul>
                                <li>Complex navigation scenarios</li>
                                <li>Custom controller development</li>
                                <li>Integration with VNC algorithms</li>
                                <li>Performance optimization</li>
                            </ul>
                        </div>

                        <div class="course-card">
                            <div class="course-header">
                                <h3>Gazebo Robot Simulation</h3>
                                <span class="course-badge intermediate">Intermediate</span>
                                <span class="course-badge free">FREE</span>
                            </div>
                            <p><strong>Duration:</strong> 4 weeks | <strong>Modules:</strong> 2 | <strong>Certificate:</strong> ✅</p>
                            <p><strong>What you'll learn:</strong></p>
                            <ul>
                                <li>Setting up Gazebo simulations</li>
                                <li>Creating robot models (URDF/SDF)</li>
                                <li>Sensor simulation and integration</li>
                                <li>Testing navigation algorithms</li>
                            </ul>
                        </div>
                    </div>

                    <div class="info-box">
                        <h3>💻 Supported ROS2 Commands</h3>
                        <div class="command-grid">
                            <code>ros2 run</code>
                            <code>ros2 launch</code>
                            <code>ros2 topic</code>
                            <code>ros2 node</code>
                            <code>ros2 pkg</code>
                            <code>ros2 service</code>
                            <code>ros2 param</code>
                            <code>ros2 action</code>
                            <code>ros2 bag</code>
                            <code>ros2 interface</code>
                            <code>ros2 doctor</code>
                            <code>ros2 wtf</code>
                        </div>
                    </div>
                </div>

                <!-- API Reference Tab -->
                <div class="docs-section" id="api-section">
                    <h1>🔧 API Reference</h1>
                    
                    <div class="api-category">
                        <h2>Dataset Integration APIs</h2>
                        <div class="api-method">
                            <div class="api-signature">
                                <span class="api-command">initialize_dataset_integration</span>
                            </div>
                            <p>Initializes the dataset integration system and loads metadata for Waymo, KITTI, and RT-X datasets.</p>
                            <pre class="code-block">import { invoke } from '@tauri-apps/api/tauri';

async function initializeDatasets() {
  const result = await invoke('initialize_dataset_integration');
  console.log(result); // "Dataset Integration System Initialized"
}</pre>
                            <p><strong>Response:</strong> <code>string</code> - Success or error message</p>
                        </div>
                    </div>

                    <div class="api-category">
                        <h2>Simulation Control APIs</h2>
                        <div class="api-method">
                            <div class="api-signature">
                                <span class="api-command">start_simulation</span>
                            </div>
                            <p>Starts the real-time simulation engine.</p>
                            <pre class="code-block">async function startSimulation() {
  const result = await invoke('start_simulation');
  console.log(result); // "Simulation Started"
}</pre>
                        </div>

                        <div class="api-method">
                            <div class="api-signature">
                                <span class="api-command">stop_simulation</span>
                            </div>
                            <p>Stops the currently running simulation.</p>
                            <pre class="code-block">async function stopSimulation() {
  const result = await invoke('stop_simulation');
  console.log(result); // "Simulation Stopped"
}</pre>
                        </div>
                    </div>

                    <div class="api-category">
                        <h2>ROS2 Middleware APIs</h2>
                        <div class="api-method">
                            <div class="api-signature">
                                <span class="api-command">ros2_publish</span>
                                <span class="api-params">(topic: string, message: any)</span>
                            </div>
                            <p>Publishes a message to a ROS2 topic.</p>
                            <pre class="code-block">await invoke('ros2_publish', {
  topic: '/cmd_vel',
  message: { linear: { x: 0.5 }, angular: { z: 0.0 } }
});</pre>
                        </div>
                    </div>

                    <div class="info-box">
                        <p>📚 For complete API documentation, see <code>API_DOCUMENTATION.md</code> in the project root.</p>
                    </div>
                </div>

                <!-- Support Tab -->
                <div class="docs-section" id="support-section">
                    <h1>🆘 Support & Resources</h1>
                    
                    <div class="support-grid">
                        <div class="support-card">
                            <div class="support-icon">📖</div>
                            <h3>Documentation</h3>
                            <p>Comprehensive guides and references</p>
                            <ul class="support-links">
                                <li><a href="#" onclick="switchDocsTab('quickstart'); return false;">Quick Start Guide</a></li>
                                <li><a href="#" onclick="switchDocsTab('features'); return false;">Feature Documentation</a></li>
                                <li><a href="#" onclick="switchDocsTab('keyboard'); return false;">Keyboard Shortcuts</a></li>
                            </ul>
                        </div>

                        <div class="support-card">
                            <div class="support-icon">💬</div>
                            <h3>Community</h3>
                            <p>Connect with other NAVΛ developers</p>
                            <ul class="support-links">
                                <li><a href="https://discord.gg/navlambda" target="_blank">Discord Server</a></li>
                                <li><a href="https://twitter.com/navlambda_studio" target="_blank">Twitter</a></li>
                                <li><a href="https://github.com/FrankAsanteVanLaarhoven/NAVA-Ai-Studio/discussions" target="_blank">GitHub Discussions</a></li>
                            </ul>
                        </div>

                        <div class="support-card">
                            <div class="support-icon">🐛</div>
                            <h3>Bug Reports</h3>
                            <p>Found an issue? Let us know!</p>
                            <ul class="support-links">
                                <li><a href="https://github.com/FrankAsanteVanLaarhoven/NAVA-Ai-Studio/issues" target="_blank">GitHub Issues</a></li>
                                <li><a href="mailto:support@navlambda.studio">Email Support</a></li>
                            </ul>
                        </div>

                        <div class="support-card">
                            <div class="support-icon">🎓</div>
                            <h3>Learning Resources</h3>
                            <p>Expand your knowledge</p>
                            <ul class="support-links">
                                <li><a href="#" onclick="switchDocsTab('ros'); return false;">ROS Learning Center</a></li>
                                <li>Video Tutorials (Coming Soon)</li>
                                <li>Example Projects</li>
                            </ul>
                        </div>
                    </div>

                    <div class="info-box">
                        <h3>📚 Additional Documentation Files</h3>
                        <div class="doc-files">
                            <div class="doc-file">
                                <strong>README.md</strong> - Project overview and installation
                            </div>
                            <div class="doc-file">
                                <strong>GETTING_STARTED.md</strong> - Detailed getting started guide
                            </div>
                            <div class="doc-file">
                                <strong>API_DOCUMENTATION.md</strong> - Complete API reference
                            </div>
                            <div class="doc-file">
                                <strong>ARCHITECTURE.md</strong> - System architecture details
                            </div>
                            <div class="doc-file">
                                <strong>ROS_LEARNING_SYSTEM.md</strong> - ROS learning documentation
                            </div>
                            <div class="doc-file">
                                <strong>BUILD_INSTRUCTIONS.md</strong> - Building from source
                            </div>
                        </div>
                    </div>

                    <div class="feature-detail">
                        <h2>🔧 Troubleshooting</h2>
                        
                        <div class="troubleshoot-item">
                            <h4>Port Already in Use</h4>
                            <p>If you see "Port 5173 is already in use":</p>
                            <pre class="code-block"># On macOS/Linux
lsof -ti:5173 | xargs kill -9

# Or use a different port
npm run dev -- --port 3000</pre>
                        </div>

                        <div class="troubleshoot-item">
                            <h4>Module Not Found</h4>
                            <p>If you see module errors:</p>
                            <pre class="code-block"># Clean install
rm -rf node_modules package-lock.json
npm install</pre>
                        </div>

                        <div class="troubleshoot-item">
                            <h4>Tauri Build Issues</h4>
                            <p>If Tauri build fails:</p>
                            <pre class="code-block"># Update Rust
rustup update

# Try building again
npm run tauri:build</pre>
                        </div>
                    </div>

                    <div class="info-box success">
                        <h3>✨ Pro Tips</h3>
                        <ul>
                            <li><strong>Use keyboard shortcuts</strong> - Much faster than clicking!</li>
                            <li><strong>Split view</strong> - Toggle visualization panel for side-by-side editing</li>
                            <li><strong>Live preview</strong> - Leave preview on for instant feedback</li>
                            <li><strong>Documentation on hover</strong> - Hover over any VNC symbol for docs</li>
                            <li><strong>Examples as templates</strong> - Copy examples and modify for your needs</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Terminal Modal -->
    <div class="terminal-modal" id="terminalModal" onclick="closeTerminalModalOnBackdrop(event)">
        <div class="terminal-panel">
            <div class="terminal-header">
                <div class="terminal-title">
                    <span>💻</span>
                    <span>NAVΛ Studio Terminal</span>
                </div>
                <div class="terminal-controls">
                    <button class="terminal-control-btn" onclick="clearTerminal()" title="Clear Terminal">🗑️ Clear</button>
                    <button class="terminal-control-btn" onclick="resetTerminal()" title="Reset Terminal">🔄 Reset</button>
                    <button class="close-btn" onclick="toggleTerminalModal()">✕</button>
                </div>
            </div>
            <div class="terminal-content" id="terminalContainer"></div>
        </div>
    </div>

    <script>
        // Update time
        function updateTime() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            document.getElementById('time').textContent = `${hours}:${minutes}`;
            
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const year = now.getFullYear();
            document.getElementById('date').textContent = `${month}/${day}/${year}`;
        }
        
        updateTime();
        setInterval(updateTime, 60000);

        // Set initial time for welcome message
        document.getElementById('initialTime').textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

        // Nav item interactions
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', (e) => {
                const href = item.getAttribute('href');
                if (href.startsWith('#')) {
                    e.preventDefault();
                    alert('🚀 Feature Coming Soon!\n\nThis section will include:\n• Your navigation projects\n• Example code\n• Community contributions\n\nFor now, click the top bar to launch the IDE!');
                }
            });
        });

        // AI Assistant functionality
        const availableModels = {
            'anthropic/claude-3.5-sonnet': {
                name: 'Claude 3.5 Sonnet',
                description: 'Most capable model for coding and analysis',
                contextLength: 200000
            },
            'anthropic/claude-3-opus': {
                name: 'Claude 3 Opus',
                description: 'Best for complex tasks',
                contextLength: 200000
            },
            'anthropic/claude-3-sonnet': {
                name: 'Claude 3 Sonnet',
                description: 'Balanced performance and speed',
                contextLength: 200000
            },
            'openai/gpt-4-turbo': {
                name: 'GPT-4 Turbo',
                description: 'Latest GPT-4 with vision',
                contextLength: 128000
            },
            'openai/gpt-4': {
                name: 'GPT-4',
                description: 'OpenAI\'s most capable model',
                contextLength: 8192
            },
            'openai/gpt-3.5-turbo': {
                name: 'GPT-3.5 Turbo',
                description: 'Fast and efficient',
                contextLength: 16385
            },
            'google/gemini-pro': {
                name: 'Gemini Pro',
                description: 'Google\'s powerful model',
                contextLength: 32000
            },
            'meta-llama/llama-3-70b-instruct': {
                name: 'Llama 3 70B',
                description: 'Open source powerhouse',
                contextLength: 8192
            },
            'mistralai/mistral-large': {
                name: 'Mistral Large',
                description: 'Top tier open model',
                contextLength: 32000
            }
        };

        let messages = [];
        let isThinking = false;

        // Load API key from localStorage
        const savedApiKey = localStorage.getItem('openrouter_api_key') || '';
        if (savedApiKey) {
            document.getElementById('apiKeyInput').value = savedApiKey;
        }
        updateStatus();
        updateModelInfo();

        function toggleAIModal() {
            const modal = document.getElementById('aiModal');
            modal.classList.toggle('active');
        }

        function closeModalOnBackdrop(event) {
            if (event.target.id === 'aiModal') {
                toggleAIModal();
            }
        }

        // Documentation Modal Functions
        function toggleDocsModal() {
            const modal = document.getElementById('docsModal');
            modal.classList.toggle('active');
        }

        function closeDocsModalOnBackdrop(event) {
            if (event.target.id === 'docsModal') {
                toggleDocsModal();
            }
        }

        function switchDocsTab(tabName) {
            // Remove active class from all tabs
            document.querySelectorAll('.docs-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all sections
            document.querySelectorAll('.docs-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            // Show corresponding section
            const sectionId = tabName + '-section';
            document.getElementById(sectionId).classList.add('active');
            
            // Scroll to top of content
            document.getElementById('docsContent').scrollTop = 0;
        }

        // Terminal Functions
        let term = null;
        let fitAddon = null;
        let currentDirectory = '~/workspace';
        let currentInput = '';
        let cursorPosition = 0;
        let commandHistory = [];
        let historyIndex = -1;

        function initializeTerminal() {
            if (term) return; // Already initialized

            // Create terminal instance
            term = new Terminal({
                cursorBlink: true,
                fontSize: 14,
                fontFamily: 'Menlo, Monaco, "Courier New", monospace',
                theme: {
                    background: '#0a0f1e',
                    foreground: '#e0e0e0',
                    cursor: '#00ff00',
                    cursorAccent: '#000000',
                    selection: 'rgba(0, 255, 0, 0.3)',
                    black: '#000000',
                    red: '#ef4444',
                    green: '#00ff00',
                    yellow: '#fbbf24',
                    blue: '#3b82f6',
                    magenta: '#a855f7',
                    cyan: '#06b6d4',
                    white: '#ffffff',
                    brightBlack: '#4b5563',
                    brightRed: '#f87171',
                    brightGreen: '#22c55e',
                    brightYellow: '#fde047',
                    brightBlue: '#60a5fa',
                    brightMagenta: '#c084fc',
                    brightCyan: '#22d3ee',
                    brightWhite: '#f9fafb',
                },
                allowProposedApi: true,
            });

            // Load addons
            fitAddon = new FitAddon.FitAddon();
            const webLinksAddon = new WebLinksAddon.WebLinksAddon();
            
            term.loadAddon(fitAddon);
            term.loadAddon(webLinksAddon);

            // Open terminal
            const container = document.getElementById('terminalContainer');
            term.open(container);
            fitAddon.fit();

            // Welcome message
            term.writeln('\x1b[32m╔══════════════════════════════════════════════════════════════╗\x1b[0m');
            term.writeln('\x1b[32m║         NAVΛ Studio IDE - Integrated Terminal              ║\x1b[0m');
            term.writeln('\x1b[32m║    Van Laarhoven Navigation Calculus Development           ║\x1b[0m');
            term.writeln('\x1b[32m╚══════════════════════════════════════════════════════════════╝\x1b[0m');
            term.writeln('');
            term.writeln('\x1b[36m⋋ Welcome to the NAVΛ Terminal!\x1b[0m');
            term.writeln('\x1b[90mType \x1b[33mhelp\x1b[90m for available commands\x1b[0m');
            term.writeln('\x1b[90mType \x1b[33mnav-help\x1b[90m for NAVΛ navigation commands\x1b[0m');
            term.writeln('');

            writePrompt();

            // Handle input
            term.onKey(({ key, domEvent }) => {
                const printable = !domEvent.altKey && !domEvent.ctrlKey && !domEvent.metaKey;

                if (domEvent.keyCode === 13) {
                    // Enter
                    term.write('\r\n');
                    if (currentInput.trim()) {
                        commandHistory.push(currentInput);
                        historyIndex = commandHistory.length;
                        executeCommand(currentInput.trim());
                    } else {
                        writePrompt();
                    }
                    currentInput = '';
                    cursorPosition = 0;
                } else if (domEvent.keyCode === 8) {
                    // Backspace
                    if (cursorPosition > 0) {
                        currentInput = currentInput.slice(0, cursorPosition - 1) + currentInput.slice(cursorPosition);
                        cursorPosition--;
                        term.write('\b \b');
                        if (cursorPosition < currentInput.length) {
                            term.write(currentInput.slice(cursorPosition) + ' \b');
                            for (let i = 0; i < currentInput.length - cursorPosition + 1; i++) {
                                term.write('\b');
                            }
                        }
                    }
                } else if (domEvent.keyCode === 38) {
                    // Arrow Up - History
                    if (historyIndex > 0) {
                        historyIndex--;
                        // Clear current line
                        term.write('\r\x1b[K');
                        writePrompt();
                        currentInput = commandHistory[historyIndex];
                        cursorPosition = currentInput.length;
                        term.write(currentInput);
                    }
                } else if (domEvent.keyCode === 40) {
                    // Arrow Down - History
                    if (historyIndex < commandHistory.length - 1) {
                        historyIndex++;
                        term.write('\r\x1b[K');
                        writePrompt();
                        currentInput = commandHistory[historyIndex];
                        cursorPosition = currentInput.length;
                        term.write(currentInput);
                    } else if (historyIndex === commandHistory.length - 1) {
                        historyIndex = commandHistory.length;
                        term.write('\r\x1b[K');
                        writePrompt();
                        currentInput = '';
                        cursorPosition = 0;
                    }
                } else if (domEvent.keyCode === 37) {
                    // Arrow Left
                    if (cursorPosition > 0) {
                        cursorPosition--;
                        term.write('\x1b[D');
                    }
                } else if (domEvent.keyCode === 39) {
                    // Arrow Right
                    if (cursorPosition < currentInput.length) {
                        cursorPosition++;
                        term.write('\x1b[C');
                    }
                } else if (domEvent.keyCode === 67 && domEvent.ctrlKey) {
                    // Ctrl+C
                    term.write('^C\r\n');
                    writePrompt();
                    currentInput = '';
                    cursorPosition = 0;
                } else if (domEvent.keyCode === 76 && domEvent.ctrlKey) {
                    // Ctrl+L - Clear screen
                    term.clear();
                    writePrompt();
                    currentInput = '';
                    cursorPosition = 0;
                } else if (printable) {
                    currentInput = currentInput.slice(0, cursorPosition) + key + currentInput.slice(cursorPosition);
                    cursorPosition++;
                    term.write(key);
                    if (cursorPosition < currentInput.length) {
                        term.write(currentInput.slice(cursorPosition));
                        for (let i = 0; i < currentInput.length - cursorPosition; i++) {
                            term.write('\b');
                        }
                    }
                }
            });

            // Handle resize
            window.addEventListener('resize', () => {
                if (fitAddon && document.getElementById('terminalModal').classList.contains('active')) {
                    fitAddon.fit();
                }
            });
        }

        function writePrompt() {
            term.write('\r\n\x1b[32m⋋\x1b[0m \x1b[36m' + currentDirectory + '\x1b[0m \x1b[33m$\x1b[0m ');
        }

        function executeCommand(command) {
            const parts = command.trim().split(/\s+/);
            const cmd = parts[0];
            const args = parts.slice(1);

            switch(cmd) {
                case 'help':
                    term.writeln('\x1b[36mAvailable Commands:\x1b[0m');
                    term.writeln('');
                    term.writeln('  \x1b[33mhelp\x1b[0m          - Show this help message');
                    term.writeln('  \x1b[33mnav-help\x1b[0m      - Show NAVΛ navigation commands');
                    term.writeln('  \x1b[33mls\x1b[0m            - List directory contents');
                    term.writeln('  \x1b[33mpwd\x1b[0m           - Print working directory');
                    term.writeln('  \x1b[33mcd <dir>\x1b[0m      - Change directory');
                    term.writeln('  \x1b[33mclear\x1b[0m         - Clear the terminal');
                    term.writeln('  \x1b[33mecho <text>\x1b[0m   - Echo text to terminal');
                    term.writeln('  \x1b[33mdate\x1b[0m          - Display current date/time');
                    term.writeln('  \x1b[33mwhoami\x1b[0m        - Display current user');
                    term.writeln('  \x1b[33msystem-info\x1b[0m   - Show system information');
                    term.writeln('  \x1b[33mnpm <cmd>\x1b[0m     - Run npm commands');
                    term.writeln('  \x1b[33mgit <cmd>\x1b[0m     - Run git commands');
                    term.writeln('');
                    term.writeln('\x1b[90mKeyboard Shortcuts:\x1b[0m');
                    term.writeln('  \x1b[33mCtrl+C\x1b[0m        - Cancel current command');
                    term.writeln('  \x1b[33mCtrl+L\x1b[0m        - Clear screen');
                    term.writeln('  \x1b[33mUp/Down\x1b[0m       - Navigate command history');
                    term.writeln('');
                    break;

                case 'nav-help':
                    term.writeln('\x1b[36m⋋ NAVΛ Navigation Commands:\x1b[0m');
                    term.writeln('');
                    term.writeln('  \x1b[33mnavλ compile <file>\x1b[0m   - Compile NAVΛ source');
                    term.writeln('  \x1b[33mnavλ run <file>\x1b[0m       - Run NAVΛ program');
                    term.writeln('  \x1b[33mnavλ visualize <file>\x1b[0m - Visualize navigation');
                    term.writeln('  \x1b[33mnavλ optimize <file>\x1b[0m  - Optimize navigation path');
                    term.writeln('  \x1b[33mnavλ symbols\x1b[0m          - Show navigation symbols');
                    term.writeln('  \x1b[33mnavλ version\x1b[0m          - Show NAVΛ version');
                    term.writeln('');
                    term.writeln('\x1b[90mNavigation Symbols:\x1b[0m');
                    term.writeln('  \x1b[32m⋋\x1b[0m  - Lambda Navigation');
                    term.writeln('  \x1b[32m⊗⋋\x1b[0m - Tensor Product');
                    term.writeln('  \x1b[32m⊕⋋\x1b[0m - Navigation Sum');
                    term.writeln('  \x1b[32m𝒩ℐ\x1b[0m - Master Operator');
                    term.writeln('  \x1b[32mℰ\x1b[0m  - Evolution Operator');
                    term.writeln('');
                    break;

                case 'clear':
                    term.clear();
                    break;

                case 'ls':
                    term.writeln('\x1b[36mprojects/\x1b[0m     \x1b[90msrc/\x1b[0m         \x1b[32mREADME.md\x1b[0m');
                    term.writeln('\x1b[36mnode_modules/\x1b[0m \x1b[90mdist/\x1b[0m        \x1b[32mpackage.json\x1b[0m');
                    break;

                case 'pwd':
                    term.writeln(currentDirectory);
                    break;

                case 'cd':
                    if (args.length === 0 || args[0] === '~') {
                        currentDirectory = '~/workspace';
                    } else if (args[0] === '..') {
                        const parts = currentDirectory.split('/');
                        if (parts.length > 2) {
                            parts.pop();
                            currentDirectory = parts.join('/');
                        }
                    } else {
                        currentDirectory = currentDirectory + '/' + args[0];
                    }
                    break;

                case 'echo':
                    term.writeln(args.join(' '));
                    break;

                case 'date':
                    term.writeln(new Date().toString());
                    break;

                case 'whoami':
                    term.writeln('navλ-developer');
                    break;

                case 'system-info':
                    term.writeln('\x1b[36mSystem Information:\x1b[0m');
                    term.writeln('');
                    term.writeln(`  OS: ${navigator.platform}`);
                    term.writeln(`  Browser: ${navigator.userAgent.split(' ').slice(-2).join(' ')}`);
                    term.writeln(`  Cores: ${navigator.hardwareConcurrency}`);
                    term.writeln(`  Screen: ${window.screen.width}x${window.screen.height}`);
                    term.writeln('');
                    break;

                case 'npm':
                    term.writeln(`\x1b[90m$ npm ${args.join(' ')}\x1b[0m`);
                    term.writeln('\x1b[33mSimulating npm command...\x1b[0m');
                    setTimeout(() => {
                        term.writeln('\x1b[32m✓ npm command completed\x1b[0m');
                        writePrompt();
                    }, 1000);
                    return;

                case 'git':
                    term.writeln(`\x1b[90m$ git ${args.join(' ')}\x1b[0m`);
                    term.writeln('\x1b[33mSimulating git command...\x1b[0m');
                    setTimeout(() => {
                        term.writeln('\x1b[32m✓ git command completed\x1b[0m');
                        writePrompt();
                    }, 800);
                    return;

                case 'navλ':
                case 'navlambda':
                    if (args[0] === 'version') {
                        term.writeln('\x1b[32mNAVΛ Studio IDE v1.0.0\x1b[0m');
                        term.writeln('\x1b[90mVan Laarhoven Navigation Calculus Compiler\x1b[0m');
                    } else if (args[0] === 'symbols') {
                        term.writeln('\x1b[36m⋋ Navigation Symbols:\x1b[0m');
                        term.writeln('');
                        term.writeln('  \x1b[32m⋋\x1b[0m  - Lambda Navigation (Alt+L)');
                        term.writeln('  \x1b[32m⊗⋋\x1b[0m - Tensor Product (Alt+Shift+T)');
                        term.writeln('  \x1b[32m⊕⋋\x1b[0m - Navigation Sum (Alt+Shift+S)');
                        term.writeln('  \x1b[32m∪⋋\x1b[0m - Union Operation');
                        term.writeln('  \x1b[32m∩⋋\x1b[0m - Intersection Operation');
                        term.writeln('  \x1b[32m𝒩ℐ\x1b[0m - Master Operator (Alt+Shift+M)');
                        term.writeln('  \x1b[32mℰ\x1b[0m  - Evolution Operator (Alt+Shift+E)');
                        term.writeln('');
                    } else {
                        term.writeln('\x1b[33mUse: navλ compile|run|visualize|optimize <file>\x1b[0m');
                        term.writeln('\x1b[90mOr type \x1b[33mnav-help\x1b[90m for more information\x1b[0m');
                    }
                    break;

                default:
                    term.writeln(`\x1b[31mbash: ${cmd}: command not found\x1b[0m`);
                    term.writeln('\x1b[90mType \x1b[33mhelp\x1b[90m for available commands\x1b[0m');
                    break;
            }

            writePrompt();
        }

        function toggleTerminalModal() {
            const modal = document.getElementById('terminalModal');
            const isOpening = !modal.classList.contains('active');
            
            modal.classList.toggle('active');
            
            if (isOpening) {
                if (!term) {
                    setTimeout(() => {
                        initializeTerminal();
                    }, 100);
                } else {
                    setTimeout(() => {
                        if (fitAddon) {
                            fitAddon.fit();
                        }
                    }, 100);
                }
            }
        }

        function closeTerminalModalOnBackdrop(event) {
            if (event.target.id === 'terminalModal') {
                toggleTerminalModal();
            }
        }

        function clearTerminal() {
            if (term) {
                term.clear();
                writePrompt();
            }
        }

        function resetTerminal() {
            if (term) {
                term.reset();
                currentDirectory = '~/workspace';
                currentInput = '';
                cursorPosition = 0;
                commandHistory = [];
                historyIndex = -1;
                
                // Re-show welcome message
                term.writeln('\x1b[32m╔══════════════════════════════════════════════════════════════╗\x1b[0m');
                term.writeln('\x1b[32m║         NAVΛ Studio IDE - Integrated Terminal              ║\x1b[0m');
                term.writeln('\x1b[32m║    Van Laarhoven Navigation Calculus Development           ║\x1b[0m');
                term.writeln('\x1b[32m╚══════════════════════════════════════════════════════════════╝\x1b[0m');
                term.writeln('');
                term.writeln('\x1b[36m⋋ Welcome to the NAVΛ Terminal!\x1b[0m');
                term.writeln('\x1b[90mType \x1b[33mhelp\x1b[90m for available commands\x1b[0m');
                term.writeln('\x1b[90mType \x1b[33mnav-help\x1b[90m for NAVΛ navigation commands\x1b[0m');
                term.writeln('');
                writePrompt();
            }
        }

        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            panel.classList.toggle('active');
        }

        function saveApiKey() {
            const apiKey = document.getElementById('apiKeyInput').value;
            localStorage.setItem('openrouter_api_key', apiKey);
            updateStatus();
        }

        function updateStatus() {
            const apiKey = localStorage.getItem('openrouter_api_key') || '';
            const statusDot = document.getElementById('statusDot');
            const statusText = document.getElementById('statusText');
            const warningMessage = document.getElementById('warningMessage');

            if (isThinking) {
                statusDot.className = 'status-dot thinking';
                statusText.textContent = 'Thinking...';
            } else if (apiKey) {
                statusDot.className = 'status-dot';
                statusText.textContent = 'Ready';
                warningMessage.style.display = 'none';
            } else {
                statusDot.className = 'status-dot warning';
                statusText.textContent = 'No API Key';
                warningMessage.style.display = 'block';
            }
        }

        function updateModelInfo() {
            const modelId = document.getElementById('modelSelector').value;
            const model = availableModels[modelId];
            const modelInfo = document.getElementById('modelInfo');
            
            modelInfo.innerHTML = `
                <strong>${model.name}</strong>
                <p>${model.description}</p>
                <p style="color: #858585; font-size: 11px;">Context: ${model.contextLength.toLocaleString()} tokens</p>
            `;
        }

        function insertSymbol(symbol) {
            const input = document.getElementById('aiInput');
            input.value += symbol;
            input.focus();
        }

        function handleKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        async function sendMessage() {
            const input = document.getElementById('aiInput');
            const query = input.value.trim();
            
            if (!query || isThinking) return;

            // Add user message
            addMessage('user', query);
            input.value = '';

            isThinking = true;
            updateStatus();

            const apiKey = localStorage.getItem('openrouter_api_key') || '';
            const modelId = document.getElementById('modelSelector').value;

            try {
                if (apiKey) {
                    // Use OpenRouter API
                    const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${apiKey}`,
                            'HTTP-Referer': window.location.origin,
                            'X-Title': 'NAVΛ Studio IDE',
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: modelId,
                            messages: [
                                {
                                    role: 'system',
                                    content: 'You are an expert AI assistant specialized in Van Laarhoven Navigation Calculus (VNC). Help users understand and write VNC code, explain navigation concepts, and provide coding assistance. Use the ⋋ (Van Laarhoven Lambda) symbol when relevant.',
                                },
                                ...messages.slice(-5).map(m => ({
                                    role: m.role,
                                    content: m.content,
                                })),
                                {
                                    role: 'user',
                                    content: query,
                                },
                            ],
                        }),
                    });

                    if (!response.ok) {
                        throw new Error(`OpenRouter API error: ${response.statusText}`);
                    }

                    const data = await response.json();
                    const aiContent = data.choices[0]?.message?.content || 'No response received.';
                    addMessage('assistant', aiContent);
                } else {
                    // Fallback to simulated response
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    const aiContent = generateSimulatedResponse(query);
                    addMessage('assistant', aiContent);
                }
            } catch (error) {
                console.error('Error calling AI:', error);
                addMessage('assistant', `⚠️ Error: ${error.message}. Please check your API key and try again.`);
            }

            isThinking = false;
            updateStatus();
        }

        function addMessage(role, content) {
            const messagesContainer = document.getElementById('aiMessages');
            const messageTime = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            const messageEl = document.createElement('div');
            messageEl.className = `message ${role}`;
            messageEl.innerHTML = `
                <div class="message-avatar">${role === 'user' ? '👤' : '🤖'}</div>
                <div class="message-content">
                    <div class="message-header">
                        <span class="message-role">${role === 'user' ? 'You' : 'AI Assistant'}</span>
                        <span class="message-time">${messageTime}</span>
                    </div>
                    <div class="message-text">${content}</div>
                </div>
            `;
            
            messagesContainer.appendChild(messageEl);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            messages.push({ role, content, timestamp: new Date() });
        }

        function generateSimulatedResponse(query) {
            const lowerQuery = query.toLowerCase();

            if (lowerQuery.includes('⋋') || lowerQuery.includes('lambda')) {
                return '**Van Laarhoven Lambda (⋋)**\n\nThe ⋋ operator represents a navigation transformation in VNC. Here\'s how it works:\n\n```vnc\n⋋ φ: M → N\n```\n\nThis defines a navigation mapping from manifold M to manifold N. You can use it to:\n\n1. Define navigation fields\n2. Compose transformations\n3. Optimize paths through geometric spaces\n\nWould you like me to show you a specific example?';
            }

            if (lowerQuery.includes('optimize') || lowerQuery.includes('performance')) {
                return '**Performance Optimization Tips**\n\n1. **Use Memoization**: Cache computed navigation paths\n2. **Vectorize Operations**: Leverage SIMD for manifold computations\n3. **Parallel Processing**: Split large navigation fields across threads\n4. **GPU Acceleration**: Use WASM-SIMD for browser-based calculations\n\nHere\'s an optimized pattern:\n\n```vnc\n@memoize\n⋋ fast_nav = parallel_map(nav_field)\n```';
            }

            if (lowerQuery.includes('error') || lowerQuery.includes('debug')) {
                return '**Debugging Navigation Code**\n\n🔍 Common issues:\n\n1. **Type Mismatches**: Ensure manifold dimensions align\n2. **Singularities**: Check for division by zero in metric tensors\n3. **Convergence**: Verify optimization parameters\n\nTry adding:\n```vnc\n@debug_trace\n⋋ my_navigation_fn\n```\n\nThis will show step-by-step execution.';
            }

            return `I understand you're asking about: "${query}"\n\nLet me help you with that. The Van Laarhoven Navigation Calculus provides powerful abstractions for:\n\n• **Geometric computations** on manifolds\n• **Path optimization** through configuration spaces\n• **Energy minimization** in navigation fields\n\nCould you provide more specific details about what you'd like to accomplish?`;
        }

        // Modal Functions for Widget Actions
        function showHelpModal() {
            alert('📚 NAVΛ Studio Help\n\n• Press Ctrl+Shift+P for Command Palette\n• Click 🤖 for ROS Learning\n• Click ⋋ for Full IDE Application\n• Click 📚 for Documentation\n• Click 💻 for Terminal\n\nNeed more help? Contact: support@navlambda.studio');
        }

        function showSettingsModal() {
            const choice = confirm('⚙️ Settings\n\nWould you like to:\n• OK: Open Advanced Settings\n• Cancel: Quick Theme Toggle');
            if (choice) {
                window.location.href = '/app.html';
            } else {
                document.body.classList.toggle('light-theme');
            }
        }

        function showLanguageModal() {
            const languages = ['🇬🇧 English', '🇪🇸 Español', '🇫🇷 Français', '🇩🇪 Deutsch', '🇯🇵 日本語', '🇨🇳 中文'];
            alert('🌍 Language Selection\n\nAvailable Languages:\n' + languages.join('\n') + '\n\nComing soon: Full i18n support!');
        }

        function confirmLogout() {
            if (confirm('⏻ Sign Out\n\nAre you sure you want to sign out from NAVΛ Studio?')) {
                alert('👋 Signed out successfully!\n\nYour progress has been saved.');
                // In production, this would clear session and redirect to login
            }
        }

        // Widget initialization code - see end of file (line ~1720)

        // Language Selector Functions
        function showLanguageModal() {
            const modal = document.getElementById('languageModal');
            if (modal) {
                modal.classList.add('active');
            }
        }

        function closeLanguageModal() {
            const modal = document.getElementById('languageModal');
            if (modal) {
                modal.classList.remove('active');
            }
        }

        function selectLanguage(langCode) {
            // Get all language items and remove active class
            const languageItems = document.querySelectorAll('.language-item');
            languageItems.forEach(item => item.classList.remove('active'));

            // Add active class to selected item
            const selectedItem = document.querySelector(`[onclick="selectLanguage('${langCode}')"]`);
            if (selectedItem) {
                selectedItem.classList.add('active');
            }

            // Update language button text
            const languageBtn = document.getElementById('languageBtn');
            const languageMap = {
                'en': '🇬🇧 EN',
                'es': '🇪🇸 ES',
                'fr': '🇫🇷 FR',
                'de': '🇩🇪 DE',
                'zh': '🇨🇳 ZH',
                'ja': '🇯🇵 JA',
                'ar': '🇸🇦 AR',
                'pt': '🇵🇹 PT',
                'ru': '🇷🇺 RU'
            };

            if (languageBtn) {
                languageBtn.textContent = languageMap[langCode] || '🇬🇧 EN';
            }

            // Store selection in localStorage
            localStorage.setItem('selectedLanguage', langCode);

            // Close modal after selection
            setTimeout(closeLanguageModal, 300);

            // Show confirmation
            const languageNames = {
                'en': 'English',
                'es': 'Español',
                'fr': 'Français',
                'de': 'Deutsch',
                'zh': '中文',
                'ja': '日本語',
                'ar': 'العربية',
                'pt': 'Português',
                'ru': 'Русский'
            };

            alert(`Language changed to ${languageNames[langCode] || 'English'}!`);
        }
    </script>

    <!-- Duplicate widgets removed - see line 1714 for active widgets -->

    <!-- Language Selector Modal -->
    <div class="language-modal" id="languageModal" onclick="if(event.target === this) closeLanguageModal()">
        <div class="language-panel">
            <div class="language-panel-header">
                <div class="language-panel-title">🌍 Select Language</div>
                <button class="language-panel-close" onclick="closeLanguageModal()">✕</button>
            </div>

            <div class="language-list">
                <div class="language-item active" onclick="selectLanguage('en')">
                    <div class="language-flag">🇬🇧</div>
                    <div class="language-name">English</div>
                    <div class="language-check">✓</div>
                </div>
                <div class="language-item" onclick="selectLanguage('es')">
                    <div class="language-flag">🇪🇸</div>
                    <div class="language-name">Español</div>
                    <div class="language-check">✓</div>
                </div>
                <div class="language-item" onclick="selectLanguage('fr')">
                    <div class="language-flag">🇫🇷</div>
                    <div class="language-name">Français</div>
                    <div class="language-check">✓</div>
                </div>
                <div class="language-item" onclick="selectLanguage('de')">
                    <div class="language-flag">🇩🇪</div>
                    <div class="language-name">Deutsch</div>
                    <div class="language-check">✓</div>
                </div>
                <div class="language-item" onclick="selectLanguage('zh')">
                    <div class="language-flag">🇨🇳</div>
                    <div class="language-name">中文 (Chinese)</div>
                    <div class="language-check">✓</div>
                </div>
                <div class="language-item" onclick="selectLanguage('ja')">
                    <div class="language-flag">🇯🇵</div>
                    <div class="language-name">日本語 (Japanese)</div>
                    <div class="language-check">✓</div>
                </div>
                <div class="language-item" onclick="selectLanguage('ar')">
                    <div class="language-flag">🇸🇦</div>
                    <div class="language-name">العربية (Arabic)</div>
                    <div class="language-check">✓</div>
                </div>
                <div class="language-item" onclick="selectLanguage('pt')">
                    <div class="language-flag">🇵🇹</div>
                    <div class="language-name">Português</div>
                    <div class="language-check">✓</div>
                </div>
                <div class="language-item" onclick="selectLanguage('ru')">
                    <div class="language-flag">🇷🇺</div>
                    <div class="language-name">Русский (Russian)</div>
                    <div class="language-check">✓</div>
                </div>
            </div>
        </div>
    </div>

    <div class="language-item" onclick="selectLanguage('ru')">
        <div class="language-flag">🇷🇺</div>
        <div class="language-name">Русский (Russian)</div>
        <div class="language-check">✓</div>
    </div>
    </div>
    </div>
    </div>

    <!-- Top Right Widgets Container -->
    <div class="top-right-widgets">
        <!-- Compact Weather Widget (Multi-City) -->
        <div class="compact-widget" id="weatherWidget">
            <div class="widget-header">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <button class="widget-collapse-btn" onclick="toggleWidget('weatherWidget')" title="Collapse/Expand">▼</button>
                <span class="widget-title">🌤️ Weather</span>
                </div>
                <select id="weatherCitySelect" onchange="changeWeatherCity()" class="city-selector">
                    <option value="0">New York, US</option>
                    <option value="1" selected>London, UK</option>
                    <option value="2">Tokyo, Japan</option>
                    <option value="3">Sydney, Australia</option>
                </select>
            </div>
            <div class="widget-content">
            <div class="weather-main">
                    <div class="weather-temp" id="weatherTemp">15°C</div>
                    <div class="weather-condition" id="weatherCondition">Rainy</div>
            </div>
            <div class="weather-details">
                <div class="weather-detail">
                    <span>💧</span>
                        <span id="weatherHumidity">Humidity: 80%</span>
                </div>
                <div class="weather-detail">
                    <span>💨</span>
                        <span id="weatherWind">Wind: 20 km/h</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- World Clock Widget (Multi-City) -->
        <div class="compact-widget" id="clockWidget">
            <div class="widget-header">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <button class="widget-collapse-btn" onclick="toggleWidget('clockWidget')" title="Collapse/Expand">▼</button>
                <span class="widget-title">⏰ World Clock</span>
                </div>
                <select id="clockCitySelect" onchange="changeClockCity()" class="city-selector">
                    <option value="America/New_York">New York, US</option>
                    <option value="Europe/London" selected>London, UK</option>
                    <option value="Asia/Tokyo">Tokyo, Japan</option>
                    <option value="Australia/Sydney">Sydney, Australia</option>
                </select>
            </div>
            <div class="widget-content">
            <div class="clock-main">
                <div class="clock-time" id="currentTime">00:00:00</div>
                    <div class="clock-timezone" id="currentTimezone">GMT+01:00</div>
                </div>
            </div>
        </div>

        <!-- News Feed Widget -->
        <div class="compact-widget" id="newsWidget">
            <div class="widget-header">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <button class="widget-collapse-btn" onclick="toggleWidget('newsWidget')" title="Collapse/Expand">▼</button>
                <span class="widget-title">📰 News Feed</span>
                </div>
                <span class="widget-refresh" onclick="refreshNews()" style="cursor: pointer;">🔄</span>
            </div>
            <div class="widget-content">
            <div class="news-feed-content">
                <div class="news-item">
                        <div class="news-category">TECH</div>
                    <div class="news-title">AI Navigation Breakthrough</div>
                    <div class="news-time">2h ago</div>
                </div>
                <div class="news-item">
                        <div class="news-category">AUTO</div>
                    <div class="news-title">Waymo Service Expands</div>
                    <div class="news-time">4h ago</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Currency Calculator -->
        <div class="compact-widget" id="currencyWidget">
            <div class="widget-header">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <button class="widget-collapse-btn" onclick="toggleWidget('currencyWidget')" title="Collapse/Expand">▼</button>
                <span class="widget-title">💱 Currency</span>
            </div>
            </div>
            <div class="widget-content">
            <div class="currency-calc">
                <div class="currency-row">
                    <input type="number" id="currencyFrom" value="100" class="currency-input" />
                    <select id="currencyFromSelect" class="currency-select-small">
                        <option value="USD">USD</option>
                        <option value="EUR">EUR</option>
                        <option value="GBP">GBP</option>
                        <option value="JPY">JPY</option>
                    </select>
                </div>
                <div class="currency-arrow">↓</div>
                <div class="currency-row">
                    <input type="number" id="currencyTo" value="92" readonly class="currency-input" />
                    <select id="currencyToSelect" class="currency-select-small">
                        <option value="EUR">EUR</option>
                        <option value="USD">USD</option>
                        <option value="GBP">GBP</option>
                        <option value="JPY">JPY</option>
                    </select>
                </div>
                <button onclick="convertCurrency()" class="convert-btn-small">Convert</button>
                </div>
            </div>
        </div>

        <!-- Stock Market Widget -->
        <div class="compact-widget" id="stockWidget">
            <div class="widget-header">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <button class="widget-collapse-btn" onclick="toggleWidget('stockWidget')" title="Collapse/Expand">▼</button>
                <span class="widget-title">📈 Stocks</span>
                </div>
                <span class="widget-live">🔴 LIVE</span>
            </div>
            <div class="widget-content">
            <div class="stocks-list">
                <div class="stock-item">
                    <span class="stock-symbol">TSLA</span>
                        <span class="stock-price" id="stockTSLA">$236.24</span>
                        <span class="stock-change negative" id="changeTSLA">▼ -0.34%</span>
                </div>
                <div class="stock-item">
                    <span class="stock-symbol">NVDA</span>
                        <span class="stock-price" id="stockNVDA">$850.27</span>
                        <span class="stock-change positive" id="changeNVDA">▲ +0.03%</span>
                </div>
                <div class="stock-item">
                    <span class="stock-symbol">GOOGL</span>
                        <span class="stock-price" id="stockGOOGL">$139.91</span>
                        <span class="stock-change positive" id="changeGOOGL">▲ +0.35%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Initialize Widgets -->
    <script>
        // Toggle widget collapse/expand
        function toggleWidget(widgetId) {
            const widget = document.getElementById(widgetId);
            const button = widget.querySelector('.widget-collapse-btn');
            
            if (widget.classList.contains('collapsed')) {
                widget.classList.remove('collapsed');
                button.classList.remove('collapsed');
                button.textContent = '▼';
            } else {
                widget.classList.add('collapsed');
                button.classList.add('collapsed');
                button.textContent = '▶';
            }
            
            // Save widget state to localStorage
            saveWidgetStates();
        }
        
        // Save all widget states to localStorage
        function saveWidgetStates() {
            const widgetIds = ['weatherWidget', 'clockWidget', 'newsWidget', 'currencyWidget', 'stockWidget'];
            const states = {};
            
            widgetIds.forEach(widgetId => {
                const widget = document.getElementById(widgetId);
                states[widgetId] = widget.classList.contains('collapsed') ? 'collapsed' : 'expanded';
            });
            
            localStorage.setItem('widgetsState', JSON.stringify(states));
        }

        // Update clock every second
        function updateClock() {
            const now = new Date();
            const timezone = document.getElementById('clockCitySelect').value;
            const timeString = now.toLocaleTimeString('en-GB', {
                timeZone: timezone,
                hour12: false,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('currentTime').textContent = timeString;
            
            // Update timezone display
            const offset = getTimezoneOffset(timezone);
            document.getElementById('currentTimezone').textContent = offset;
        }
        
        // Get timezone offset string
        function getTimezoneOffset(timezone) {
            const now = new Date();
            const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
            const localTime = new Date(utc + (3600000 * getOffsetHours(timezone)));
            const offset = getOffsetHours(timezone);
            const sign = offset >= 0 ? '+' : '';
            const hours = Math.floor(Math.abs(offset));
            const minutes = Math.abs((offset % 1) * 60);
            return `GMT${sign}${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
        }
        
        function getOffsetHours(timezone) {
            const offsets = {
                'America/New_York': -5,
                'Europe/London': 1,
                'Asia/Tokyo': 9,
                'Australia/Sydney': 11
            };
            return offsets[timezone] || 0;
        }

        // Update weather (simulated)
        function updateWeather() {
            // In a real implementation, this would fetch from a weather API
            // For now, we'll keep the static values
            console.log('Weather updated');
        }

        // Widget data
        const weatherDataByCity = [
            { city: 'New York, US', temp: 22, condition: 'Partly Cloudy', humidity: 65, wind: 12, icon: '⛅' },
            { city: 'London, UK', temp: 15, condition: 'Rainy', humidity: 80, wind: 20, icon: '🌧️' },
            { city: 'Tokyo, Japan', temp: 18, condition: 'Clear', humidity: 55, wind: 8, icon: '☀️' },
            { city: 'Sydney, Australia', temp: 25, condition: 'Sunny', humidity: 60, wind: 15, icon: '☀️' }
        ];

        const newsDatabase = [
            { title: 'AI Navigation Breakthrough in VNC', source: 'Tech News', time: '2h ago', category: 'Tech' },
            { title: 'Waymo Self-Driving Service Expands', source: 'Auto News', time: '4h ago', category: 'Auto' },
            { title: 'New Robotics Standards Released by IEEE', source: 'IEEE', time: '6h ago', category: 'Research' },
            { title: 'Stock Markets Reach New Highs', source: 'Finance', time: '1h ago', category: 'Finance' },
            { title: 'NAVΛ Studio Platform Launches', source: 'Dev News', time: '30m ago', category: 'Tech' }
        ];

        const currencyRates = {
            USD: 1.0,
            EUR: 0.92,
            GBP: 0.79,
            JPY: 149.50,
            CNY: 7.24
        };

        // Change weather city
        function changeWeatherCity() {
            const select = document.getElementById('weatherCitySelect');
            const cityIndex = parseInt(select.value);
            const weather = weatherDataByCity[cityIndex];
            
            document.getElementById('weatherTemp').textContent = weather.temp + '°C';
            document.getElementById('weatherCondition').textContent = weather.condition;
            document.getElementById('weatherHumidity').textContent = `Humidity: ${weather.humidity}%`;
            document.getElementById('weatherWind').textContent = `Wind: ${weather.wind} km/h`;
        }

        // Change clock city
        function changeClockCity() {
            // Clock updates automatically via updateTimeDate function
            console.log('Clock city changed');
        }

        // Refresh news feed
        function refreshNews() {
            const newsItems = document.querySelectorAll('.news-item');
            // Rotate news items
            const randomNews = newsDatabase[Math.floor(Math.random() * newsDatabase.length)];
            if (newsItems[0]) {
                newsItems[0].querySelector('.news-title').textContent = randomNews.title;
                newsItems[0].querySelector('.news-category').textContent = randomNews.category;
                newsItems[0].querySelector('.news-time').textContent = randomNews.time;
            }
            console.log('News refreshed!');
        }

        // Convert currency
        function convertCurrency() {
            const fromAmount = parseFloat(document.getElementById('currencyFrom').value) || 0;
            const fromCurr = document.getElementById('currencyFromSelect').value;
            const toCurr = document.getElementById('currencyToSelect').value;
            
            const fromRate = currencyRates[fromCurr] || 1;
            const toRate = currencyRates[toCurr] || 1;
            
            // Convert through USD
            const result = (fromAmount / fromRate) * toRate;
            document.getElementById('currencyTo').value = result.toFixed(2);
        }

        // Update stock prices (simulated live data)
        function updateStocks() {
            // TSLA
            const tslaPrice = parseFloat(document.getElementById('stockTSLA').textContent.replace('$', ''));
            const tslaChange = (Math.random() - 0.5) * 2;
            const newTslaPrice = tslaPrice + tslaChange;
            const tslaPercent = (tslaChange / tslaPrice) * 100;
            
            document.getElementById('stockTSLA').textContent = `$${newTslaPrice.toFixed(2)}`;
            document.getElementById('changeTSLA').innerHTML = tslaChange > 0 ? 
                `▲ +${tslaPercent.toFixed(2)}%` : `▼ ${tslaPercent.toFixed(2)}%`;
            document.getElementById('changeTSLA').className = tslaChange > 0 ? 'stock-change positive' : 'stock-change negative';
            
            // NVDA
            const nvdaPrice = parseFloat(document.getElementById('stockNVDA').textContent.replace('$', ''));
            const nvdaChange = (Math.random() - 0.5) * 5;
            const newNvdaPrice = nvdaPrice + nvdaChange;
            const nvdaPercent = (nvdaChange / nvdaPrice) * 100;
            
            document.getElementById('stockNVDA').textContent = `$${newNvdaPrice.toFixed(2)}`;
            document.getElementById('changeNVDA').innerHTML = nvdaChange > 0 ? 
                `▲ +${nvdaPercent.toFixed(2)}%` : `▼ ${nvdaPercent.toFixed(2)}%`;
            document.getElementById('changeNVDA').className = nvdaChange > 0 ? 'stock-change positive' : 'stock-change negative';
            
            // GOOGL
            const googlPrice = parseFloat(document.getElementById('stockGOOGL').textContent.replace('$', ''));
            const googlChange = (Math.random() - 0.5) * 1.5;
            const newGooglPrice = googlPrice + googlChange;
            const googlPercent = (googlChange / googlPrice) * 100;
            
            document.getElementById('stockGOOGL').textContent = `$${newGooglPrice.toFixed(2)}`;
            document.getElementById('changeGOOGL').innerHTML = googlChange > 0 ? 
                `▲ +${googlPercent.toFixed(2)}%` : `▼ ${googlPercent.toFixed(2)}%`;
            document.getElementById('changeGOOGL').className = googlChange > 0 ? 'stock-change positive' : 'stock-change negative';
        }

        // Clock mode state
        let clockMode = 'digital'; // 'digital' or 'analog'
        let currentLocation = 'us'; // 'us' or 'uk'

        // Detect location from timezone (simplified)
        function detectLocation() {
            const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
            if (tz.includes('London') || tz.includes('Europe')) {
                currentLocation = 'uk';
                document.getElementById('languageBtn').innerHTML = '🇬🇧 EN';
            } else {
                currentLocation = 'us';
                document.getElementById('languageBtn').innerHTML = '🇺🇸 EN';
            }
        }

        // Toggle between digital and analog clock
        function toggleClockMode() {
            const digitalClock = document.getElementById('time');
            const analogClock = document.getElementById('analogClock');
            
            if (clockMode === 'digital') {
                clockMode = 'analog';
                digitalClock.style.display = 'none';
                analogClock.style.display = 'block';
            } else {
                clockMode = 'digital';
                digitalClock.style.display = 'block';
                analogClock.style.display = 'none';
            }
        }

        // Draw analog clock
        function drawAnalogClock() {
            const canvas = document.getElementById('analogClock');
            if (!canvas || clockMode !== 'analog') return;
            
            const ctx = canvas.getContext('2d');
            const now = new Date();
            const hours = now.getHours() % 12;
            const minutes = now.getMinutes();
            const seconds = now.getSeconds();
            
            // Clear canvas
            ctx.clearRect(0, 0, 80, 80);
            
            // Draw clock face
            ctx.beginPath();
            ctx.arc(40, 40, 35, 0, 2 * Math.PI);
            ctx.strokeStyle = '#00ff00';
            ctx.lineWidth = 2;
            ctx.shadowBlur = 10;
            ctx.shadowColor = 'rgba(0, 255, 0, 0.6)';
            ctx.stroke();
            ctx.shadowBlur = 0;
            
            // Hour marks
            for (let i = 0; i < 12; i++) {
                const angle = (i * 30 - 90) * Math.PI / 180;
                const x1 = 40 + Math.cos(angle) * 30;
                const y1 = 40 + Math.sin(angle) * 30;
                const x2 = 40 + Math.cos(angle) * 32;
                const y2 = 40 + Math.sin(angle) * 32;
                
                ctx.beginPath();
                ctx.moveTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.strokeStyle = '#00ff00';
                ctx.lineWidth = i % 3 === 0 ? 2 : 1;
                ctx.stroke();
            }
            
            // Hour hand
            const hourAngle = ((hours + minutes / 60) * 30 - 90) * Math.PI / 180;
            ctx.beginPath();
            ctx.moveTo(40, 40);
            ctx.lineTo(40 + Math.cos(hourAngle) * 18, 40 + Math.sin(hourAngle) * 18);
            ctx.strokeStyle = '#00ff00';
            ctx.lineWidth = 3;
            ctx.stroke();
            
            // Minute hand
            const minuteAngle = ((minutes + seconds / 60) * 6 - 90) * Math.PI / 180;
            ctx.beginPath();
            ctx.moveTo(40, 40);
            ctx.lineTo(40 + Math.cos(minuteAngle) * 25, 40 + Math.sin(minuteAngle) * 25);
            ctx.strokeStyle = '#00ff00';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // Second hand
            const secondAngle = (seconds * 6 - 90) * Math.PI / 180;
            ctx.beginPath();
            ctx.moveTo(40, 40);
            ctx.lineTo(40 + Math.cos(secondAngle) * 28, 40 + Math.sin(secondAngle) * 28);
            ctx.strokeStyle = '#00ff00';
            ctx.lineWidth = 1;
            ctx.stroke();
            
            // Center dot
            ctx.beginPath();
            ctx.arc(40, 40, 3, 0, 2 * Math.PI);
            ctx.fillStyle = '#00ff00';
            ctx.fill();
        }

        // Update time and date displays
        function updateTimeDate() {
            const now = new Date();
            
            // Update digital clock in bottom bar (24-hour format)
            const timeString = now.toLocaleTimeString('en-US', {
                hour12: false,
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('time').textContent = timeString;
            
            // Update world clock widget with selected timezone
            const select = document.getElementById('clockCitySelect');
            const timezone = select ? select.value : 'Europe/London';
            
            const worldTimeString = now.toLocaleTimeString('en-US', {
                timeZone: timezone,
                hour12: false,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            
            const timeElement = document.getElementById('currentTime');
            if (timeElement) {
                timeElement.textContent = worldTimeString;
            }
            
            // Update timezone display
            const timezoneElement = document.getElementById('currentTimezone');
            if (timezoneElement) {
                const offset = -now.getTimezoneOffset() / 60;
                const sign = offset >= 0 ? '+' : '-';
                const hours = Math.abs(offset).toString().padStart(2, '0');
                timezoneElement.textContent = `GMT${sign}${hours}:00`;
            }
            
            // Update date based on location
            let dateString;
            if (currentLocation === 'uk') {
                // DD/MM/YYYY for UK
                const day = String(now.getDate()).padStart(2, '0');
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const year = now.getFullYear();
                dateString = `${day}/${month}/${year}`;
            } else {
                // MM/DD/YYYY for US
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const year = now.getFullYear();
                dateString = `${month}/${day}/${year}`;
            }
            document.getElementById('date').textContent = dateString;
            
            // Draw analog clock if in analog mode
            if (clockMode === 'analog') {
                drawAnalogClock();
            }
        }

        // Power button state management
        let powerState = 'standby'; // 'off', 'on', 'standby'

        function updatePowerButton() {
            const powerBtn = document.getElementById('powerBtn');
            if (!powerBtn) return;
            
            switch(powerState) {
                case 'on':
                    powerBtn.style.color = '#00ff00';
                    powerBtn.style.textShadow = '0 0 10px rgba(0, 255, 0, 0.8)';
                    powerBtn.title = 'Power: ON';
                    break;
                case 'off':
                    powerBtn.style.color = '#ff0000';
                    powerBtn.style.textShadow = '0 0 10px rgba(255, 0, 0, 0.8)';
                    powerBtn.title = 'Power: OFF';
                    break;
                case 'standby':
                    powerBtn.style.color = 'white';
                    powerBtn.style.textShadow = '0 0 10px rgba(255, 255, 255, 0.5)';
                    powerBtn.title = 'Power: Standby';
                    break;
            }
        }

        // ========== SHOWCASE SCREEN FUNCTIONS ==========
        
        let cameraStream = null;
        let mediaRecorder = null;
        let recordedChunks = [];
        let isRecording = false;
        let currentShowcaseMode = 'blueprint';

        // Switch Showcase Mode
        function switchShowcaseMode(mode) {
            // Hide all content displays
            document.querySelectorAll('.content-display').forEach(display => {
                display.classList.remove('active');
            });
            
            // Show selected mode
            const modeMap = {
                'blueprint': 'blueprintMode',
                'livead': 'liveadMode',
                'youtube': 'youtubeMode',
                'twitch': 'twitchMode',
                'video': 'videoMode',
                'image': 'imageMode',
                'web': 'webMode',
                'slides': 'slidesMode'
            };
            
            const targetDisplay = document.getElementById(modeMap[mode]);
            if (targetDisplay) {
                targetDisplay.classList.add('active');
            }
            
            // Update mode button states
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            currentShowcaseMode = mode;
            console.log(`✅ Switched to ${mode} mode`);
        }

        // Extract YouTube Video ID from URL
        function extractYouTubeID(url) {
            // Handle various YouTube URL formats
            const patterns = [
                /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\?\/]+)/,
                /^([a-zA-Z0-9_-]{11})$/ // Direct video ID
            ];
            
            for (const pattern of patterns) {
                const match = url.match(pattern);
                if (match) return match[1];
            }
            return null;
        }

        // Load YouTube Video
        function loadYouTubeVideo() {
            const input = document.getElementById('youtubeInput').value.trim();
            const player = document.getElementById('youtubePlayer');
            
            if (!input) {
                alert('Please enter a YouTube URL or video ID');
                return;
            }
            
            const videoId = extractYouTubeID(input);
            
            if (!videoId) {
                alert('Invalid YouTube URL or video ID');
                return;
            }
            
            // Create YouTube embed iframe
            player.innerHTML = `
                <iframe 
                    width="100%" 
                    height="100%" 
                    src="https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen
                    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
                </iframe>
            `;
            
            console.log(`✅ Loaded YouTube video: ${videoId}`);
        }

        // Load Twitch Stream
        function loadTwitchStream() {
            const input = document.getElementById('twitchInput').value.trim();
            const player = document.getElementById('twitchPlayer');
            
            if (!input) {
                alert('Please enter a Twitch channel name');
                return;
            }
            
            // Clean channel name (remove @ if present)
            const channel = input.replace('@', '').toLowerCase();
            
            // Handle parent domain for Twitch embed
            const hostname = window.location.hostname;
            const parent = hostname === 'localhost' || hostname === '127.0.0.1' ? 'localhost' : hostname;
            
            // Create Twitch embed iframe
            player.innerHTML = `
                <iframe 
                    src="https://player.twitch.tv/?channel=${channel}&parent=${parent}&autoplay=true&muted=false" 
                    height="100%" 
                    width="100%" 
                    allowfullscreen
                    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
                </iframe>
            `;
            
            console.log(`✅ Loaded Twitch stream: ${channel} (parent: ${parent})`);
        }

        // Add Enter key support for inputs
        document.addEventListener('DOMContentLoaded', () => {
            const youtubeInput = document.getElementById('youtubeInput');
            const twitchInput = document.getElementById('twitchInput');
            
            if (youtubeInput) {
                youtubeInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') loadYouTubeVideo();
                });
            }
            
            if (twitchInput) {
                twitchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') loadTwitchStream();
                });
            }
        });

        // Toggle Camera
        async function toggleCamera() {
            const pipCamera = document.getElementById('pipCamera');
            const cameraVideo = document.getElementById('cameraStream');
            const placeholder = document.getElementById('cameraPlaceholder');
            const cameraBtn = document.getElementById('cameraBtn');
            
            if (!cameraStream) {
                try {
                    // Request camera access
                    cameraStream = await navigator.mediaDevices.getUserMedia({ 
                        video: { width: 1280, height: 720 }, 
                        audio: true 
                    });
                    
                    cameraVideo.srcObject = cameraStream;
                    placeholder.style.display = 'none';
                    pipCamera.classList.add('active');
                    cameraBtn.style.background = 'rgba(34, 197, 94, 0.3)';
                    cameraBtn.style.borderColor = 'rgba(34, 197, 94, 0.6)';
                    
                    console.log('✅ Camera activated');
                } catch (error) {
                    console.error('❌ Camera access denied:', error);
                    alert('Camera access denied. Please allow camera permissions.');
                }
            } else {
                // Stop camera
                cameraStream.getTracks().forEach(track => track.stop());
                cameraStream = null;
                cameraVideo.srcObject = null;
                placeholder.style.display = 'flex';
                pipCamera.classList.remove('active');
                cameraBtn.style.background = '';
                cameraBtn.style.borderColor = '';
                
                console.log('📹 Camera deactivated');
            }
        }

        // Close PiP Camera
        function closePiPCamera() {
            if (cameraStream) {
                cameraStream.getTracks().forEach(track => track.stop());
                cameraStream = null;
            }
            const pipCamera = document.getElementById('pipCamera');
            const cameraVideo = document.getElementById('cameraStream');
            const placeholder = document.getElementById('cameraPlaceholder');
            const cameraBtn = document.getElementById('cameraBtn');
            
            cameraVideo.srcObject = null;
            placeholder.style.display = 'flex';
            pipCamera.classList.remove('active');
            cameraBtn.style.background = '';
            cameraBtn.style.borderColor = '';
        }

        // Toggle Recording
        async function toggleRecording() {
            const recordBtn = document.getElementById('recordBtn');
            const recordIcon = document.getElementById('recordIcon');
            const recordText = document.getElementById('recordText');
            
            if (!isRecording) {
                try {
                    // Start recording
                    const showcaseContent = document.querySelector('.showcase-content');
                    const displayStream = await navigator.mediaDevices.getDisplayMedia({
                        video: { mediaSource: 'screen' }
                    });
                    
                    // Combine with camera audio if available
                    let tracks = [...displayStream.getTracks()];
                    if (cameraStream) {
                        const audioTrack = cameraStream.getAudioTracks()[0];
                        if (audioTrack) tracks.push(audioTrack);
                    }
                    
                    const combinedStream = new MediaStream(tracks);
                    mediaRecorder = new MediaRecorder(combinedStream, {
                        mimeType: 'video/webm;codecs=vp9'
                    });
                    
                    recordedChunks = [];
                    
                    mediaRecorder.ondataavailable = (event) => {
                        if (event.data.size > 0) {
                            recordedChunks.push(event.data);
                        }
                    };
                    
                    mediaRecorder.onstop = () => {
                        const blob = new Blob(recordedChunks, { type: 'video/webm' });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `showcase-recording-${Date.now()}.webm`;
                        a.click();
                        console.log('✅ Recording saved');
                    };
                    
                    mediaRecorder.start();
                    isRecording = true;
                    
                    recordBtn.classList.add('recording');
                    recordIcon.textContent = '⏹';
                    recordText.textContent = 'Stop';
                    
                    console.log('🎬 Recording started');
                } catch (error) {
                    console.error('❌ Recording failed:', error);
                    alert('Could not start recording. Please try again.');
                }
            } else {
                // Stop recording
                if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                    mediaRecorder.stop();
                    mediaRecorder.stream.getTracks().forEach(track => track.stop());
                }
                
                isRecording = false;
                recordBtn.classList.remove('recording');
                recordIcon.textContent = '⏺';
                recordText.textContent = 'Record';
                
                console.log('⏹ Recording stopped');
            }
        }

        // Toggle Fullscreen
        function toggleFullscreen() {
            const monitor = document.querySelector('.center-monitor');
            
            if (!document.fullscreenElement) {
                monitor.requestFullscreen().catch(err => {
                    console.error('❌ Fullscreen failed:', err);
                });
            } else {
                document.exitFullscreen();
            }
        }

        // Load content into showcase screen
        function loadShowcaseContent(type, source) {
            switch(type) {
                case 'video':
                    switchShowcaseMode('video');
                    document.getElementById('showcaseVideo').src = source;
                    break;
                case 'image':
                    switchShowcaseMode('image');
                    document.getElementById('showcaseImage').src = source;
                    break;
                case 'web':
                    switchShowcaseMode('web');
                    document.getElementById('showcaseWeb').src = source;
                    break;
            }
        }

        // Example usage functions (can be called from console)
        window.showcaseDemo = {
            loadVideo: (url) => loadShowcaseContent('video', url),
            loadImage: (url) => loadShowcaseContent('image', url),
            loadWeb: (url) => loadShowcaseContent('web', url),
            playLiveAd: () => {
                const modeButtons = document.querySelectorAll('.mode-btn');
                modeButtons.forEach(btn => {
                    if (btn.textContent.includes('Live Ad')) {
                        btn.click();
                    }
                });
            },
            loadYouTube: (urlOrId) => {
                switchShowcaseMode('youtube');
                document.getElementById('youtubeInput').value = urlOrId;
                loadYouTubeVideo();
            },
            loadTwitch: (channel) => {
                switchShowcaseMode('twitch');
                document.getElementById('twitchInput').value = channel;
                loadTwitchStream();
            },
            enableCamera: () => toggleCamera(),
            startRecording: () => toggleRecording()
        };

        // Quick load popular demo videos
        window.showcasePresets = {
            liveAd: () => showcaseDemo.playLiveAd(),
            techDemo: () => showcaseDemo.loadYouTube('dQw4w9WgXcQ'),
            nasa: () => showcaseDemo.loadYouTube('21X5lGlDOfg'),
            robotics: () => showcaseDemo.loadYouTube('fn3KWM1kuAw')
        };

        // ========== END SHOWCASE SCREEN FUNCTIONS ==========

        // ========== DRAGGABLE ELEMENTS SYSTEM ==========

        const draggableElements = {};

        function initDraggableElement(elementId) {
            const element = document.getElementById(elementId);
            if (!element) return;

            // Get initial position from element's current location
            const rect = element.getBoundingClientRect();

            // Initialize tracking for this element
            draggableElements[elementId] = {
                element: element,
                isDragging: false,
                currentX: rect.left,
                currentY: rect.top,
                initialX: 0,
                initialY: 0,
                xOffset: rect.left,
                yOffset: rect.top
            };

            // Load saved position from localStorage
            const savedPosition = localStorage.getItem(`${elementId}Position`);
            if (savedPosition) {
                const { x, y } = JSON.parse(savedPosition);
                draggableElements[elementId].xOffset = x;
                draggableElements[elementId].yOffset = y;
                draggableElements[elementId].currentX = x;
                draggableElements[elementId].currentY = y;
                setElementPosition(elementId, x, y);
            } else {
                // Set initial absolute position from current computed position
                element.style.left = `${rect.left}px`;
                element.style.top = `${rect.top}px`;
                element.style.right = 'auto';
                element.style.bottom = 'auto';
            }

            // Mouse events
            element.addEventListener('mousedown', (e) => dragStart(e, elementId));

            // Touch events for mobile
            element.addEventListener('touchstart', (e) => dragStart(e, elementId));

            // Double-click to reset position
            element.addEventListener('dblclick', () => resetElementPosition(elementId));
        }

        function dragStart(e, elementId) {
            const dragData = draggableElements[elementId];
            if (!dragData) return;

            // Only drag if clicking on the element itself, not inputs/buttons
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'BUTTON') {
                return;
            }

            // Get the element's current position
            const rect = dragData.element.getBoundingClientRect();
            
            if (e.type === 'touchstart') {
                dragData.initialX = e.touches[0].clientX - rect.left;
                dragData.initialY = e.touches[0].clientY - rect.top;
            } else {
                dragData.initialX = e.clientX - rect.left;
                dragData.initialY = e.clientY - rect.top;
            }

            dragData.isDragging = true;
            dragData.element.classList.add('dragging');
        }

        function drag(e) {
            // Check which element is being dragged
            for (const [elementId, dragData] of Object.entries(draggableElements)) {
                if (dragData.isDragging) {
                    e.preventDefault();

                    let clientX, clientY;
                    
                    if (e.type === 'touchmove') {
                        clientX = e.touches[0].clientX;
                        clientY = e.touches[0].clientY;
                    } else {
                        clientX = e.clientX;
                        clientY = e.clientY;
                    }

                    // Calculate new position with precise cursor tracking
                    dragData.currentX = clientX - dragData.initialX;
                    dragData.currentY = clientY - dragData.initialY;

                    setElementPosition(elementId, dragData.currentX, dragData.currentY);
                }
            }
        }

        function dragEnd(e) {
            // Check which element stopped being dragged
            for (const [elementId, dragData] of Object.entries(draggableElements)) {
                if (dragData.isDragging) {
                    dragData.initialX = dragData.currentX;
                    dragData.initialY = dragData.currentY;
                    dragData.isDragging = false;
                    dragData.element.classList.remove('dragging');

                    // Save position to localStorage
                    localStorage.setItem(`${elementId}Position`, JSON.stringify({
                        x: dragData.xOffset,
                        y: dragData.yOffset
                    }));

                    console.log(`✅ ${elementId} position saved: (${Math.round(dragData.xOffset)}, ${Math.round(dragData.yOffset)})`);
                }
            }
        }

        function setElementPosition(elementId, xPos, yPos) {
            const dragData = draggableElements[elementId];
            if (!dragData) return;

            const el = dragData.element;
            
            // Use absolute positioning for precise control
            el.style.left = `${xPos}px`;
            el.style.top = `${yPos}px`;
            el.style.right = 'auto';
            el.style.bottom = 'auto';
            el.style.transform = 'none';
            
            // Save current position
            dragData.xOffset = xPos;
            dragData.yOffset = yPos;
        }
        
        function setElementTranslate(elementId, xPos, yPos) {
            // Kept for compatibility with initialization
            setElementPosition(elementId, xPos, yPos);
        }

        function resetElementPosition(elementId) {
            const dragData = draggableElements[elementId];
            if (!dragData) return;
            
            const el = dragData.element;
            
            // Reset to default CSS positions and let browser calculate
            if (el.classList.contains('branding-logo')) {
                el.style.top = '8rem';
                el.style.right = '3rem';
                el.style.bottom = 'auto';
                el.style.left = 'auto';
            } else if (el.classList.contains('branding-tagline')) {
                el.style.bottom = '10rem';
                el.style.right = '3rem';
                el.style.top = 'auto';
                el.style.left = 'auto';
            }
            
            el.style.transform = '';
            
            // Force a reflow to get the new position
            el.offsetHeight;
            
            // Update tracking with new position
            const rect = el.getBoundingClientRect();
            dragData.xOffset = rect.left;
            dragData.yOffset = rect.top;
            dragData.currentX = rect.left;
            dragData.currentY = rect.top;
            
            localStorage.removeItem(`${elementId}Position`);
            console.log(`✅ ${elementId} position reset to default`);
        }

        function initAllDraggables() {
            // Initialize all draggable elements
            initDraggableElement('instituteLogo');
            initDraggableElement('careerTagline');

            // Global mouse/touch move and end events
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', dragEnd);
            document.addEventListener('touchmove', drag);
            document.addEventListener('touchend', dragEnd);
        }

        // Make reset function globally accessible
        window.resetElementPosition = resetElementPosition;

        // ========== END DRAGGABLE ELEMENTS SYSTEM ==========

        // ========== MAGNIFYING DOCK EFFECT ==========
        
        function initMagnifyingDock() {
            const iconBar = document.querySelector('.bottom-icon-bar');
            const icons = Array.from(document.querySelectorAll('.bottom-icon'));
            
            if (!iconBar || icons.length === 0) return;
            
            let currentHoveredIndex = -1;
            let animationFrame = null;
            
            // Smooth magnification with requestAnimationFrame
            function smoothApplyMagnification(index) {
                if (animationFrame) {
                    cancelAnimationFrame(animationFrame);
                }
                
                animationFrame = requestAnimationFrame(() => {
                    applyMagnification(icons, index);
                    currentHoveredIndex = index;
                });
            }
            
            // Add mouseenter event to each icon
            icons.forEach((icon, index) => {
                icon.addEventListener('mouseenter', () => {
                    smoothApplyMagnification(index);
                });
                
                icon.addEventListener('mouseleave', () => {
                    // Delay reset slightly for smoother transition
                    setTimeout(() => {
                        if (currentHoveredIndex === index) {
                            resetMagnification(icons);
                            currentHoveredIndex = -1;
                        }
                    }, 50);
                });
            });
            
            // Reset magnification when mouse leaves the icon bar
            iconBar.addEventListener('mouseleave', () => {
                resetMagnification(icons);
                currentHoveredIndex = -1;
            });
            
            console.log('🔍 Ultra-smooth magnifying dock initialized!');
        }
        
        function applyMagnification(icons, hoveredIndex) {
            icons.forEach((icon, index) => {
                // Remove all neighbor classes first
                icon.classList.remove('neighbor-1', 'neighbor-2', 'neighbor-3');
                
                // Calculate distance from hovered icon
                const distance = Math.abs(index - hoveredIndex);
                
                // Apply neighbor classes based on distance (3 levels for ultra-smooth cascade)
                if (distance === 1) {
                    icon.classList.add('neighbor-1');
                } else if (distance === 2) {
                    icon.classList.add('neighbor-2');
                } else if (distance === 3) {
                    icon.classList.add('neighbor-3');
                }
            });
        }
        
        function resetMagnification(icons) {
            requestAnimationFrame(() => {
                icons.forEach(icon => {
                    icon.classList.remove('neighbor-1', 'neighbor-2', 'neighbor-3');
                });
            });
        }
        
        // ========== END MAGNIFYING DOCK EFFECT ==========

        // ========== SIDEBAR TOGGLE ==========
        
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const isCollapsed = sidebar.classList.toggle('collapsed');
            
            // Save state to localStorage
            localStorage.setItem('sidebarCollapsed', isCollapsed);
            
            console.log(isCollapsed ? '📁 Sidebar collapsed' : '📂 Sidebar expanded');
        }
        
        function initSidebar() {
            // Restore sidebar state from localStorage
            const isCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
            if (isCollapsed) {
                document.querySelector('.sidebar').classList.add('collapsed');
            }
        }
        
        // Keyboard shortcut: Ctrl/Cmd + B to toggle sidebar
        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
                e.preventDefault();
                toggleSidebar();
            }
            
            // Ctrl/Cmd + ⌘ + Q to lock screen
            if (e.ctrlKey && e.metaKey && e.key === 'q') {
                e.preventDefault();
                systemLock();
            }
            
            // Cmd/Ctrl + A to open applications
            if ((e.ctrlKey || e.metaKey) && e.key === 'a' && !e.shiftKey) {
                e.preventDefault();
                openAppLauncher();
            }
        });
        
        // ========== END SIDEBAR TOGGLE ==========

        // ========== DESKTOP OS SYSTEM ==========
        
        let desktopItems = [];
        let trashItems = [];
        let draggedItem = null;
        let newItemType = 'folder';
        
        // Initialize Desktop with some default items
        function initDesktop() {
            // Load from localStorage or create defaults
            const saved = localStorage.getItem('desktopItems');
            if (saved) {
                desktopItems = JSON.parse(saved);
            } else {
                // Create default folders with initial positions
                desktopItems = [
                    { id: 1, type: 'folder', name: 'My Projects', icon: '📁', x: 20, y: 20 },
                    { id: 2, type: 'folder', name: 'Documents', icon: '📂', x: 20, y: 150 },
                    { id: 3, type: 'folder', name: 'AI Models', icon: '🤖', x: 20, y: 280 },
                    { id: 4, type: 'file', name: 'README.md', icon: '📄', x: 20, y: 410 }
                ];
            }
            
            // Load trash
            const savedTrash = localStorage.getItem('trashItems');
            if (savedTrash) {
                trashItems = JSON.parse(savedTrash);
                updateTrashCount();
            }
            
            renderDesktop();
        }
        
        let dragOffset = { x: 0, y: 0 };
        
        function renderDesktop() {
            const desktopArea = document.getElementById('desktopArea');
            desktopArea.innerHTML = '';
            
            desktopItems.forEach(item => {
                const iconEl = document.createElement('div');
                iconEl.className = 'desktop-icon';
                iconEl.setAttribute('draggable', 'true');
                iconEl.setAttribute('data-id', item.id);
                iconEl.style.left = (item.x || 20) + 'px';
                iconEl.style.top = (item.y || 20) + 'px';
                iconEl.innerHTML = `
                    <div class="icon-image">${item.icon}</div>
                    <div class="icon-label">${item.name}</div>
                `;
                
                // Event listeners
                iconEl.addEventListener('click', () => selectIcon(iconEl));
                iconEl.addEventListener('dblclick', () => openItem(item));
                iconEl.addEventListener('contextmenu', (e) => showItemContextMenu(e, item));
                iconEl.addEventListener('dragstart', (e) => handleIconDragStart(e, item, iconEl));
                iconEl.addEventListener('drag', (e) => handleIconDrag(e, item, iconEl));
                iconEl.addEventListener('dragend', (e) => handleIconDragEnd(e, item, iconEl));
                
                desktopArea.appendChild(iconEl);
            });
            
            saveDesktop();
        }
        
        function selectIcon(iconEl) {
            document.querySelectorAll('.desktop-icon').forEach(el => el.classList.remove('selected'));
            iconEl.classList.add('selected');
        }
        
        function openItem(item) {
            console.log(`📂 Opening: ${item.name}`);
            // Placeholder for opening files/folders
            alert(`Opening ${item.type}: ${item.name}`);
        }
        
        // Drag and Drop for Desktop Icons with free positioning
        function handleIconDragStart(e, item, iconEl) {
            draggedItem = item;
            iconEl.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            
            // Calculate offset from mouse to icon top-left
            const rect = iconEl.getBoundingClientRect();
            const desktopRect = document.getElementById('desktopArea').getBoundingClientRect();
            dragOffset.x = e.clientX - rect.left;
            dragOffset.y = e.clientY - rect.top;
        }
        
        function handleIconDrag(e, item, iconEl) {
            if (e.clientX === 0 && e.clientY === 0) return; // Ignore final drag event
            
            const desktopArea = document.getElementById('desktopArea');
            const desktopRect = desktopArea.getBoundingClientRect();
            
            // Calculate new position relative to desktop area
            let newX = e.clientX - desktopRect.left - dragOffset.x;
            let newY = e.clientY - desktopRect.top - dragOffset.y;
            
            // Constrain to desktop bounds
            newX = Math.max(0, Math.min(newX, desktopRect.width - 90));
            newY = Math.max(0, Math.min(newY, desktopRect.height - 100));
            
            // Update position visually during drag
            if (e.clientX > 0 && e.clientY > 0) {
                iconEl.style.left = newX + 'px';
                iconEl.style.top = newY + 'px';
            }
        }
        
        function handleIconDragEnd(e, item, iconEl) {
            iconEl.classList.remove('dragging');
            
            const desktopArea = document.getElementById('desktopArea');
            const desktopRect = desktopArea.getBoundingClientRect();
            
            // Calculate final position
            let finalX = e.clientX - desktopRect.left - dragOffset.x;
            let finalY = e.clientY - desktopRect.top - dragOffset.y;
            
            // Constrain to desktop bounds
            finalX = Math.max(0, Math.min(finalX, desktopRect.width - 90));
            finalY = Math.max(0, Math.min(finalY, desktopRect.height - 100));
            
            // Update item position in data
            const itemIndex = desktopItems.findIndex(i => i.id === item.id);
            if (itemIndex !== -1) {
                desktopItems[itemIndex].x = finalX;
                desktopItems[itemIndex].y = finalY;
                saveDesktop();
                console.log(`📍 ${item.name} moved to (${Math.round(finalX)}, ${Math.round(finalY)})`);
            }
        }
        
        // Trash Bin Functions (now in dock)
        function handleTrashDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            const dockTrash = document.getElementById('dockTrash');
            if (dockTrash) {
                dockTrash.classList.add('drag-over');
            }
        }
        
        function handleTrashDragLeave(e) {
            const dockTrash = document.getElementById('dockTrash');
            if (dockTrash) {
                dockTrash.classList.remove('drag-over');
            }
        }
        
        function handleTrashDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            const dockTrash = document.getElementById('dockTrash');
            if (dockTrash) {
                dockTrash.classList.remove('drag-over');
            }
            
            if (draggedItem) {
                moveToTrash(draggedItem);
                draggedItem = null;
            }
        }
        
        function moveToTrash(item) {
            // Remove from desktop
            desktopItems = desktopItems.filter(i => i.id !== item.id);
            
            // Add to trash
            trashItems.push({ ...item, deletedAt: new Date().toISOString() });
            
            renderDesktop();
            updateTrashCount();
            saveTrash();
            
            console.log(`🗑️ Moved to trash: ${item.name}`);
        }
        
        function updateTrashCount() {
            const countEl = document.getElementById('trashCountBadge');
            if (countEl) {
                if (trashItems.length > 0) {
                    countEl.textContent = trashItems.length;
                    countEl.style.display = 'flex';
                } else {
                    countEl.style.display = 'none';
                }
            }
        }
        
        function openTrash() {
            if (trashItems.length === 0) {
                alert('🗑️ Trash is empty');
                return;
            }
            
            const message = `Trash (${trashItems.length} items):\n\n` + 
                trashItems.map(item => `${item.icon} ${item.name}`).join('\n') +
                '\n\nEmpty trash to permanently delete all items.';
            
            if (confirm(message + '\n\nEmpty trash now?')) {
                emptyTrash();
            }
        }
        
        function emptyTrash() {
            trashItems = [];
            updateTrashCount();
            saveTrash();
            console.log('🗑️ Trash emptied');
        }
        
        // Context Menu
        function showContextMenu(e) {
            e.preventDefault();
            const menu = document.getElementById('contextMenu');
            menu.style.left = e.pageX + 'px';
            menu.style.top = e.pageY + 'px';
            menu.classList.add('active');
        }
        
        function showItemContextMenu(e, item) {
            e.preventDefault();
            e.stopPropagation();
            
            const menu = document.getElementById('contextMenu');
            menu.innerHTML = `
                <div class="context-menu-item" onclick="openItem(${JSON.stringify(item).replace(/"/g, '&quot;')})">
                    <span>📂</span>
                    <span>Open</span>
                </div>
                <div class="context-menu-item" onclick="renameItem(${item.id})">
                    <span>✏️</span>
                    <span>Rename</span>
                </div>
                <div class="context-menu-divider"></div>
                <div class="context-menu-item danger" onclick="deleteItem(${item.id})">
                    <span>🗑️</span>
                    <span>Move to Trash</span>
                </div>
            `;
            
            menu.style.left = e.pageX + 'px';
            menu.style.top = e.pageY + 'px';
            menu.classList.add('active');
        }
        
        function hideContextMenu() {
            document.getElementById('contextMenu').classList.remove('active');
        }
        
        function renameItem(id) {
            const item = desktopItems.find(i => i.id === id);
            if (!item) return;
            
            const newName = prompt(`Rename "${item.name}" to:`, item.name);
            if (newName && newName.trim()) {
                item.name = newName.trim();
                renderDesktop();
            }
            hideContextMenu();
        }
        
        function deleteItem(id) {
            const item = desktopItems.find(i => i.id === id);
            if (item) {
                moveToTrash(item);
            }
            hideContextMenu();
        }
        
        // Dialog Functions
        function createNewFolder() {
            newItemType = 'folder';
            document.getElementById('dialogTitle').textContent = 'New Folder';
            document.getElementById('itemNameInput').value = 'Untitled Folder';
            document.getElementById('itemNameInput').select();
            document.getElementById('newItemDialog').classList.add('active');
            hideContextMenu();
        }
        
        function createNewFile() {
            newItemType = 'file';
            document.getElementById('dialogTitle').textContent = 'New File';
            document.getElementById('itemNameInput').value = 'untitled.txt';
            document.getElementById('itemNameInput').select();
            document.getElementById('newItemDialog').classList.add('active');
            hideContextMenu();
        }
        
        function closeDialog() {
            document.getElementById('newItemDialog').classList.remove('active');
        }
        
        function confirmNewItem() {
            const name = document.getElementById('itemNameInput').value.trim();
            if (!name) {
                alert('Please enter a name');
                return;
            }
            
            // Find a free spot for the new item (cascade down from top-left)
            let newX = 20;
            let newY = 20;
            const occupied = desktopItems.map(item => ({ x: item.x, y: item.y }));
            
            // Simple position finding - cascade down
            while (occupied.some(pos => Math.abs(pos.x - newX) < 90 && Math.abs(pos.y - newY) < 110)) {
                newY += 130;
                if (newY > 500) {
                    newY = 20;
                    newX += 110;
                }
            }
            
            const newItem = {
                id: Date.now(),
                type: newItemType,
                name: name,
                icon: newItemType === 'folder' ? '📁' : '📄',
                x: newX,
                y: newY
            };
            
            desktopItems.push(newItem);
            renderDesktop();
            closeDialog();
            
            console.log(`✅ Created ${newItemType}: ${name} at (${newX}, ${newY})`);
        }
        
        // System Settings
        function openSystemSettings() {
            document.getElementById('settingsModal').classList.add('active');
            hideContextMenu();
        }
        
        function closeSystemSettings() {
            document.getElementById('settingsModal').classList.remove('active');
        }
        
        function toggleSetting(toggleEl) {
            toggleEl.classList.toggle('active');
        }
        
        function refreshDesktop() {
            renderDesktop();
            hideContextMenu();
            console.log('🔄 Desktop refreshed');
        }
        
        // Save/Load functions
        function saveDesktop() {
            localStorage.setItem('desktopItems', JSON.stringify(desktopItems));
        }
        
        function saveTrash() {
            localStorage.setItem('trashItems', JSON.stringify(trashItems));
        }
        
        // Global event listeners for desktop
        document.addEventListener('click', (e) => {
            // Hide context menu when clicking outside
            if (!e.target.closest('.context-menu') && !e.target.closest('.desktop-icon')) {
                hideContextMenu();
            }
            
            // Deselect icons when clicking desktop
            if (e.target.id === 'desktopArea' || e.target.closest('.desktop-area')) {
                document.querySelectorAll('.desktop-icon').forEach(el => el.classList.remove('selected'));
            }
        });
        
        // Right-click on desktop for context menu
        document.addEventListener('DOMContentLoaded', () => {
            const desktopArea = document.getElementById('desktopArea');
            if (desktopArea) {
                desktopArea.addEventListener('contextmenu', showContextMenu);
            }
            
            // Close dialog on Escape
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeDialog();
                    closeSystemSettings();
                    hideContextMenu();
                }
            });
            
            // Enter key in dialog
            document.getElementById('itemNameInput')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    confirmNewItem();
                }
            });
        });
        
        // Menu Bar Functions
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
                console.log('🖥️ Entering fullscreen mode');
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                    console.log('🖥️ Exiting fullscreen mode');
                }
            }
        }
        
        // ========== RUST-POWERED SYSTEM OPERATIONS ==========
        // Check if running in Tauri environment
        const isTauriApp = typeof window.__TAURI__ !== 'undefined';
        
        // System Sleep
        async function systemSleep() {
            if (isTauriApp) {
                try {
                    const result = await window.__TAURI__.invoke('system_sleep');
                    console.log('💤 System:', result);
                    return result;
                } catch (error) {
                    console.error('❌ Sleep failed:', error);
                    alert('System sleep failed: ' + error);
                }
            } else {
                // Browser fallback
                console.log('💤 Sleep requested (browser mode - command not executed)');
                alert('🖥️ System Sleep\n\nThis command requires the Tauri desktop app.\n\nRun: npm run tauri:dev');
            }
        }
        
        // System Restart
        async function systemRestart() {
            if (isTauriApp) {
                const confirmed = confirm('⚠️ Are you sure you want to restart your computer?');
                if (!confirmed) return;
                
                try {
                    const result = await window.__TAURI__.invoke('system_restart');
                    console.log('🔄 System:', result);
                    return result;
                } catch (error) {
                    console.error('❌ Restart failed:', error);
                    alert('System restart failed: ' + error);
                }
            } else {
                console.log('🔄 Restart requested (browser mode - command not executed)');
                alert('🖥️ System Restart\n\nThis command requires the Tauri desktop app.\n\nRun: npm run tauri:dev');
            }
        }
        
        // System Shutdown
        async function systemShutdown() {
            if (isTauriApp) {
                const confirmed = confirm('⚠️ Are you sure you want to shut down your computer?');
                if (!confirmed) return;
                
                try {
                    const result = await window.__TAURI__.invoke('system_shutdown');
                    console.log('⚡ System:', result);
                    return result;
                } catch (error) {
                    console.error('❌ Shutdown failed:', error);
                    alert('System shutdown failed: ' + error);
                }
            } else {
                console.log('⚡ Shutdown requested (browser mode - command not executed)');
                alert('🖥️ System Shutdown\n\nThis command requires the Tauri desktop app.\n\nRun: npm run tauri:dev');
            }
        }
        
        // Lock Screen
        async function systemLock() {
            if (isTauriApp) {
                try {
                    const result = await window.__TAURI__.invoke('system_lock');
                    console.log('🔒 System:', result);
                    return result;
                } catch (error) {
                    console.error('❌ Lock failed:', error);
                    alert('Screen lock failed: ' + error);
                }
            } else {
                console.log('🔒 Lock screen requested (browser mode - command not executed)');
                alert('🖥️ Lock Screen\n\nThis command requires the Tauri desktop app.\n\nRun: npm run tauri:dev');
            }
        }
        
        // User Logout
        async function systemLogout() {
            if (isTauriApp) {
                const confirmed = confirm('⚠️ Are you sure you want to log out?');
                if (!confirmed) return;
                
                try {
                    const result = await window.__TAURI__.invoke('system_logout');
                    console.log('👋 System:', result);
                    return result;
                } catch (error) {
                    console.error('❌ Logout failed:', error);
                    alert('User logout failed: ' + error);
                }
            } else {
                console.log('👋 Logout requested (browser mode - command not executed)');
                alert('🖥️ Log Out\n\nThis command requires the Tauri desktop app.\n\nRun: npm run tauri:dev');
            }
        }
        
        // Get System Info
        async function getSystemInfo() {
            if (isTauriApp) {
                try {
                    const info = await window.__TAURI__.invoke('system_info');
                    console.log('ℹ️ System Info:\n' + info);
                    alert(info);
                    return info;
                } catch (error) {
                    console.error('❌ System info failed:', error);
                }
            } else {
                const browserInfo = `NAVΛ Studio IDE (Browser Mode)\n\nPlatform: ${navigator.platform}\nUser Agent: ${navigator.userAgent}\n\n⚡ For full system integration, run:\nnpm run tauri:dev`;
                console.log(browserInfo);
                alert(browserInfo);
            }
        }
        // ========== END RUST-POWERED SYSTEM OPERATIONS ==========
        
        // ========== APPLICATION LAUNCHER & APP STORE SYSTEM ==========
        
        let installedApps = [];
        let recentApps = [];
        let sidebarFavorites = [];
        let availableApps = {
            aiApps: [
                { id: 'chatgpt', name: 'ChatGPT', icon: '🤖', description: 'AI Assistant', installed: true, url: 'https://chat.openai.com' },
                { id: 'claude', name: 'Claude AI', icon: '🧠', description: 'AI Chat', installed: false, url: 'https://claude.ai' },
                { id: 'midjourney', name: 'Midjourney', icon: '🎨', description: 'AI Art', installed: false, url: 'https://midjourney.com' },
                { id: 'copilot', name: 'GitHub Copilot', icon: '💻', description: 'AI Code', installed: true, url: 'https://github.com/features/copilot' },
                { id: 'perplexity', name: 'Perplexity', icon: '🔍', description: 'AI Search', installed: false, url: 'https://perplexity.ai' },
                { id: 'runway', name: 'Runway ML', icon: '🎬', description: 'AI Video', installed: false, url: 'https://runwayml.com' }
            ],
            browsers: [
                { id: 'chrome', name: 'Chrome', icon: '🌐', description: 'Google Browser', installed: true, url: 'https://www.google.com', virtual: true },
                { id: 'firefox', name: 'Firefox', icon: '🦊', description: 'Mozilla Browser', installed: true, url: 'https://www.mozilla.org', virtual: true },
                { id: 'brave', name: 'Brave', icon: '🦁', description: 'Privacy Browser', installed: false, url: 'https://brave.com', virtual: true },
                { id: 'edge', name: 'Edge', icon: '🔷', description: 'Microsoft Browser', installed: false, url: 'https://www.microsoft.com/edge', virtual: true },
                { id: 'opera', name: 'Opera', icon: '🎭', description: 'Fast Browser', installed: false, url: 'https://www.opera.com', virtual: true },
                { id: 'arc', name: 'Arc', icon: '🌈', description: 'Modern Browser', installed: false, url: 'https://arc.net', virtual: true }
            ],
            devTools: [
                { id: 'navlambda-ide', name: 'Full IDE Application', icon: '⋋', description: 'NAVΛ Studio IDE', installed: true, url: '/app.html' },
                { id: 'vscode', name: 'VS Code', icon: '📝', description: 'Code Editor', installed: true, url: '/app.html' },
                { id: 'figma', name: 'Figma', icon: '🎨', description: 'Design Tool', installed: true, url: 'https://figma.com' },
                { id: 'github', name: 'GitHub', icon: '🐙', description: 'Code Hosting', installed: true, url: 'https://github.com' },
                { id: 'terminal', name: 'Terminal', icon: '⚡', description: 'Command Line', installed: true, url: '#terminal' }
            ]
        };
        
        // Initialize Application System
        function initAppSystem() {
            // Load installed apps from localStorage
            const saved = localStorage.getItem('installedApps');
            if (saved) {
                installedApps = JSON.parse(saved);
                // Update installed status in availableApps
                Object.keys(availableApps).forEach(category => {
                    availableApps[category].forEach(app => {
                        app.installed = installedApps.includes(app.id);
                    });
                });
            } else {
                // Get default installed apps
                Object.keys(availableApps).forEach(category => {
                    availableApps[category].forEach(app => {
                        if (app.installed) {
                            installedApps.push(app.id);
                        }
                    });
                });
                saveInstalledApps();
            }
            
            // Load recent apps
            const recentSaved = localStorage.getItem('recentApps');
            if (recentSaved) {
                recentApps = JSON.parse(recentSaved);
            }
            
            // Load sidebar favorites
            const favoritesSaved = localStorage.getItem('sidebarFavorites');
            if (favoritesSaved) {
                sidebarFavorites = JSON.parse(favoritesSaved);
                renderSidebarFavorites();
            }
            
            // Setup sidebar drop zone
            setupSidebarDropzone();
            
            console.log('🚀 Application system initialized');
            console.log(`📱 Installed apps: ${installedApps.length}`);
            console.log(`🕐 Recent apps: ${recentApps.length}`);
        }
        
        // Open Application Launcher
        function openAppLauncher() {
            document.getElementById('appLauncherModal').classList.add('active');
            renderAllApps();
            renderRecentApps();
            renderAIApps();
            renderBrowsers();
            renderAppStore();
            console.log('📱 Application launcher opened');
        }
        
        // Close Application Launcher
        function closeAppLauncher() {
            document.getElementById('appLauncherModal').classList.remove('active');
        }
        
        // Switch App Tab
        function switchAppTab(tab) {
            // Update tab active state
            document.querySelectorAll('.app-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update view active state
            document.querySelectorAll('.app-view').forEach(v => v.classList.remove('active'));
            
            switch(tab) {
                case 'all':
                    document.getElementById('allAppsView').classList.add('active');
                    break;
                case 'recent':
                    document.getElementById('recentAppsView').classList.add('active');
                    renderRecentApps();
                    break;
                case 'ai':
                    document.getElementById('aiAppsView').classList.add('active');
                    break;
                case 'browsers':
                    document.getElementById('browsersView').classList.add('active');
                    break;
                case 'store':
                    document.getElementById('appStoreView').classList.add('active');
                    break;
            }
        }
        
        // Render All Apps
        function renderAllApps() {
            const grid = document.getElementById('allAppsGrid');
            grid.innerHTML = '';
            
            const allApps = [];
            Object.keys(availableApps).forEach(category => {
                availableApps[category].forEach(app => {
                    if (app.installed) {
                        allApps.push(app);
                    }
                });
            });
            
            allApps.forEach(app => {
                const card = createAppCard(app, false);
                grid.appendChild(card);
            });
        }
        
        // Render Recent Apps
        function renderRecentApps() {
            const grid = document.getElementById('recentAppsGrid');
            grid.innerHTML = '';
            
            if (recentApps.length === 0) {
                grid.innerHTML = '<div style="grid-column: 1/-1; text-align: center; color: rgba(255,255,255,0.5); padding: 40px;">No recent applications</div>';
                return;
            }
            
            recentApps.slice(0, 12).forEach(appId => {
                let app = null;
                Object.keys(availableApps).forEach(category => {
                    const found = availableApps[category].find(a => a.id === appId);
                    if (found) app = found;
                });
                
                if (app) {
                    const card = createAppCard(app, false);
                    grid.appendChild(card);
                }
            });
        }
        
        // Render AI Apps
        function renderAIApps() {
            const grid = document.getElementById('aiAppsGrid');
            grid.innerHTML = '';
            
            availableApps.aiApps.filter(app => app.installed).forEach(app => {
                const card = createAppCard(app, false);
                grid.appendChild(card);
            });
        }
        
        // Render Browsers
        function renderBrowsers() {
            const grid = document.getElementById('browsersGrid');
            grid.innerHTML = '';
            
            availableApps.browsers.filter(app => app.installed).forEach(app => {
                const card = createAppCard(app, false);
                grid.appendChild(card);
            });
        }
        
        // Render App Store
        function renderAppStore() {
            // AI Apps in Store
            const aiGrid = document.getElementById('storeAIApps');
            aiGrid.innerHTML = '';
            availableApps.aiApps.forEach(app => {
                const card = createAppCard(app, true);
                aiGrid.appendChild(card);
            });
            
            // Browser Apps in Store
            const browserGrid = document.getElementById('storeBrowserApps');
            browserGrid.innerHTML = '';
            availableApps.browsers.forEach(app => {
                const card = createAppCard(app, true);
                browserGrid.appendChild(card);
            });
            
            // Dev Tools in Store
            const devGrid = document.getElementById('storeDevApps');
            devGrid.innerHTML = '';
            availableApps.devTools.forEach(app => {
                const card = createAppCard(app, true);
                devGrid.appendChild(card);
            });
        }
        
        // Create App Card
        function createAppCard(app, showInstallBtn) {
            const card = document.createElement('div');
            card.className = 'app-card' + (app.installed ? ' installed' : '');
            card.innerHTML = `
                ${app.installed ? '<div class="app-status">✓ Installed</div>' : ''}
                <div class="app-icon">${app.icon}</div>
                <div class="app-name">${app.name}</div>
                <div class="app-description">${app.description}</div>
                ${showInstallBtn ? `
                    <button class="app-install-btn ${app.installed ? 'installed' : ''}" onclick="toggleAppInstall('${app.id}', event)">
                        ${app.installed ? '✓ Installed' : '↓ Install'}
                    </button>
                ` : ''}
            `;
            
            if (app.installed && !showInstallBtn) {
                card.onclick = () => launchApp(app);
            }
            
            return card;
        }
        
        // Launch Application
        function launchApp(app) {
            console.log(`🚀 Launching: ${app.name}`);
            
            // Add to recent apps
            recentApps = recentApps.filter(id => id !== app.id);
            recentApps.unshift(app.id);
            if (recentApps.length > 20) recentApps = recentApps.slice(0, 20);
            localStorage.setItem('recentApps', JSON.stringify(recentApps));
            
            // Launch app
            if (app.url) {
                if (app.virtual) {
                    // Open in iframe or embed (virtual browser)
                    alert(`🌐 Opening ${app.name} in virtual browser...\n\nURL: ${app.url}\n\n(Integration coming soon!)`);
                } else if (app.id === 'navlambda-ide' || app.id === 'vscode' || app.url === '/app.html') {
                    // Navigate to IDE in same window
                    window.location.href = app.url;
                } else if (app.id === 'terminal' || app.url === '#terminal') {
                    // Open terminal modal
                    closeAppLauncher();
                    toggleTerminalModal();
                    return;
                } else {
                    // Open external URLs in new tab
                    window.open(app.url, '_blank');
                }
            }
            
            closeAppLauncher();
        }
        
        // Toggle App Installation
        function toggleAppInstall(appId, event) {
            event.stopPropagation();
            
            let app = null;
            let category = null;
            
            Object.keys(availableApps).forEach(cat => {
                const found = availableApps[cat].find(a => a.id === appId);
                if (found) {
                    app = found;
                    category = cat;
                }
            });
            
            if (!app) return;
            
            if (app.installed) {
                // Uninstall
                if (confirm(`Uninstall ${app.name}?`)) {
                    app.installed = false;
                    installedApps = installedApps.filter(id => id !== appId);
                    console.log(`❌ Uninstalled: ${app.name}`);
                }
            } else {
                // Install
                app.installed = true;
                installedApps.push(appId);
                console.log(`✅ Installed: ${app.name}`);
            }
            
            saveInstalledApps();
            renderAppStore();
            renderAllApps();
        }
        
        // Save Installed Apps
        function saveInstalledApps() {
            localStorage.setItem('installedApps', JSON.stringify(installedApps));
        }
        
        // ========== SIDEBAR DRAG & DROP ==========
        
        function setupSidebarDropzone() {
            const dropzone = document.getElementById('sidebarDropzone');
            
            dropzone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropzone.classList.add('drag-over');
            });
            
            dropzone.addEventListener('dragleave', () => {
                dropzone.classList.remove('drag-over');
            });
            
            dropzone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropzone.classList.remove('drag-over');
                
                if (draggedItem && draggedItem.type === 'folder') {
                    addToSidebarFavorites(draggedItem);
                }
            });
        }
        
        function addToSidebarFavorites(item) {
            // Check if already exists
            if (sidebarFavorites.find(f => f.id === item.id)) {
                console.log('📌 Folder already in sidebar');
                return;
            }
            
            sidebarFavorites.push({
                id: item.id,
                name: item.name,
                icon: item.icon
            });
            
            localStorage.setItem('sidebarFavorites', JSON.stringify(sidebarFavorites));
            renderSidebarFavorites();
            
            console.log(`📌 Added to sidebar: ${item.name}`);
        }
        
        function renderSidebarFavorites() {
            const container = document.getElementById('sidebarFavorites');
            container.innerHTML = '';
            
            sidebarFavorites.forEach(fav => {
                const item = document.createElement('div');
                item.className = 'sidebar-favorite-item';
                item.innerHTML = `
                    <div class="sidebar-favorite-icon">${fav.icon}</div>
                    <div class="sidebar-favorite-name">${fav.name}</div>
                    <div class="sidebar-favorite-remove" onclick="removeFromSidebar('${fav.id}', event)">×</div>
                `;
                item.onclick = () => openSidebarFavorite(fav);
                container.appendChild(item);
            });
        }
        
        function removeFromSidebar(id, event) {
            event.stopPropagation();
            sidebarFavorites = sidebarFavorites.filter(f => f.id !== id);
            localStorage.setItem('sidebarFavorites', JSON.stringify(sidebarFavorites));
            renderSidebarFavorites();
            console.log('📌 Removed from sidebar');
        }
        
        function openSidebarFavorite(fav) {
            console.log(`📂 Opening sidebar favorite: ${fav.name}`);
            // Find the item in desktop items and open it
            const item = desktopItems.find(i => i.id === fav.id);
            if (item) {
                openItem(item);
            }
        }
        
        // ========== END APPLICATION LAUNCHER & APP STORE SYSTEM ==========
        
        // ========== DOCK CONTROLLER SYSTEM ==========
        
        let dockSettings = {
            size: 'medium',
            magnification: true,
            magScale: 1.6,
            animSpeed: 0.4
        };
        
        function initDockController() {
            // Load saved settings
            const saved = localStorage.getItem('dockSettings');
            if (saved) {
                dockSettings = JSON.parse(saved);
                applyDockSettings();
            }
        }
        
        function openDockController() {
            document.getElementById('dockControllerModal').classList.add('active');
            
            // Update UI to reflect current settings
            document.querySelectorAll('.dock-size-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.size === dockSettings.size);
            });
            
            document.getElementById('magToggle').checked = dockSettings.magnification;
            document.getElementById('magScale').value = dockSettings.magScale;
            document.getElementById('magScaleValue').textContent = dockSettings.magScale + 'x';
            
            document.querySelectorAll('.speed-btn').forEach((btn, idx) => {
                const speeds = [0.2, 0.4, 0.6];
                btn.classList.toggle('active', speeds[idx] === dockSettings.animSpeed);
            });
            
            console.log('⚙️ Dock Controller opened');
        }
        
        function closeDockController() {
            document.getElementById('dockControllerModal').classList.remove('active');
        }
        
        function setDockSize(size) {
            dockSettings.size = size;
            saveDockSettings();
            applyDockSettings();
            
            // Update UI
            document.querySelectorAll('.dock-size-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.size === size);
            });
            
            console.log(`📏 Dock size: ${size}`);
        }
        
        function toggleMagnification() {
            dockSettings.magnification = document.getElementById('magToggle').checked;
            saveDockSettings();
            applyDockSettings();
            
            console.log(`🔍 Magnification: ${dockSettings.magnification ? 'enabled' : 'disabled'}`);
        }
        
        function updateMagScale(value) {
            dockSettings.magScale = parseFloat(value);
            document.getElementById('magScaleValue').textContent = value + 'x';
            saveDockSettings();
            applyDockSettings();
        }
        
        function setAnimSpeed(speed) {
            dockSettings.animSpeed = speed;
            saveDockSettings();
            applyDockSettings();
            
            // Update UI
            document.querySelectorAll('.speed-btn').forEach((btn, idx) => {
                const speeds = [0.2, 0.4, 0.6];
                btn.classList.toggle('active', speeds[idx] === speed);
            });
            
            console.log(`⚡ Animation speed: ${speed}s`);
        }
        
        function applyDockSettings() {
            const dock = document.getElementById('bottomDock');
            
            // Apply size
            dock.classList.remove('small', 'medium', 'large');
            dock.classList.add(dockSettings.size);
            
            // Apply magnification
            if (!dockSettings.magnification) {
                dock.classList.add('magnification-disabled');
            } else {
                dock.classList.remove('magnification-disabled');
            }
            
            // Apply magnification scale via CSS variables
            document.documentElement.style.setProperty('--mag-scale', dockSettings.magScale);
            
            // Apply ultra-smooth animation with custom easing
            const icons = dock.querySelectorAll('.bottom-icon');
            icons.forEach(icon => {
                // Use the ultra-smooth cubic-bezier for spring effect
                icon.style.transition = `transform ${dockSettings.animSpeed}s cubic-bezier(0.34, 1.56, 0.64, 1), 
                                        box-shadow ${dockSettings.animSpeed}s cubic-bezier(0.34, 1.56, 0.64, 1), 
                                        filter 0.25s ease, 
                                        background 0.25s ease`;
                
                // Ensure hardware acceleration
                icon.style.willChange = 'transform, box-shadow';
                icon.style.backfaceVisibility = 'hidden';
            });
        }
        
        function saveDockSettings() {
            localStorage.setItem('dockSettings', JSON.stringify(dockSettings));
        }
        
        // ========== TRASH VIEWER WITH CRUD ==========
        
        function openTrashViewer() {
            document.getElementById('trashViewerModal').classList.add('active');
            renderTrashViewer();
            console.log('🗑️ Trash Viewer opened');
        }
        
        function closeTrashViewer() {
            document.getElementById('trashViewerModal').classList.remove('active');
        }
        
        function renderTrashViewer() {
            const grid = document.getElementById('trashItemsGrid');
            const emptyState = document.getElementById('trashEmptyState');
            const itemCount = document.getElementById('trashItemCount');
            
            itemCount.textContent = `${trashItems.length} ${trashItems.length === 1 ? 'item' : 'items'}`;
            
            if (trashItems.length === 0) {
                emptyState.style.display = 'flex';
                grid.style.display = 'none';
            } else {
                emptyState.style.display = 'none';
                grid.style.display = 'grid';
                grid.innerHTML = '';
                
                trashItems.forEach((item, index) => {
                    const card = document.createElement('div');
                    card.className = 'trash-item-card';
                    card.innerHTML = `
                        <div class="trash-item-icon">${item.icon}</div>
                        <div class="trash-item-name">${item.name}</div>
                        <div class="trash-item-actions">
                            <button class="trash-action-btn" onclick="restoreItem(${item.id})">
                                ↩️ Restore
                            </button>
                            <button class="trash-action-btn delete" onclick="deleteItemPermanently(${item.id})">
                                🔥 Delete
                            </button>
                        </div>
                    `;
                    grid.appendChild(card);
                });
            }
        }
        
        function restoreItem(id) {
            const item = trashItems.find(i => i.id === id);
            if (!item) return;
            
            // Remove from trash
            trashItems = trashItems.filter(i => i.id !== id);
            
            // Add back to desktop
            desktopItems.push(item);
            
            // Save and update
            saveTrash();
            saveDesktop();
            renderDesktop();
            renderTrashViewer();
            updateTrashCount();
            
            console.log(`↩️ Restored: ${item.name}`);
        }
        
        function restoreAll() {
            if (trashItems.length === 0) return;
            
            if (!confirm(`Restore all ${trashItems.length} items from trash?`)) return;
            
            // Move all items back to desktop
            trashItems.forEach(item => {
                desktopItems.push(item);
            });
            
            trashItems = [];
            
            saveTrash();
            saveDesktop();
            renderDesktop();
            renderTrashViewer();
            updateTrashCount();
            
            console.log('↩️ Restored all items');
        }
        
        function deleteItemPermanently(id) {
            const item = trashItems.find(i => i.id === id);
            if (!item) return;
            
            if (!confirm(`Permanently delete "${item.name}"? This cannot be undone.`)) return;
            
            trashItems = trashItems.filter(i => i.id !== id);
            
            saveTrash();
            renderTrashViewer();
            updateTrashCount();
            
            console.log(`🔥 Permanently deleted: ${item.name}`);
        }
        
        function emptyTrash() {
            if (trashItems.length === 0) return;
            
            if (!confirm(`Empty trash (${trashItems.length} items)? This cannot be undone.`)) return;
            
            trashItems = [];
            saveTrash();
            renderTrashViewer();
            updateTrashCount();
            
            console.log('🔥 Trash emptied');
        }
        
        // ========== BROWSER SELECTOR ==========
        
        let activeBrowser = {
            id: 'chrome',
            name: 'Chrome',
            icon: '🌐'
        };
        
        function initBrowserSelector() {
            const saved = localStorage.getItem('activeBrowser');
            if (saved) {
                activeBrowser = JSON.parse(saved);
                updateBrowserIcon();
            }
        }
        
        function toggleBrowserSelector(event) {
            event.stopPropagation();
            const selector = document.getElementById('browserSelector');
            selector.classList.toggle('active');
            
            // Close when clicking outside
            if (selector.classList.contains('active')) {
                setTimeout(() => {
                    document.addEventListener('click', closeBrowserSelector);
                }, 0);
            }
        }
        
        function closeBrowserSelector() {
            document.getElementById('browserSelector').classList.remove('active');
            document.removeEventListener('click', closeBrowserSelector);
        }
        
        function selectBrowser(browserId, event) {
            event.stopPropagation();
            
            const browsers = {
                chrome: { id: 'chrome', name: 'Chrome', icon: '🌐' },
                firefox: { id: 'firefox', name: 'Firefox', icon: '🦊' },
                brave: { id: 'brave', name: 'Brave', icon: '🦁' },
                edge: { id: 'edge', name: 'Edge', icon: '🔷' },
                opera: { id: 'opera', name: 'Opera', icon: '🎭' },
                arc: { id: 'arc', name: 'Arc', icon: '🌈' }
            };
            
            activeBrowser = browsers[browserId];
            localStorage.setItem('activeBrowser', JSON.stringify(activeBrowser));
            
            updateBrowserIcon();
            closeBrowserSelector();
            
            console.log(`🌐 Browser changed to: ${activeBrowser.name}`);
        }
        
        function updateBrowserIcon() {
            document.getElementById('browserIcon').textContent = activeBrowser.icon;
            
            // Update active state in selector
            document.querySelectorAll('.browser-option').forEach(opt => {
                opt.classList.toggle('active', opt.dataset.browser === activeBrowser.id);
            });
        }
        
        // ========== END DOCK & BROWSER SYSTEMS ==========
        
        // Expose functions globally
        window.createNewFolder = createNewFolder;
        window.createNewFile = createNewFile;
        window.closeDialog = closeDialog;
        window.confirmNewItem = confirmNewItem;
        window.openSystemSettings = openSystemSettings;
        window.closeSystemSettings = closeSystemSettings;
        window.toggleSetting = toggleSetting;
        window.refreshDesktop = refreshDesktop;
        window.handleTrashDragOver = handleTrashDragOver;
        window.handleTrashDragLeave = handleTrashDragLeave;
        window.handleTrashDrop = handleTrashDrop;
        window.openTrash = openTrash;
        window.renameItem = renameItem;
        window.deleteItem = deleteItem;
        window.openItem = openItem;
        window.toggleFullscreen = toggleFullscreen;
        window.systemSleep = systemSleep;
        window.systemRestart = systemRestart;
        window.systemShutdown = systemShutdown;
        window.systemLock = systemLock;
        window.systemLogout = systemLogout;
        window.getSystemInfo = getSystemInfo;
        window.openAppLauncher = openAppLauncher;
        window.closeAppLauncher = closeAppLauncher;
        window.switchAppTab = switchAppTab;
        window.toggleAppInstall = toggleAppInstall;
        window.removeFromSidebar = removeFromSidebar;
        window.openDockController = openDockController;
        window.closeDockController = closeDockController;
        window.setDockSize = setDockSize;
        window.toggleMagnification = toggleMagnification;
        window.updateMagScale = updateMagScale;
        window.setAnimSpeed = setAnimSpeed;
        window.openTrashViewer = openTrashViewer;
        window.closeTrashViewer = closeTrashViewer;
        window.restoreItem = restoreItem;
        window.restoreAll = restoreAll;
        window.deleteItemPermanently = deleteItemPermanently;
        window.emptyTrash = emptyTrash;
        window.toggleBrowserSelector = toggleBrowserSelector;
        window.selectBrowser = selectBrowser;
        
        // ========== END DESKTOP OS SYSTEM ==========

        // Initialize widgets
        function initWidgets() {
            // Set London as default location
            const weatherSelect = document.getElementById('weatherCitySelect');
            const clockSelect = document.getElementById('clockCitySelect');
            
            if (weatherSelect) {
                weatherSelect.value = '1'; // London, UK
                changeWeatherCity(); // Update weather display
            }
            
            if (clockSelect) {
                clockSelect.value = 'Europe/London'; // London, UK
            }
            
            detectLocation();
            updateClock();
            updateWeather();
            updateTimeDate();
            updatePowerButton();
            
            // ========== COLLAPSE ALL WIDGETS BY DEFAULT FOR CLEAN START ==========
            // Check if this is first visit or user wants default collapsed state
            const widgetIds = ['weatherWidget', 'clockWidget', 'newsWidget', 'currencyWidget', 'stockWidget'];
            const widgetsState = localStorage.getItem('widgetsState');
            
            if (!widgetsState) {
                // First visit - collapse all widgets for clean look
                widgetIds.forEach(widgetId => {
                    const widget = document.getElementById(widgetId);
                    const button = widget.querySelector('.widget-collapse-btn');
                    if (widget && !widget.classList.contains('collapsed')) {
                        widget.classList.add('collapsed');
                        button.classList.add('collapsed');
                        button.textContent = '▶';
                    }
                });
                console.log('🎨 Clean start: All widgets collapsed');
            } else {
                // Restore previous state
                try {
                    const savedState = JSON.parse(widgetsState);
                    widgetIds.forEach(widgetId => {
                        if (savedState[widgetId] === 'collapsed') {
                            const widget = document.getElementById(widgetId);
                            const button = widget.querySelector('.widget-collapse-btn');
                            if (widget && !widget.classList.contains('collapsed')) {
                                widget.classList.add('collapsed');
                                button.classList.add('collapsed');
                                button.textContent = '▶';
                            }
                        }
                    });
                } catch(e) {
                    console.error('Error restoring widget state:', e);
                }
            }
            
            // Initialize all draggable elements
            initAllDraggables();
            
            // Initialize magnifying dock effect
            initMagnifyingDock();
            
            // Initialize sidebar state
            initSidebar();
            
            // Initialize desktop OS
            initDesktop();
            
            // Initialize application system
            initAppSystem();
            
            // Initialize dock controller
            initDockController();
            
            // Initialize browser selector
            initBrowserSelector();

            // Update clocks every second
            setInterval(() => {
                updateClock();
                updateTimeDate();
            }, 1000);

            // Update weather every 30 minutes
            setInterval(updateWeather, 30 * 60 * 1000);
            
            // Update stocks every 3 seconds (simulated live feed)
            setInterval(updateStocks, 3000);
            
            // Set power to standby mode
            powerState = 'standby';
            updatePowerButton();
            
            console.log('✅ All widgets initialized!');
            console.log('🌍 World clocks ready - Default: London, UK 🇬🇧');
            console.log('🌤️ Weather widget ready - Default: London, UK 🇬🇧');
            console.log('📰 News feed ready');
            console.log('💱 Currency calculator ready');
            console.log('📈 Stock market LIVE');
            console.log('📂 Sidebar toggle ready - Press Ctrl/Cmd+B to toggle');
            console.log('🖥️ Desktop OS ready - Right-click for menu');
            console.log('🗑️ Trash bin with CRUD - Click to view & manage');
            console.log('📱 Application launcher - Press Cmd/Ctrl+A or click ⋋');
            console.log('🏪 App Store with AI apps & virtual browsers');
            console.log('📌 Drag folders to sidebar for quick access');
            console.log('⚙️ Dock Controller - Click ⋋ → Dock Settings');
            console.log('🔍 Magnification: ' + (dockSettings.magnification ? 'ON' : 'OFF') + ' | Size: ' + dockSettings.size);
            console.log('🌐 Browser selector active - Current: ' + activeBrowser.name);
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initWidgets);
    </script>
</body>
</html>
